{
  "EnrichedDataToSingleEventIndicator": {
    "description": "This step cleans the scored data that was generated from the step and its subsequent single indicators along with geo hopping notifications",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalySingleEvent###notifications@@@date:::ts%%%cause:::vpn_geo_hopping"
      }
    ],
    "otherSteps": [
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "4769-prevalence-stats###4769-user-score###hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###ssh-prevalence-stats###ssh-user-score###vpn-prevalence-stats###vpnsession-prevalence-stats###vpn-user-score"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "4769-prevalence-stats-changelog###4769-user-score-changelog###__samza_checkpoint_4769-events-filter_1###__samza_checkpoint_4769-prevalence-stats_1###__samza_checkpoint_4769-user-score_1###__samza_checkpoint_ssh-prevalence-stats_1###__samza_checkpoint_ssh-user-score_1###__samza_checkpoint_vpn-events-filter_1###__samza_checkpoint_vpn-prevalence-stats_1###__samza_checkpoint_vpn-user-score_1###__samza_checkpoint_vpnsession-events-filter_1###__samza_checkpoint_vpnsession-prevalence-stats_1###fortscale-4769-event-filtered###fortscale-4769-event-score###fortscale-4769-event-score-after-write###fortscale-ssh-event-score###fortscale-ssh-event-score-after-write###fortscale-vpn-event-filtered###fortscale-vpn-event-score###fortscale-vpn-event-score-after-write###fortscale-vpnsession-event-filtered###fortscale-vpnsession-event-score###fortscale-vpnsession-event-score-after-write###hdfs-write-authenticationscores-changelog###hdfs-write-###authenticationscores_top-changelog###hdfs-write-sshscores-changelog###hdfs-write-sshscores_top-changelog###hdfs-write-vpndatares-changelog###hdfs-write-vpndatares_top-changelog###hdfs-write-vpnsessiondatares-changelog###hdfs-write-vpnsessiondatares_top-changelog###ssh-prevalence-stats-changelog###ssh-user-score-changelog###vpn-prevalence-stats-changelog###vpn-user-score-changelog###vpnsession-prevalence-stats-changelog"
      },
      {
        "technology": "MONGO",
        "strategy": "RESTORE",
        "dataSources": "streaming_models###streaming_userscore_snapshot###user"
      },
      {
        "technology": "HDFS",
        "strategy": "RESTORE",
        "dataSources": "/home/cloudera/bdpbackup/"
      }
    ]
  },
  "ScoredDataToBucketCreation": {
    "description": "This step cleans the aggr_ buckets created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "aggr_%%%prefix@@@date:::endTime###FeatureBucketMetadata@@@date:::endTime"
      }
    ],
    "otherSteps": [
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "aggr_@@@prefix###feature_buckets_store"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-vpnsession-event-score-from-hdfs###fortscale-vpn-event-score-from-hdfs###fortscale-ssh-event-score-from-hdfs###fortscale-4769-event-score-from-hdfs###metrics"
      }
    ]
  },
  "AggregatedEventsToEntityEvents": {
    "description": "This step cleans the aggregated indicators created during the run of the step and the aggregated event models in the model_....daily/hourly collections",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@evidenceType:::AnomalyAggregatedEvent###^model_(?!entity).*(daily|hourly)$%%%regex@@@date:::endTime"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "AggrFeatureEventToSend###scored___aggr%%%prefix@@@date:::end_time_unix###entity_event_%%%prefix@@@date:::endTime"
      }
    ],
    "otherSteps": [
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_events_store###aggregated-feature-events-model-cache-store###model_building_store"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-aggregated-feature-f-event###fortscale-aggregated-feature-p-event###fortscale-aggr-feature-events-score###metrics"
      }
    ]
  },
  "EntityEventsCreation": {
    "description": "This step cleans the entity events created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models@@@regex:::modelName!!!entity_event_"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "scored___entity_event@@@prefix"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_event_normalized_username_daily-prevalence-stats###entity_event_normalized_username_hourly-prevalence-stats"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-entity-event###metrics"
      }
    ]
  },
  "ScoredEventsToIndicators": {
    "description": "This step cleans the single indicators created during the running of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalySingleEvent"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-4769-event-score-after-write###fortscale-ssh-event-score-after-write###fortscale-vpn-event-score-after-write###fortscale-vpnsession-event-score-after-write###__samza_checkpoint_4769-user-score_1-0###__samza_checkpoint_vpn-user-score_1-0###__samza_checkpoint_ssh-user-score_1-0###__samza_checkpoint_evidence-creation-task_1-0###metrics"
      }
    ]
  },
  "NotificationsToIndicators": {
    "description": "This step cleans the notification indicators created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Notification"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-notification-event-score###__samza_checkpoint_evidence-creation-task_1-0"
      }
    ]
  },
  "AlertGeneration": {
    "description": "This step cleans the alerts and tag indicators created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "alerts@@@date:::endDate###evidences@@@date:::endDate%%%evidenceType:::Tag"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-evidences###fortscale-entity-event-score###__samza_checkpoint_alert-generator-task_1-0###metrics"
      }
    ]
  },
  "AfterETL": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the ETL phase regardless of the dates entered!! (does not affect the data tables)",
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "model@@@prefix###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix###streaming_@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata###enricheddata"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###entity_events_store###feature_buckets_store###hdfs-write-4769enriched###hdfs-write-sshenriched###hdfs-write-vpnenriched###aggregated-feature-events-model-cache-store###user-score-task-store###entity-events-model-cache-store###model_building_store###raw-events-model-cache-store"
      }
    ]
  },
  "AfterEnriched": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the Enrich phase regardless of the dates entered!! (does not affect the data and enrich tables)",
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "model@@@prefix###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###entity_events_store###feature_buckets_store###aggregated-feature-events-model-cache-store###user-score-task-store###entity-events-model-cache-store###model_building_store###raw-events-model-cache-store"
      }
    ]
  },
  "AfterScored": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the Scoring phase regardless of the dates entered!! (does not affect the data, enrich and scoring tables)",
    "timeBasedSteps": [

    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "^model_.*(daily|hourly)$%%%regex###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "aggregated-feature-events-model-cache-store###entity_events_store###entity-events-model-cache-store###feature_buckets_store###"
      }
    ]
  },
  "AfterSingleIndicators": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the creation of single indicators regardless of the dates entered!! (does not affect any of the tables and single indicators)",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Tag"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalyAggregatedEvent"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Notification"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "^model_.*(daily|hourly)$%%%regex###alerts###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "feature_buckets_store###aggregated-feature-events-model-cache-store###entity_events_store###entity-events-model-cache-store"
      }
    ]
  }
}