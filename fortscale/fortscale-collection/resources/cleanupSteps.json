{
  "ScoreAggregateModelRawEvents": {
    "description": "This step cleans the processed data partitions in HDFS of the specified time range, the feature buckets (and meta data) in Mongo of the specified time range and all the Kafka topics from enrichment to scoring (included)",
    "timeBasedSteps": [
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "aggr_%%%prefix@@@date:::endTime###FeatureBucketMetadata@@@date:::endTime"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalySingleEvent###notifications@@@date:::ts%%%cause:::vpn_geo_hopping"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-4769-enriched-after-write###fortscale-4769-event-filtered###fortscale-ssh-enriched-after-write###fortscale-vpn-enriched-after-write###fortscale-vpn-event-filtered###fortscale-vpnsession-event-filtered###fortscale-kerberos-tgt-enriched-after-write###fortscale-generic-data-access-enriched-after-write###fortscale-4769-event-score###fortscale-ssh-event-score###fortscale-vpn-event-score###fortscale-vpnsession-event-score###fortscale-kerberos-tgt-event-score###fortscale-generic-data-access-event-score###fortscale-4769-event-score-after-write###fortscale-ssh-event-score-after-write###fortscale-vpn-event-score-after-write###fortscale-vpnsession-event-score-after-write###fortscale-kerberos-tgt-score-after-write###fortscale-generic-data-access-score-after-write"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "hdfs-write-authenticationscores-changelog###hdfs-write-authenticationscores_top-changelog###hdfs-write-sshscores-changelog###hdfs-write-sshscores_top-changelog###hdfs-write-vpndatares-changelog###hdfs-write-vpndatares_top-changelog###hdfs-write-vpnsessiondatares-changelog###hdfs-write-vpnsessiondatares_top-changelog###hdfs-write-crmsfscore-changelog###hdfs-write-crmsfscore_top-changelog###hdfs-write-gwamescore-changelog###hdfs-write-gwamescore_top-changelog###hdfs-write-kerberostgtscore-changelog###hdfs-write-kerberostgtscore_top-changelog###hdfs-write-ntlmscore-changelog###hdfs-write-ntlmscore_top-changelog###hdfs-write-oraclescore-changelog###hdfs-write-oraclescore_top-changelog###hdfs-write-prnlogscore-changelog###hdfs-write-prnlogscore_top-changelog###hdfs-write-wamescore-changelog###hdfs-write-wamescore_top-changelog"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "user-score-task-store-changelog###feature_buckets_store-changelog###model_building_store-changelog###fortscale-aggregation-events-control###fortscale-model-building-control-input###fortscale-model-building-control-output"
      }
    ]
  },
  "AggregatedEventsToEntityEvents": {
    "description": "This step cleans the aggregated indicators created during the run of the step and the aggr_event_ models in the streaming_models collection",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@evidenceType:::AnomalyAggregatedEvent###streaming_models@@@regex:::modelName!!!aggr_event_"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "AggrFeatureEventToSend###scored___aggr@@@prefix###entity_event_@@@prefix"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_events_store"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-aggregated-feature-f-event###fortscale-aggregated-feature-p-event###fortscale-aggr-feature-events-score###metrics"
      }
    ]
  },
  "EntityEventsCreation": {
    "description": "This step cleans the entity events created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models@@@regex:::modelName!!!entity_event_"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "scored___entity_event@@@prefix"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_event_normalized_username_daily-prevalence-stats###entity_event_normalized_username_hourly-prevalence-stats"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-entity-event###metrics"
      }
    ]
  },
  "ScoredEventsToIndicators": {
    "description": "This step cleans the single indicators created during the running of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalySingleEvent"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-4769-event-score-after-write###fortscale-ssh-event-score-after-write###fortscale-vpn-event-score-after-write###fortscale-vpnsession-event-score-after-write###__samza_checkpoint_4769-user-score_1-0###__samza_checkpoint_vpn-user-score_1-0###__samza_checkpoint_ssh-user-score_1-0###__samza_checkpoint_evidence-creation-task_1-0###metrics"
      }
    ]
  },
  "NotificationsToIndicators": {
    "description": "This step cleans the notification indicators created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Notification"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-notification-event-score###__samza_checkpoint_evidence-creation-task_1-0"
      }
    ]
  },
  "AlertGeneration": {
    "description": "This step cleans the alerts and tag indicators created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "alerts@@@date:::endDate###evidences@@@date:::endDate%%%evidenceType:::Tag"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-evidences###fortscale-entity-event-score###__samza_checkpoint_alert-generator-task_1-0###metrics"
      }
    ]
  },
  "AfterETL": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the ETL phase regardless of the dates entered!! (does not affect the data tables)",
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix###streaming_@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata###enricheddata"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "4769-prevalence-stats###4769-user-score###hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###ssh-prevalence-stats###ssh-user-score###vpn-prevalence-stats###vpnsession-prevalence-stats###vpn-user-score###entity_event_normalized_username_daily-prevalence-stats###entity_event_normalized_username_hourly-prevalence-stats###entity_events_store###feature_buckets_store###hdfs-write-4769enriched###hdfs-write-sshenriched###hdfs-write-vpnenriched###aggr_event_@@@prefix"
      }
    ]
  },
  "AfterEnriched": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the Enrich phase regardless of the dates entered!! (does not affect the data and enrich tables)",
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "4769-prevalence-stats###4769-user-score###hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###ssh-prevalence-stats###ssh-user-score###vpn-prevalence-stats###vpnsession-prevalence-stats###vpn-user-score###entity_event_normalized_username_daily-prevalence-stats###entity_event_normalized_username_hourly-prevalence-stats###entity_events_store###feature_buckets_store###aggr_event_@@@prefix"
      }
    ]
  },
  "AfterScored": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the Scoring phase regardless of the dates entered!! (does not affect the data, enrich and scoring tables)",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models@@@regex:::modelName!!!aggr_event_normalized_username"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models@@@regex:::modelName!!!entity_event_normalized_username"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_event_normalized_username_daily-prevalence-stats###entity_event_normalized_username_hourly-prevalence-stats###entity_events_store###feature_buckets_store###aggr_event_@@@prefix"
      }
    ]
  },
  "AfterSingleIndicators": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the creation of single indicators regardless of the dates entered!! (does not affect any of the tables and single indicators)",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models@@@regex:::modelName!!!aggr_event_normalized_username"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "streaming_models@@@regex:::modelName!!!entity_event_normalized_username"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Tag"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalyAggregatedEvent"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Notification"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "alerts###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_event_normalized_username_daily-prevalence-stats###entity_event_normalized_username_hourly-prevalence-stats###entity_events_store###feature_buckets_store###aggr_event_@@@prefix"
      }
    ]
  }
}