{
  "ScoreAggregateModelRawEvents": {
    "description": "This step cleans the processed data partitions in HDFS of the specified time range, the feature buckets (and meta data) in Mongo of the specified time range and all the Kafka topics from enrichment to scoring (included)",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "aggr_%%%prefix@@@date:::endTime###FeatureBucketMetadata@@@date:::endTime"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalySingleEvent###notifications@@@date:::ts%%%cause:::vpn_geo_hopping"
      }
    ],
    "otherSteps": [
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "model_@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-4769-enriched-after-write###fortscale-4769-event-filtered###fortscale-ssh-enriched-after-write###fortscale-vpn-enriched-after-write###fortscale-vpn-event-filtered###fortscale-kerberos-tgt-enriched-after-write###fortscale-generic-data-access-enriched-after-write###fortscale-4769-event-score###fortscale-ssh-event-score###fortscale-vpn-event-score###fortscale-kerberos-tgt-event-score###fortscale-generic-data-access-event-score###fortscale-4769-event-score-after-write###fortscale-ssh-event-score-after-write###fortscale-vpn-event-score-after-write###fortscale-vpnsession-event-score-after-write###fortscale-kerberos-tgt-score-after-write###fortscale-generic-data-access-score-after-write"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "hdfs-write-authenticationscores-changelog###hdfs-write-authenticationscores_top-changelog###hdfs-write-sshscores-changelog###hdfs-write-sshscores_top-changelog###hdfs-write-vpndatares-changelog###hdfs-write-vpndatares_top-changelog###hdfs-write-vpnsessiondatares-changelog###hdfs-write-vpnsessiondatares_top-changelog###hdfs-write-crmsfscore-changelog###hdfs-write-crmsfscore_top-changelog###hdfs-write-gwamescore-changelog###hdfs-write-gwamescore_top-changelog###hdfs-write-kerberostgtscore-changelog###hdfs-write-kerberostgtscore_top-changelog###hdfs-write-ntlmscore-changelog###hdfs-write-ntlmscore_top-changelog###hdfs-write-oraclescore-changelog###hdfs-write-oraclescore_top-changelog###hdfs-write-prnlogscore-changelog###hdfs-write-prnlogscore_top-changelog###hdfs-write-wamescore-changelog###hdfs-write-wamescore_top-changelog"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "user-score-task-store-changelog###feature_buckets_store-changelog###model_building_store-changelog###fortscale-aggregation-events-control###fortscale-model-building-control-input###fortscale-model-building-control-output"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "model_building_store"
      }
    ]
  },
  "AggregatedEventsToEntityEvents": {
    "description": "This step cleans the aggregated indicators created during the run of the step and the aggregated event models in the model_....daily/hourly collections",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@evidenceType:::AnomalyAggregatedEvent###^model_((?!entity).)*(daily|hourly)$%%%regex@@@date:::endTime"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "AggrFeatureEventToSend@@@date:::endTime###scored___aggr%%%prefix@@@date:::end_time_unix###entity_event_%%%prefix@@@date:::endTime"
      }
    ],
    "otherSteps": [
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity_events_store###aggregated-feature-events-model-cache-store###model_building_store"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-aggregated-feature-f-event###fortscale-aggregated-feature-p-event###fortscale-aggr-feature-events-score###metrics"
      }
    ]
  },
  "EntityEventsCreation": {
    "description": "This step cleans the entity events created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "^model_.*(entity){1}.*(daily|hourly)$%%%regex@@@date:::endTime###scored___entity_event%%%prefix@@@date:::end_time_unix"
      }
    ],
    "otherSteps": [
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "entity-events-model-cache-store"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-entity-event###metrics"
      }
    ]
  },
  "ScoredEventsToIndicators": {
    "description": "This step cleans the single indicators created during the running of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalySingleEvent"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-4769-event-score-after-write###fortscale-ssh-event-score-after-write###fortscale-vpn-event-score-after-write###fortscale-vpnsession-event-score-after-write###__samza_checkpoint_4769-user-score_1-0###__samza_checkpoint_vpn-user-score_1-0###__samza_checkpoint_ssh-user-score_1-0###__samza_checkpoint_evidence-creation-task_1-0###metrics"
      }
    ]
  },
  "NotificationsToIndicators": {
    "description": "This step cleans the notification indicators created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Notification"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-notification-event-score###__samza_checkpoint_evidence-creation-task_1-0"
      }
    ]
  },
  "AlertGeneration": {
    "description": "This step cleans the alerts and tag indicators created during the run of the step",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "alerts@@@date:::endDate###evidences@@@date:::endDate%%%evidenceType:::Tag"
      }
    ],
    "otherSteps": [
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "fortscale-evidences###fortscale-entity-event-score###__samza_checkpoint_alert-generator-task_1-0###metrics"
      }
    ]
  },
  "AfterETL": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the ETL phase regardless of the dates entered!! (does not affect the data tables)",
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "model@@@prefix###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix###streaming_@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata###enricheddata"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###entity_events_store###feature_buckets_store###hdfs-write-4769enriched###hdfs-write-sshenriched###hdfs-write-vpnenriched###aggregated-feature-events-model-cache-store###user-score-task-store###entity-events-model-cache-store###model_building_store###raw-events-model-cache-store"
      }
    ]
  },
  "AfterEnriched": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the Enrich phase regardless of the dates entered!! (does not affect the data and enrich tables)",
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "model@@@prefix###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "HDFS",
        "strategy": "DELETE",
        "dataSources": "processeddata"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "hdfs-write-authenticationscores###hdfs-write-authenticationscores_top###hdfs-write-sshscores###hdfs-write-sshscores_top###hdfs-write-vpndatares###hdfs-write-vpndatares_top###hdfs-write-vpnsessiondatares###hdfs-write-vpnsessiondatares_top###entity_events_store###feature_buckets_store###aggregated-feature-events-model-cache-store###user-score-task-store###entity-events-model-cache-store###model_building_store###raw-events-model-cache-store"
      }
    ]
  },
  "AfterScored": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the Scoring phase regardless of the dates entered!! (does not affect the data, enrich and scoring tables)",
    "timeBasedSteps": [

    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "^model_.*(daily|hourly)$%%%regex###alerts###evidences###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "aggregated-feature-events-model-cache-store###entity_events_store###entity-events-model-cache-store###feature_buckets_store###"
      }
    ]
  },
  "AfterSingleIndicators": {
    "description": "This step cleans EVERYTHING!!!!exclamation mark!! after the creation of single indicators regardless of the dates entered!! (does not affect any of the tables and single indicators)",
    "timeBasedSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Tag"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::AnomalyAggregatedEvent"
      },
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "evidences@@@date:::endDate%%%evidenceType:::Notification"
      }
    ],
    "otherSteps": [
      {
        "technology": "MONGO",
        "strategy": "DELETE",
        "dataSources": "^model_.*(daily|hourly)$%%%regex###alerts###ad_user_features_extraction###feature_bucket_strategies###Feature@@@prefix###aggr@@@prefix###entity@@@prefix###scored@@@prefix"
      },
      {
        "technology": "KAFKA",
        "strategy": "DELETE",
        "dataSources": "ALL"
      },
      {
        "technology": "STORE",
        "strategy": "DELETE",
        "dataSources": "feature_buckets_store###aggregated-feature-events-model-cache-store###entity_events_store###entity-events-model-cache-store"
      }
    ]
  }
}