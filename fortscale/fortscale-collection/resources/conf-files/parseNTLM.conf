morphlines : [
  {
    id : ntlmParsing
    importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
    commands : [

      {logDebug {format: "Debug -1 : {}", args: ["@{}"]}}

      # parse the raw message, extract all fields from the message, assuming the following format:
      # _time ,Logon_Account, Error_Code , Source_Workstation, ComputerName
      # "2015-12-10T05:43:11.000+0200",esm,0x0,MCAFEE,"Fs-DC-01.Fortscale.dom"
      {
        split{
          inputField : message
          outputFields :[date_time,username,failure_code,hostname,computer_name]
          separator : ","
          isRegex: false
          addEmptyStrings: true
          trim: true
        }
      }

      {logDebug {format: "Debug -2 : {}", args: ["@{}"]}}


      {
        EmptyObjectFilter {
          filterFields: [date_time,username,failure_code]
        }
      }

      {logDebug {format: "Debug -3 : {}", args: ["@{}"]}}

      {
        findReplace {
          field: date_time
          pattern: "\""
          isRegex: false
          replacement: ""
          replaceFirst: false
        }
      }
      {
        findReplace {
          field: username
          pattern: "\""
          isRegex: false
          replacement: ""
          replaceFirst: false
        }
      }
      {
        findReplace {
          field: failure_code
          pattern: "\""
          isRegex: false
          replacement: ""
          replaceFirst: false
        }
      }
	  
	  {
        findReplace {
          field: hostname
          pattern: "\""
          isRegex: false
          replacement: ""
          replaceFirst: false
        }
      }
      {
        findReplace {
            field: computer_name
            pattern: "\""
            isRegex: false
            replacement: ""
            replaceFirst: false
          }
        }
      {logDebug {format: "Debug -4 : {}", args: ["@{}"]}}

    ]
  }
]
