morphlines : [
	{
		id : morphline1
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			{
				split {
					inputField: message
					#Nov 30 2015 21:40:33: %CHKPNT-6-031085: decrypt,10.156.22.181,inbound,Lan3,10.110.74.43,60607,224.0.0.252,5355,5355,udp,29, , , , , , , , , , , , ,ESP: 3DES + SHA1,10.110.74.43,IKE, , , , , , , , ,30Nov2015 21:40:33,0,VPN-1 & FireWall-1, , , , ,priya_murugesan, , ,udp-high-ports, , , , , , , , , , , , , , , , , , , , , , , ,031085, , , , , , , , , , , , ,RemoteAccess, , ,{686BDE51-7603-4B98-B4B1-599776346986},Access to Intranet, , , ,					outputFields: ["", "", "", "", "", "", "", "", "", "", "", "", service_name, account_domain, account_name, service_id, "", "", "", "", failure_code]
					outputFields: [date_time_full, reporting_server, "", "", source_ip, "", local_ip, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", username]
					separator: ","
				}
			}

			{
				split {
					inputField: date_time_full
					outputFields: [date_time]
					separator: ": "
				}
			}

			{
				addValues {
					timezone : "UTC"
				}
			}

			{
				setValues {
					status : ["SUCCESS"]
					date_time_unix: "@{date_time}"
				}
			}


			{
				EmptyObjectFilter {
					filterFields : [username]
				}
			}

			{
				if {
				  conditions : [
					{ equals { timezone : [] }}
				  ]
				  then : [
					{
						GetTimezone {
							sourceType : "sec"
							hostnameField : reporting_server
							timezoneOutputField : timezone_input
						}
					}
				  ]
				  else : [
					{
						addValues {
							timezone_input : "@{timezone}"
						}
					}
				  ]
				}
			}
			{
				tryRules {
					catchExceptions : true
					throwExceptionIfAllRulesFailed : false
					rules : [
						{
							commands : [
								{
									convertTimestampFortscale {
										field : date_time
										inputFormats: ["MMM dd yyyy HH:mm:ss", "MMM dd yyyy  HH:mm:ss"]
										inputTimezoneField : timezone_input
										outputFormat : "yyyy-MM-dd HH:mm:ss"
									}
								}
								
								{
									convertTimestampFortscale {
										field : date_time_unix
										inputFormats: ["MMM dd yyyy HH:mm:ss", "MMM dd yyyy  HH:mm:ss"]
										inputTimezoneField : timezone_input
										outputFormat : "unixTimeInSeconds"
                                    }
								}
							]
                        }
                        
						{
							commands : [
								{ logWarn { format : "Problem timeGenerated: {}", args : ["@{timeGenerated}"] } }
							]
                        }
					]
                }
			}


			{
				setValues {
					addsessiondata: true
				}
			}
		]
	}
]
