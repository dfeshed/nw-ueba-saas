morphlines : [
	{
		id : morphline1
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			
			{
				grok {
					dictionaryFiles : [resources/grok-dictionaries/dhcp.dhcpd.conf]
					expressions : {
						message : "%{DHCP_IP:ip}|%{HOSTNAME:hostname}|%{DHCP_DATE:date_time}|%{MAC:mac_address}"
					}
					findSubstrings : true
				}
			}

			# Adding year from the system current date to the date_time.
			{
				java {
					imports : "import java.util.*;import java.text.SimpleDateFormat;"
					code:
						"""
						Object date_time = record.getFirstValue("date_time");
						int year = Calendar.getInstance().get(Calendar.YEAR);
						record.replaceValues("date_time", Integer.toString(year) + " " + date_time.toString());
						return child.process(record);
						"""
				}
			}		

			{
				tryRules {
					catchExceptions : false
					throwExceptionIfAllRulesFailed : false
					rules : [
						{
							commands : [
								{
									addValues {				
										date_time_epoch : "@{date_time}"
									}
								}	
								
								{
									convertTimestamp {
										field : date_time_epoch
										inputFormats : [ "yyyy MMM d HH:mm:ss"]
										outputFormat : "unixTimeInSeconds"
									}
								}

								{
									convertTimestamp {
										field : date_time
										inputFormats : [ "yyyy MMM d HH:mm:ss"]
										outputFormat : "yyyy-MM-dd HH:mm:ss"
									}
								}
							]
						}

						{
							commands : [
								{ logInfo { format : "Timestamps addition and conversion could not be completed on record: {}", args : ["@{}"] } }
								{ dropRecord {} }
							]
						}
					]
				}
			}
		]
	}
]