morphlines : [
	{
		id : morphline1
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			
			{
				grok {
					dictionaryFiles : [resources/grok-dictionaries/dhcp.dhcpd.conf]
					expressions : {
						message : "%{DHCP_IP:ipaddress}|%{HOSTNAME:hostname}|%{DHCP_DATE:date_time}|%{MAC:macAddress}"
					}
					findSubstrings : true
				}
			}
			
			{
	    		if {
	          		conditions : [
	            		{ equals { hostname : [] } }
	          		]
	          		then : [
	          			{ logDebug { format : "Record does not contain hostname field, Drop the record. Original message was: {}", args : ["@{message}"] } }
	           			{ dropRecord {} }
	          		]
	        	}
			}
			{
				GetTimezone {
					sourceType : "dhcp"
					hostnameField : reporting_server
					timezoneOutputField : timezone_output
				}
			}
			
			# Adding year from the system current date to the date_time.
			{
				AddYearToDatetime {
					dateFormat :  "yyyy MMM d HH:mm:ss"
					timezone : timezone_output
				}
			}

			{
				tryRules {
					catchExceptions : false
					throwExceptionIfAllRulesFailed : false
					rules : [
						{
							commands : [
								{
									addValues {				
										timestampepoch : "@{date_time}"
									}
								}	
								
								{
									convertTimestamp {
										field : timestampepoch
										inputFormats : [ "yyyy MMM d HH:mm:ss"]
										inputTimezone : Asia/Jerusalem
										outputFormat : "unixTimeInSeconds"
										outputTimezone : UTC
									}
								}

							]
						}

						{
							commands : [
								{ logInfo { format : "Timestamps addition and conversion could not be completed on record: {}", args : ["@{}"] } }
								{ dropRecord {} }
							]
						}
					]
				}
			}			
		]
	}
]