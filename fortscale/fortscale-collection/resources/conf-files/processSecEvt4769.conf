morphlines : [
	{
		id : morphline1
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]

		commands : [
		{
			if {
				conditions : [
					{ not {equals { account_name : [] } } }
					{ not {equals { service_name : [] } } }
					{ not {equals { client_address : [] } } }
				]
				then : []
				else : [
					{ logDebug { format : "Record does not contain either AccountName, CliendAddress or ServiceName field, Drop the record. Original message was: {}", args : ["@{message}"] } }
					{ dropRecord {} }				
				]
			}
		}

		{
			GetHostnameFromMongo {
				ipAddress : client_address
				timeStamp: timeGeneratedUnixTime
				outputRecordName : client_hostname
				host : "127.0.0.1"
				port : 27017
				db: "fortscale"
				collection : "dhcp_log"
				leaseTimeInMins : 2880
			}
		}
		{
			if {
				conditions : [
					# if client_hostname empty then
					{ equals  { client_hostname : [""] } }
				]
				then : [
				{
					GetHostnameFromDNS {
						ip_address : client_address
						output_record_name : client_hostname
						remove_last_dot : true
					}
				}
				]
			}
		}
		]
	}
]