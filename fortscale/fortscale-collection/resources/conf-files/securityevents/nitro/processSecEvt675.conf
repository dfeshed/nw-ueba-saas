morphlines: [
  {
    id: 675SecEvent
    importCommands: ["org.kitesdk.morphline.**", "org.apache.solr.**", "fortscale.collection.morphlines.**"]

    commands: [
      {logDebug {format: "Debug -1 : {}", args: ["@{}"]}}
      {
        tryRules {
          catchExceptions: true
          throwExceptionIfAllRulesFailed: false
          rules: [
            {
              commands: [
                {logDebug {format: "Debug -2 : {}", args: ["@{}"]}}
                {
                  grok {
                    dictionaryFiles: [resources/grok-dictionaries/sec.675.conf]
                    findSubstrings: true
                    addEmptyStrings: true
                    numRequiredMatches: all
                    expressions: {
                      message: "%{FAILURE_CODE:failure_code}|%{PRE_AUTHENTICATION_TYPE:pre_authentication_type}"
                    }
                  }
                }
                {logDebug {format: "Debug -3 : {}", args: ["@{}"]}}
              ]
            }
          ]
        }
      }
      {logDebug {format: "Debug -4 : {}", args: ["@{}"]}}
      {
        if {
          conditions: [
            {equals {failure_code: []}}
          ]
          then: [
            {logWarn {format: "Record does not contain failure_code field, Drop the record. Original message was: {}", args: ["@{message}"]}}
            {LogFilterEvent { errorMessage: "Record does not contain failure_code field"}}
            {dropRecord {}}
          ]
        }
      }
      {logDebug {format: "Debug -5 : {}", args: ["@{}"]}}
      {
        setValues {
          status: ["FAILURE"]
        }
      }
      {logDebug {format: "Debug -6 : {}", args: ["@{}"]}}
    ]
  }
]