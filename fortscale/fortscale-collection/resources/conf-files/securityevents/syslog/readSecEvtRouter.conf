morphlines : [
  {
    id : morphline1
    importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]

    commands : [
      {
        grok {
          dictionaryString : """
								DATE .+(?<= \d\d:\d\d:\d\d)
								TEXT .+
								 """
          findSubstrings : true
          addEmptyStrings : true
          numRequiredMatches : all
          expressions : {
            message : """%{DATE:date_time}\s%{TEXT:messageData}"""
          }
        }
      }
      {
        tryRules {
          catchExceptions : true
          throwExceptionIfAllRulesFailed : false
          rules : [
            {
              commands : [
                {
                  grok {
                    dictionaryString : """
		  						EVENT_CODE (?<=\[success\]\040)[0-9]+|(?<=\[failure\]\040)[0-9]+
		  						ACCOUNT_NAME (?<=Account Name:).+?(?=Supplied Realm Name)|(?<=Account Name:).+?(?=Account Domain)|(?<=Account Name:).+?(?=Service Information)
								 """
                    findSubstrings : true
                    addEmptyStrings : true
                    numRequiredMatches : all
                    expressions : {
                      messageData : "%{ACCOUNT_NAME:account_name}|%{EVENT_CODE:eventCode}"
                    }
                  }
                }
                { toString { field : account_name, trim : true } }
              ]
            }
          ]
        }
      }
      {
        EmptyObjectFilter {
          filterFields : [account_name,eventCode]
        }
      }


      # Adding isComputer.
      {
        java {
          imports : "import java.util.*;"
          code:
            """
            Boolean isComputer = false;
            List<String> fieldValues = record.get("account_name");
            for(String account_name: fieldValues){
              if(account_name.contains("$")){
                isComputer = true;
                break;
              }
            }
            record.replaceValues("isComputer", isComputer);
            return child.process(record);
            """
        }
      }
      {
            AddYearToDatetime {
              dateFormat :  "yyyy MMM dd HH:mm:ss"
              timezone : timezone_input
            }
          }
      {
      addValues {
            date_time_unix: "@{date_time}"
          }
      }
      {
      convertTimestampFortscale {

                    field: date_time_unix
                    inputTimezoneField: timezone_input
                    outputFormat: "unixTimeInSeconds"
            }
      }
    ]
  }
]
