morphlines : [
	{
		id : sec4624
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			{
				split {
					inputField: message
					outputFields: ["", "", account_name, account_domain, source_ip, logon_process]
					separator: ","
				}
			}
			{ toString { field : account_name, trim : true } }
			{ toString { field : source_ip, trim : true } }
			{ toString { field : logon_process, trim : true } }
			{ toString { field : account_domain, trim : true } }
			{
				EmptyObjectFilter {
					filterFields : [account_name, account_domain, source_ip, logon_process]
				}
			}
			{
				if {
					conditions : [
						{ not { equals { logon_process : [Kerberos] } } }
					]
					then : [
						{LogFilterEvent { errorMessage: "Non Kerberos Event"}}
						{ dropRecord {} }
					]
				}
			}
			{
				if {
					conditions : [
						{ equals { source_ip : ["::1"] } }
					]
					then : [
					    {LogFilterEvent { errorMessage: "Local IPv6 Address"}}
						{ dropRecord {} }
					]
				}
			}
			{
				if {
					conditions : [
						{ equals { source_ip : ["127.0.0.1"] } }
					]
					then : [
					    {LogFilterEvent { errorMessage: "Local IPv4 Address"}}
						{ dropRecord {} }
					]
				}
			}
			{ FilterAccountNameIsNotComputer {indexOfAccountName: 0} }
			{
				FilterOUMachine {
					hostnameField : account_name
					regex : "(.+)\\$$# #$1"
				}
			}
			{
				addValues {
					timezone: "UTC"
					timezone_input : "@{timezone}"
					date_time_unix : "@{date_time}"
				}
			}
			{
				convertTimestampFortscale {
					field : date_time_unix
					inputTimezoneField : timezone_input
					outputFormat : "unixTimeInSeconds"
				}
			}
			{
				ComputerLoginUpdate {
					timestampepoch_field : date_time_unix
					ipaddress_field: source_ip
					hostname_field : account_name
					domain_field : account_domain
					max_batch_size : 10000
				}
			}
			{
				addValues {
					isADHostName : true
				}
			}
		]
	}
]