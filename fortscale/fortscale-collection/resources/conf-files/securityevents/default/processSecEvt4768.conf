morphlines: [
  {
    id: morphline1
    importCommands: ["org.kitesdk.morphline.**", "org.apache.solr.**", "fortscale.collection.morphlines.**"]
    commands: [
      {
        split {
          inputField: message
          outputFields: ["", "", account_name, account_domain, failure_code, authentication_type, security_id]
          separator: ","
        }
      }
      {toString {field: account_domain, trim: true}}
      {toString {field: security_id, trim: true}}
      {toString {field: authentication_type, trim: true}}
      {toString {field: failure_code, trim: true}}
      {
        findReplace {
          field: security_id
          isRegex: false
          pattern: "'"
          replacement: ""
        }
      }
      {
        EmptyObjectFilter {
          filterFields: [account_domain, failure_code]
        }
      }
      {
        if {
          conditions: [
            {equals {isComputer: [true]}}
          ]
          then: [
            {
              FilterOUMachine {
                hostnameField: account_name
                regex: "(.+)\\$$# #$1"
              }
            }
            {
              ComputerLoginUpdate {
                timestampepoch_field: date_time_unix
                ipaddress_field: client_address
                hostname_field: account_name
                domain_field: account_domain
              }
            }
          ]
          else: [
            {
              if {
                conditions: [
                  {equals {failure_code: [0x0]}}
                ]
                then: [
                  {
                    setValues {
                      status: ["SUCCESS"]
                    }
                  }
                ]
                else: [
                  {
                    setValues {
                      status: ["FAILURE"]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  }
]