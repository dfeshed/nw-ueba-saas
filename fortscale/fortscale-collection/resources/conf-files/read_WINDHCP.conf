# ID,Date,Time,Description,IP Address,Host Name,MAC Address,User Name, TransactionID, QResult,Probationtime, CorrelationID,Dhcid
# 11,11/21/13,14:37:41,Renew,192.168.0.145,iPhone.Fortscale.dom,40A6D9774E8C,,1716278437,0,,,

morphlines : [
  {
    id : morphline1
    importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
    
    commands : [	
		{
			split {
				inputField : message
				outputFields: [ID,Date,Time,Description,ipaddress,hostname,macAddress,User Name, TransactionID, QResult,Probationtime, CorrelationID,Dhcpid]
				separator : ","
			}
		}
        
		{
	    	if {
	          	conditions : [
	            	{ equals { hostname : [] } }
	          	]
	          	then : [
	          		{ logDebug { format : "record does not contain hostname field: {}", args : ["@{}"] } }
	           		{ dropRecord {} }
	          	]
	        }
		}
		
		{
		tryRules {
		  catchExceptions : false
		  throwExceptionIfAllRulesFailed : false
		  rules : [
		    {
		      commands : [
				{
					addValues {				
					  timestampepoch : "@{Date} @{Time}" # 11/21/13 15:36:57
					}
				}

				{
					GetTimezone {
						sourceType : "dhcp"
						timezoneOutputField : timezone_output
					}
				}
				{
					convertTimestampFortscale {
						field : timestampepoch
						inputFormats : [ "MM/dd/yy HH:mm:ss"]
						inputTimezoneField : timezone_output
						outputFormat : "unixTimeInSeconds"
					}
				}
		
		        
			]
		    }
		
		    {
		      commands : [
		      		{ logInfo { format : "Timestamp epoch cannot be converted for recrod: {}", args : ["@{}"] } }
	           		{ dropRecord {} }
		      ]
		    }
		  ]
		}
		}	
	]
  }
]