# Morphline to process normalized dhcp events

morphlines : [
  {
    id : processDHCP
    importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
    
    commands : [
    	# check that all fields are set in the dhcp event
    	{
    		EmptyObjectFilter {
          		filterFields : [timestampepoch,ipaddress,hostname,action]
        	}
    	}
    	{
    		if {
				conditions : [
					{ equals { action : ["ASSIGN"] } }
				]
				then : [
					{
						EmptyObjectFilter {
							filterFields : [expiration]
						}
					}
				]
			} 
    	}
    
		# check if the hostname is in AD
		{
			IsADComputer {
				hostnameField : "hostname"
				outputField : "adHostName"
			}
		}	
	]
  }
]
