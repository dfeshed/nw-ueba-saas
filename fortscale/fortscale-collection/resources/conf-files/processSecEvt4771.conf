morphlines : [
	{
	    id : morphline1
	    importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]

    	commands : [
    	{
			tryRules {
		  		catchExceptions : true
		  		throwExceptionIfAllRulesFailed : false
		  		rules : [
				{
			  		commands : [
	  				{
						grok {
		  					dictionaryString : """
								SECURITY_ID (?<=Security ID:).+(?=Account Name:)
							  	ACCOUNT_NAME (?<=Account Name:).+(?=Service Information:)
							  	SERVICE_NAME (?<=Service Name:).+(?=Network Information:)
							  	FAILURE_CODE (?<=Failure Code:).+(?=Pre-Authentication Type:)
							  	PRE_AUTHENTICATION_TYPE (?<=Pre-Authentication Type:).+(?=Certificate Information:)
								 """
		  					findSubstrings : true
						  	addEmptyStrings : true
						  	numRequiredMatches : all
						  	expressions : {
								messageData : "%{SECURITY_ID:security_id}|%{ACCOUNT_NAME:account_name}|%{SERVICE_NAME:service_name}|%{FAILURE_CODE:failure_code}|%{PRE_AUTHENTICATION_TYPE:authentication_type}"
						  	}
						}
      				}
      				{ toString { field : account_name, trim : true } }
      				{ toString { field : account_domain, trim : true } }
      				{ toString { field : authentication_type, trim : true } }
      				{ toString { field : failure_code, trim : true } }
			  		]
				}
				{
					# fallback rule when grok failed to match properties
					commands : [
						{ dropRecord {} }    
					]
				}
		  	]
			}
		}
		{ 
			if { 
				conditions : [ 
					{ equals { account_name : [] } } 
				] 
				then : [
				{ 
					dropRecord{} 
				}
				] 
			} 
		}
		{ 
			if { 
				conditions : [ 
					{ equals { security_id : [] } } 
				] 
				then : [
				{ 
					dropRecord{} 
				}
				] 
			} 
		}
		{ 
			if { 
				conditions : [ 
					{ equals { failure_code : [] } } 
				] 
				then : [
				{ 
					dropRecord{} 
				}
				] 
			} 
		}
		{
			setValues {
				status : ["FAILURE"]
			}
		}
    	]
  	}
]
