# Morphline file that parse cisco dhcp events into canonical format
# 2014-09-29T00:59:59.000+00:00,,10.16.118.184,VDI-CRDC-001,00:50:56:bd:00:02,09/29/2014 21:12:08 UTC 


morphlines : [
  {
    id : parseCiscoDHCP
    importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
    
    commands : [
			{logDebug {format: "Debug -1 : {}", args: ["@{}"]}}
		{
			split {
				inputField : message
				outputFields: [timestampepoch,action,ipaddress,hostname,macAddress,expiration]
				separator : ","
			}
		}
			{logDebug {format: "Debug -2 : {}", args: ["@{}"]}}
		# drop events with missing ip or hostname
		{
        	EmptyObjectFilter {
          		filterFields : [timestampepoch,ipaddress,hostname]
        	}
      	}
			{logDebug {format: "Debug -3 : {}", args: ["@{}"]}}
		# set action codes value
		{
			if {
				conditions : [
					{ equals { action : [] } }
				]
				then : [
					{
						setValues {
							action : "ASSIGN"
						}
					}
				]
			}
		}
			{logDebug {format: "Debug -4 : {}", args: ["@{}"]}}
		# convert event time to utc timestamp
		{
			convertTimestampFortscale {
			  field : timestampepoch
			  outputFormat : "unixTimeInSeconds"
			}
		}
			{logDebug {format: "Debug -5 : {}", args: ["@{}"]}}
		# convert expiration time to utc timestamp
		{
			convertTimestampFortscale {
			  field : expiration
			  outputFormat : "unixTimeInSeconds"
			}
		}
			{logDebug {format: "Debug -6 : {}", args: ["@{}"]}}
	]
  }
]