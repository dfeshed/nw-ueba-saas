# Morphline to process normalized dhcp events

morphlines: [
  {
    id: processDHCP
    importCommands: ["org.kitesdk.morphline.**", "org.apache.solr.**", "fortscale.collection.morphlines.**"]

    commands: [
      {logDebug {format: "Debug -1 : {}", args: ["@{}"]}}
      # check that all fields are set in the dhcp event
      {
        EmptyObjectFilter {
          filterFields: [timestampepoch, ipaddress, hostname, action]
        }
      }
      {logDebug {format: "Debug -2 : {}", args: ["@{}"]}}
      {
        if {
          conditions: [
            {equals {action: ["ASSIGN"]}}
          ]
          then: [
            {
              EmptyObjectFilter {
                filterFields: [expiration]
              }
            }
          ]
        }
      }
      {logDebug {format: "Debug -3 : {}", args: ["@{}"]}}
      # check if the hostname is in AD
      {
        IsADComputer {
          hostnameField: "hostname"
          outputField: "adHostName"
        }
      }
      {logDebug {format: "Debug -4 : {}", args: ["@{}"]}}
    ]
  }
]
