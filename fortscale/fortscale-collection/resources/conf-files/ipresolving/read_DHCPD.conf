morphlines : [
	{
		id : morphline1
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			{logDebug {format: "Debug -1 : {}", args: ["@{}"]}}
			{
				grok {
					dictionaryFiles : [resources/grok-dictionaries/dhcp.dhcpd.conf]
					expressions : {
						message : "%{DHCP_IP:ipaddress}|%{HOSTNAME:hostname}|%{DHCP_DATE:date_time}|%{MAC:macAddress}|%{TIMEZONE:timezone}"
					}
					findSubstrings : true
				}
			}
			{logDebug {format: "Debug -2 : {}", args: ["@{}"]}}
			{
	    		if {
	          		conditions : [
	            		{ equals { hostname : [] } }
	          		]
	          		then : [
	          			{ logDebug { format : "Record does not contain hostname field, Drop the record. Original message was: {}", args : ["@{message}"] } }
	          			{ LogFilterEvent { errorMessage: "Record does not contain hostname field"}}
	           			{ dropRecord {} }
	          		]
	        	}
			}
			{logDebug {format: "Debug -3 : {}", args: ["@{}"]}}
			{
				if {
				  conditions : [
					{ equals { timezone : [] }}
				  ]
				  then : [
					{
						GetTimezone {
							sourceType : "dhcp"
							hostnameField : reporting_server
							timezoneOutputField : timezone_input
						}
					}
				  ]
				  else : [
					{
						addValues {
							timezone_input : "@{timezone}"
						}
					}
				  ]
				}
			}
			{logDebug {format: "Debug -4 : {}", args: ["@{}"]}}
			# Adding year from the system current date to the date_time.
			{
				AddYearToDatetime {
					dateFormat :  "yyyy MMM d HH:mm:ss"
					timezone : timezone_input
				}
			}
			{logDebug {format: "Debug -5 : {}", args: ["@{}"]}}
			{
				tryRules {
					catchExceptions : false
					throwExceptionIfAllRulesFailed : false
					rules : [
						{
							commands : [
								{
									addValues {				
										timestampepoch : "@{date_time}"
									}
								}	
								
								{
									convertTimestampFortscale {
										field : timestampepoch
										inputTimezoneField : timezone_input
										outputFormat : "unixTimeInSeconds"
									}
								}

							]
						}

						{
							commands : [
								{ logInfo { format : "Timestamps addition and conversion could not be completed on record: {}", args : ["@{}"] } }
								{ LogFilterEvent { errorMessage: "Timestamps addition and conversion could not be completed"}}
								{ dropRecord {} }
							]
						}
					]
				}
			}
			{logDebug {format: "Debug -6 : {}", args: ["@{}"]}}
		]
	}
]