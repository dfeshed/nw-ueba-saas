morphlines : [
	{
		id : morphline1
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			{
				grok {
					dictionaryFiles : [resources/grok-dictionaries/ssh.cisco.conf]
					expressions : {
						message : "%{TARGET_MACHINE_AS_IP:target_machine_ip}|%{TARGET_MACHINE:target_machine}|%{USERNAME:username}"
					}
					findSubstrings : true
					numRequiredMatches : all				
				}
			}
			# handle case that the target machine contain ip
            {
                if {
                    conditions : [
                            {not {equals : {target_machine_ip : [] }}}
                    ]
                    then : [

                            {
                                setValues {
                                    target_machine : []
                                }
                            }


                    ]
                }
            }
            {
				EmptyObjectFilter {
					filterFields : [username,target_machine]
				}
			}

			#the first overflow filter command insures that the overflow is not caused by a single user in the system
			{
				OverFlowFilter {
					eventsType : ssh
					criteria : [username]
					threshold : 100000
				}

			}
			{
				OverFlowFilter {
					eventsType : ssh
					criteria : []
					threshold : 1000000
				}
			}
			{
				SSHNormalizeUsername {
					usernameField : username
					normalizedUsernameField : normalized_username
				}
			}
		]
	}
]
