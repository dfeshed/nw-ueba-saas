morphlines : [
	{
		id : morphlineEnrich
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [



      # Computer clustering for both the source machine and the destimation machine

      {
        GetComputerClusterName {
          hostnameField : hostname
          clusterField : normalized_src_machine
        }
      }
      {
        GetComputerClusterName {
          hostnameField : target_machine
          clusterField : normalized_dst_machine
        }
      }



      # if status is "Accepted", we upadte the user's last-activity in Mongo
      {
        if {
          conditions : [
            { equals { status : ["Accepted"]  } }
          ]
          then : [
            {
              UserLastActivityUpdate {
                logEventsType : ssh
                normalizedUsernameField : normalized_username
                epochtimestampField : date_time_unix
              }
            }
          ]
        }
      }



      ### Tags

      # Update Sensitive tag if needed
      {
        IsSensitiveMachine {
          machineNameField : target_machine
          isSensitiveMachineField : is_sensitive_machine
        }
      }


      # Update Service tag if needed
      {
        IsUserServiceAccount {
          usernameField : normalized_username
          isUserServiceAccountField : isUserServiceAccount
        }
      }

      # Update Administrator tag if needed
      {
        IsUserAdministrator {
          usernameField : normalized_username
          isUserAdministratorField : isUserAdministrator
        }
      }

      # Update Executive tag if needed
      {
        IsUserExecutive {
          usernameField : normalized_username
          isUserExecutiveField : isUserExecutive
        }
      }

		]
	}
]
