morphlines : [
	{
		id : morphlineEnrich
		importCommands : ["org.kitesdk.morphline.**", "org.apache.solr.**","fortscale.collection.morphlines.**"]
		commands : [
			{
				if {
					conditions: [
						{ equals {normalized_username: [] } }
						{ not { equals {username: [] } } }
					]
					then: [
						{
							VPNNormalizeUsername {
								usernameField: username
								normalizedUsernameField: normalized_username
							}
						}
					]
				}
			}
			{
				VpnSessionUpdate {
					country_code_field : countrycode
					longtitude_field : longtitude
					latitude_field : latitude
					geo_hopping_open_session_threshold : 6
					geo_hopping_close_session_threshold : 1
					session_id_field : sessionid
					add_session_data: addsessiondata
				}
			}

			# Drop record if the following fields are empty
			{
				EmptyObjectFilter {
					filterFields : [username]
				}
			}

			{
				if {
					conditions: [
						{ equals {normalized_username: [] } }
					]
					then: [
						{
							VPNNormalizeUsername {
								usernameField: username
								normalizedUsernameField: normalized_username
							}
						}
					]
				}
			}
			#Adding data bucket
			{
				if {
					conditions: [{equals {status: ["CLOSED"]}}]
					then: [
						{
							VpnContinuousDataBucket {
								totalbytesFieldName: totalbytes
								readbytesFieldName: readbytes
								durationFieldName: duration
								databucketFieldName: databucket
							}
						}
					]
				}
			}
			{
				if {
					conditions: [{equals {status: ["SUCCESS"]}}]
					then: [
						{
							UserLastActivityUpdate {
								logEventsType: vpn
								normalizedUsernameField: normalized_username
								epochtimestampField: date_time_unix
							}
						}
					]
				}
			}


			{
				IsUserAdministrator {
					usernameField : normalized_username
					isUserAdministratorField : isUserAdministrator
				}
			}

			{
				IsUserExecutive {
					usernameField : normalized_username
					isUserExecutiveField : isUserExecutive
				}
			}


		]
	}
]
