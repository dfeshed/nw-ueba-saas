# Sources, channels, and sinks are defined per
# agent name, in this case 'tier1'.
tier1.sources  = source1
tier1.channels = channel1 channel3 channel4
tier1.sinks    = sink1 sink3 sink4

# For each source, channel, and sink, set
# standard properties.
#tier1.sources.source1.type     = syslogtcp
tier1.sources.source1.type     = multiport_syslogtcp
tier1.sources.source1.bind     = 192.168.45.31
#tier1.sources.source1.port     = 8514
tier1.sources.source1.ports     = 8514
tier1.sources.source1.eventSize = 4096
tier1.sources.source1.portHeader = port



tier1.sources.source1.interceptors = i1
tier1.sources.source1.interceptors.i1.type = fortscale.flume.HeaderRegexExtractorFilterInterceptor$Builder
#tier1.sources.source1.interceptors.i1.regex = (.*EventCode=4769.*Account Name:+\\s+[^\\$]+\\s+.* Service Name:+\\s+.*\\$+\\s|.*EventCode=4768.*Account Name:+\\s+[^\\$]+\\s)#(Security_4624_Microsoft-Windows-Security-Auditing.*Account Name:+\\s+.*\\$+\\s)#(Accepted password|Accepted publickey)
tier1.sources.source1.interceptors.i1.regex = (.*EventCode=4769.*Account Name:+\\s+[^\\$]+\\s+.* Service Name:+\\s+.*\\$+\\s|.*EventCode=4768.*Account Name:+\\s+[^\\$]+\\s)#(blaaaa)#(Accepted password|Accepted publickey)


tier1.sources.source1.interceptors.i1.headersToPut = 4769 4624 SSH
tier1.sources.source1.interceptors.i1.serializers = s1
tier1.sources.source1.interceptors.i1.serializers.s1.name = type

tier1.sources.source1.selector.type = multiplexing
tier1.sources.source1.selector.header = type

tier1.sources.source1.selector.mapping.4769 = channel1

tier1.sources.source1.selector.mapping.4624 = channel3
tier1.sources.source1.selector.mapping.SSH = channel4

tier1.sources.source1.channels = channel1 channel3 channel4
tier1.channels.channel4.type   = memory
tier1.channels.channel3.type   = memory
#tier1.channels.channel2.type   = memory
tier1.channels.channel1.type   = memory



tier1.sinks.sink1.type         = fortscale.flume.FileNameRollingFileSink
tier1.sinks.sink1.channel      = channel1
tier1.sinks.sink1.sink.directory = /home/cloudera/fortscale/fortscale-core/fortscale/fortscale-collection/target/input/
tier1.sinks.sink1.sink.rollInterval = 86400
tier1.sinks.sink1.sink.fileSuffix = csv
tier1.sinks.sink1.sink.filePrefix = SEC

tier1.sinks.sink1.batchSize = 10000
tier1.sinks.sink3.batchSize = 10000
tier1.sinks.sink4.batchSize = 10000


tier1.sinks.sink3.type         = fortscale.flume.FileNameRollingFileSink
tier1.sinks.sink3.channel      = channel3
tier1.sinks.sink3.sink.directory = /home/cloudera/fortscale/fortscale-core/fortscale/fortscale-collection/target/input/
tier1.sinks.sink3.sink.rollInterval = 86400
tier1.sinks.sink3.sink.fileSuffix = csv
tier1.sinks.sink3.sink.filePrefix = SEC-4624


tier1.sinks.sink4.type         = fortscale.flume.FileNameRollingFileSink
tier1.sinks.sink4.channel      = channel4
tier1.sinks.sink4.sink.directory = /home/cloudera/fortscale/fortscale-core/fortscale/fortscale-collection/target/input/
tier1.sinks.sink4.sink.rollInterval = 86400
tier1.sinks.sink4.sink.fileSuffix = csv
tier1.sinks.sink4.sink.filePrefix = SSH

# Other properties are specific to each type of
# source, channel, or sink. In this case, we
# specify the capacity of the memory channel.
tier1.channels.channel1.capacity = 10000
tier1.channels.channel1.transactionCapacity = 10000

#tier1.channels.channel2.capacity = 1000
#tier1.channels.channel2.transactionCapacity = 1000

tier1.channels.channel3.capacity = 10000
tier1.channels.channel3.transactionCapacity = 10000

tier1.channels.channel4.capacity = 10000
tier1.channels.channel4.transactionCapacity = 10000
