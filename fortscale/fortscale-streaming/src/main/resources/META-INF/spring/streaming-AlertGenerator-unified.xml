<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">




       <bean class="fortscale.streaming.alert.subscribers.evidence.applicable.AlertTypesHisotryCache">
              <property name="counsPerAlertsContextKey">
                     <bean class="fortscale.services.cache.MemoryBasedCache">
                            <constructor-arg name="maxSize" value="${adgroups.resolver.cache.max.items:30000}" />
                            <constructor-arg name="timeToExpire" value="${adgroups.resolver.blacklist.timeToExpireSec:3600}" />
                            <constructor-arg name="clazz" value="java.lang.Integer" />
                     </bean>
              </property>
       </bean>

       <bean name="alertTypeConfigurationService" class="fortscale.streaming.alert.subscribers.evidence.decider.AlertTypeConfigurationServiceImpl">
              <constructor-arg name="alertTypeConfigurations">
                     <set>
                            <bean class="fortscale.streaming.alert.subscribers.evidence.decider.AlertTypeConfigurationServiceImpl$AlertTypeConfiguration">
                                   <property name="evidenceType" value="${alert_type.vpn_geo_hopping.evidence_type:vpn_geo_hopping}"></property>
                                   <property name="alertTitle"   value="${alert_type.vpn_geo_hopping.alert_name:vpn_geo_hopping}"></property>
                                   <property name="namePriority" value="${alert_type.vpn_geo_hopping.name_priority:2}"></property>
                                   <property name="scorePriority" value="${alert_type.vpn_geo_hopping.score_priority:2}"></property>
                            </bean>
                            <bean class="fortscale.streaming.alert.subscribers.evidence.decider.AlertTypeConfigurationServiceImpl$AlertTypeConfiguration">
                                   <property name="evidenceType" value="${alert_type.smart.evidence_type:smart}"></property>
                                   <property name="alertTitle"   value="${alert_type.smart.alert_name:smart}"></property>
                                   <property name="namePriority" value="${alert_type.smart.name_priority:1}"></property>
                                   <property name="scorePriority" value="${alert_type.smart.score_priority:5}"></property>
                            </bean>
                            <bean class="fortscale.streaming.alert.subscribers.evidence.decider.AlertTypeConfigurationServiceImpl$AlertTypeConfiguration">
                                   <property name="evidenceType" value="${alert_type.BruteForce.evidence_type:BruteForce}"></property>
                                   <property name="alertTitle"   value="${alert_type.BruteForce.alert_name:BruteForce}"></property>
                                   <property name="namePriority" value="${alert_type.BruteForce.name_priority:4}"></property>
                                   <property name="scorePriority" value="${alert_type.BruteForce.score_priority:4}"></property>
                            </bean>
                     </set>
              </constructor-arg>
       </bean>

       <bean id="limitGeoHoppingPreAlertCreation" class="fortscale.streaming.alert.subscribers.evidence.applicable.LimitGeoHoppingPreAlertCreation"/>
       <bean id="limitNotificationAlertCreationPerDay" class="fortscale.streaming.alert.subscribers.evidence.applicable.LimitNotificationAlertAmountCreation"/>
       <bean id="filterUnconfiguredEvidences" class="fortscale.streaming.alert.subscribers.evidence.applicable.FilterUnconfiguredEvidences"/>

       <bean id="evidencesApplicableToAlertService" class="fortscale.streaming.alert.subscribers.evidence.applicable.AlertFilterApplicableEvidencesServiceImpl">
              <property name="alertCreatorCandidatesFilter">
                     <list value-type="fortscale.streaming.alert.subscribers.evidence.applicable.AlertPreAlertDeciderFilter">
                            <ref bean="limitGeoHoppingPreAlertCreation"/>
                            <ref bean="limitNotificationAlertCreationPerDay"/>
                            <ref bean="filterUnconfiguredEvidences"/>
                     </list>

              </property>
       </bean>

       <bean id="namePriorityDecider" class="fortscale.streaming.alert.subscribers.evidence.decider.PriorityDeciderImpl">
              <constructor-arg>
                     <value type="fortscale.streaming.alert.subscribers.evidence.decider.AlertTypeConfigurationServiceImpl.PriorityType">NAME_PRIORITY</value>
              </constructor-arg>
       </bean>
       <bean id="socrePriorityDecider" class="fortscale.streaming.alert.subscribers.evidence.decider.PriorityDeciderImpl">
              <constructor-arg>
                     <value type="fortscale.streaming.alert.subscribers.evidence.decider.AlertTypeConfigurationServiceImpl.PriorityType">SCORE_PRIORITY</value>
              </constructor-arg>
       </bean>
       <bean id="scoreDecider" class="fortscale.streaming.alert.subscribers.evidence.decider.ScoreDeciderImpl"/>
       <bean id="freshnessDecider" class="fortscale.streaming.alert.subscribers.evidence.decider.FreshnessDeciderImpl"/>

       <bean id="decider" class="fortscale.streaming.alert.subscribers.evidence.decider.AlertDeciderServiceImpl">
              <property name="nameDecidersList">
                     <util:list  list-class="java.util.ArrayList">
                            <ref bean="namePriorityDecider"/>
                            <ref bean="scoreDecider"/>
                            <ref bean="freshnessDecider"/>

                     </util:list>
              </property>
              <property name="scoreDecidersList">
                     <util:list  list-class="java.util.ArrayList">
                            <ref bean="socrePriorityDecider"/>
                            <ref bean="scoreDecider"/>
                            <ref bean="freshnessDecider"/>

                     </util:list>
              </property>
       </bean>

       <bean id="defaultTagToSeverityMapping" class="fortscale.streaming.alert.subscribers.TagsToSeverityMapping">
              <constructor-arg name="minScoreForCritical"      value="${severity.score.critical:95}" />
              <constructor-arg name="minScoreForHigh"          value="${severity.score.high:90}" />
              <constructor-arg name="minScoreForMedium"        value="${severity.score.medium:80}" />
       </bean>

       <bean id="priviligedTagToSeverityMapping" class="fortscale.streaming.alert.subscribers.TagsToSeverityMapping">
              <constructor-arg name="minScoreForCritical"      value="${severity.score.critical:90}" />
              <constructor-arg name="minScoreForHigh"          value="${severity.score.high:80}" />
              <constructor-arg name="minScoreForMedium"        value="${severity.score.medium:75}" />
       </bean>


</beans>