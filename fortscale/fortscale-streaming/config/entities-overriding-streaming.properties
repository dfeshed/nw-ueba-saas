leaf_entities = kerberos_logins, amt, logins, ssh, vpn, vpn_session, users,crmsf
base_entities = access_event, session, scored_access_event, standard_scored_access_event, auth_event, users, active_directory,customized_auth_event

entities.users.fields = id, severity, followed, normalized_username, ad_usernames, kerberos_logins_usernames, ssh_usernames, vpn_usernames, amt_usernames, kerberos_logins_score, ssh_score, vpn_score, amt_score, total_score, display_name, job_title, employee_id, employee_number, dn, ou, account_expiration_date, last_change_date, creation_date, street_address, company, division, room_number, account_is_disabled, password_expired, no_password_required, password_never_expires, direct_reports_dn, groups_dn, department, email, phone, mobile, home_phone, manager_name, manager_username, manager_id, account_disabled_date, last_activity_date, ssh_last_activity_date, vpn_last_activity_date, kerberos_logins_last_activity_date, amt_last_activity_date, is_user_service, is_user_administrator, is_user_executive
entities.customized_auth_event.fields = country, country_score, country_code, isp, region, city, action_type, action_type_score


entities.customized_auth_event.field.country.name = Country
entities.customized_auth_event.field.country.type = STRING
entities.customized_auth_event.field.country.score = country_score
entities.customized_auth_event.field.country.rank = 15
entities.customized_auth_event.field.country.searchable = true
entities.customized_auth_event.field.destination_machine_score.enabledByDefault = false

entities.customized_auth_event.field.country_score.name = Country Score
entities.customized_auth_event.field.country_score.type = NUMBER
entities.customized_auth_event.field.country_score.enabledByDefault = false
entities.customized_auth_event.field.country_score.rank = 995

entities.customized_auth_event.field.country_code.name = Country Code
entities.customized_auth_event.field.country_code.type = STRING
entities.customized_auth_event.field.country_code.enabledByDefault = false
entities.customized_auth_event.field.country_code.rank = 16
entities.customized_auth_event.field.country_code.searchable = true

entities.customized_auth_event.field.city.name = City
entities.customized_auth_event.field.city.type = STRING
entities.customized_auth_event.field.city.rank = 17
entities.customized_auth_event.field.city.searchable = true

entities.customized_auth_event.field.isp.name = ISP
entities.customized_auth_event.field.isp.type = STRING
entities.customized_auth_event.field.isp.enabledByDefault = false
entities.customized_auth_event.field.isp.rank = 19
entities.customized_auth_event.field.isp.searchable = true

entities.customized_auth_event.field.region.name = Region
entities.customized_auth_event.field.region.type = STRING
entities.customized_auth_event.field.region.enabledByDefault = false
entities.customized_auth_event.field.region.rank = 20
entities.customized_auth_event.field.region.searchable = true




######################################### CRMSF ###########################################

entities.crmsf.id = crmsf
entities.crmsf.name = Salesforce
entities.crmsf.nameForMenu = Crm Sales Force events
entities.crmsf.is_abstract = false
entities.crmsf.show_in_explore = true
entities.crmsf.short_name = CRMSF
entities.crmsf.extends = customized_auth_event
entities.crmsf.db = MySQL
entities.crmsf.table = crmsfscore
entities.crmsf.performance_table = crmsfscore_top
entities.crmsf.partitions=daily
entities.crmsf.partition.base.field = event_time_utc


############ Additional fields

entities.crmsf.fields = login_type,browser,platform,application,login_url,status_score

entities.crmsf.field.login_type.column=login_type
entities.crmsf.field.browser.column=browser
entities.crmsf.field.platform.column=platform
entities.crmsf.field.application.column=application
entities.crmsf.field.login_url.column=login_url

entities.crmsf.field.login_type.name =  Login Type
entities.crmsf.field.login_type.type = SELECT
entities.crmsf.field.login_type.score =
entities.crmsf.field.login_type.valueList = Application,Remote Access Client,AppStore,Remote Access 2.0,
entities.crmsf.field.login_type.rank = 10
entities.crmsf.field.login_type.lov = true

entities.crmsf.field.browser.name =  Browser
entities.crmsf.field.browser.type = SELECT
entities.crmsf.field.browser.score =
entities.crmsf.field.browser.valueList =Unknown,Chrome,Safari,Firefox,IE,Mobile
entities.crmsf.field.browser.rank = 10
entities.crmsf.field.browser.lov = true

entities.crmsf.field.platform.name =  Platform
entities.crmsf.field.platform.type = SELECT
entities.crmsf.field.platform.score =
entities.crmsf.field.platform.valueList = Android,iPhone,Mac,Windows,Unknown
entities.crmsf.field.platform.rank = 10
entities.crmsf.field.platform.lov = true

entities.crmsf.field.application.name =  Application
entities.crmsf.field.application.type = SELECT
entities.crmsf.field.application.score =
entities.crmsf.field.application.valueList =Browser,Desk.com,Pardot + Salesforce Connector,Pardot SSO,Salesforce Help & Training,Salesforce1 for ios,Yesware
entities.crmsf.field.application.rank = 10
entities.crmsf.field.application.lov = true

entities.crmsf.field.login_url.name =  Login URL
entities.crmsf.field.login_url.type = STRING
entities.crmsf.field.login_url.score =
entities.crmsf.field.login_url.valueList =
entities.crmsf.field.login_url.rank = 10
entities.crmsf.field.login_url.lov = true

entities.crmsf.field.status_score.name =  Status Score
entities.crmsf.field.status_score.type = NUMBER
entities.crmsf.field.status_score.score =
entities.crmsf.field.status_score.valueList =
entities.crmsf.field.status_score.rank = 10
entities.crmsf.field.status_score.lov = true
entities.amt_session.field.status_score.enabledByDefault = true



####### Actual schema definiition (logical to phisical mapping)
entities.crmsf.field.country.column=country
entities.crmsf.field.country_score.column=country_score
entities.crmsf.field.country_code.column=countryIsoCode
entities.crmsf.field.isp.column=isp
entities.crmsf.field.region.column=region
entities.crmsf.field.city.column=city
entities.crmsf.field.action_type.column=action_type
entities.crmsf.field.action_type_score.column=action_type_score
entities.crmsf.field.type.column = ${entities.crmsf.short_name}
entities.crmsf.field.username.column = username
entities.crmsf.field.normalized_username.column = normalized_username
entities.crmsf.field.source_machine.column = hostname
entities.crmsf.field.source_machine_score.column = source_machine_score
entities.crmsf.field.source_ip.column = source_ip
entities.crmsf.field.destination_machine.column = normalized_dst_machine
entities.crmsf.field.destination_machine_score.column = destination_machine_score
entities.crmsf.field.event_time.column = date_time
entities.crmsf.field.event_time_utc.column = date_time_unix
entities.crmsf.field.event_time_score.column = date_time_score
entities.crmsf.field.event_score.column = eventscore
entities.crmsf.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.crmsf.field.is_sensitive_machine.column = is_sensitive_machine
entities.crmsf.field.is_from_vpn.column =is_from_vpn
entities.crmsf.field.is_user_administrator.column = isUserAdministrator
entities.crmsf.field.is_user_executive.column = isUserExecutive
entities.crmsf.field.is_user_service.column = isUserServiceAccount
entities.crmsf.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end
entities.crmsf.field.lr.column=lr
entities.crmsf.field.status.column = status
entities.crmsf.field.status.score=status_score
entities.crmsf.field.status_score.column = status_score


## Select fields value lists
entities.crmsf.field.status.valueList = Failed: Computer activation required,Invalid Password,Organization Suspended,User is Frozen,Success


#### Hidden fiedls
entities.crmsf.field.destination_machine.attributes = internal
entities.crmsf.field.destination_machine.enabledByDefault = false
entities.crmsf.field.destination_machine_score.attributes = internal
entities.crmsf.field.action_type_score.attributes = internal
entities.crmsf.field.source_machine.attributes = internal
entities.crmsf.field.source_machine.enabledByDefault = false
entities.crmsf.field.source_machine_score.attributes = internal

entities.crmsf.field.event_time_utc.attributes = internal
entities.crmsf.field.is_from_vpn.attributes = internal
entities.crmsf.field.is_sensitive_machine.attributes = internal
entities.crmsf.field.lr.attributes  = internal









