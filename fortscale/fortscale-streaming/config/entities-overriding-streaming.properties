######################################################################################################################
#In order to override fortscale\fortscale-services\src\main\resources\META-INF\entities.properties
#
#######################################################################################################################

leaf_entities =  dlpmail,prnlog
base_entities = access_event, session, scored_access_event,  auth_event, users, active_directory, customized_auth_event

entities.users.fields = id, severity, followed, normalized_username, ad_usernames, kerberos_logins_usernames, ssh_usernames, vpn_usernames, display_name, job_title, employee_id, employee_number, dn, ou, account_expiration_date, last_change_date, creation_date, street_address, company, division, room_number, account_is_disabled, password_expired, no_password_required, password_never_expires, direct_reports_dn, groups_dn, department, email, phone, mobile, home_phone, manager_name, manager_username, manager_id, account_disabled_date, last_activity_date, ssh_last_activity_date, vpn_last_activity_date, kerberos_logins_last_activity_date

entities.prnlog.name=DLP Printing logs
entities.prnlog.nameForMenu=DLP Printers Events

######################################### dlpmail ###########################################

entities.dlpmail.id = dlpmail
entities.dlpmail.name = DLP - Mail Events
entities.dlpmail.nameForMenu = DLP - Mail events
entities.dlpmail.is_abstract = false
entities.dlpmail.show_in_explore = true
entities.dlpmail.short_name = dlpmail
entities.dlpmail.extends = scored_access_event
entities.dlpmail.db = MySQL
entities.dlpmail.table = mailscore
entities.dlpmail.performance_table = mailscore_top
entities.dlpmail.partitions=daily
entities.dlpmail.partition.base.field = event_time_utc


############ Additional fields

entities.dlpmail.fields = account_user_id,application,application_score,destination_file,detail_file_size_kb,DNS_hostname,email_recipient,email_recipient_domain,email_recipient_type,email_sender,email_subject,has_alert_event,has_src_classification,is_outbound,network_address,source_file,destination_file_type,source_file_type,detail_file_size_score ,email_sender_score  ,has_alert_event_score ,has_src_classification_score ,outbound_score ,full_name,email_recipient_domain_score

entities.dlpmail.field.account_user_id.column=account_user_id
entities.dlpmail.field.account_user_id.name =  Account User ID
entities.dlpmail.field.account_user_id.type = STRING
entities.dlpmail.field.account_user_id.rank = 80
entities.dlpmail.field.account_user_id.lov = true
entities.dlpmail.field.account_user_id.attributes = internal
entities.dlpmail.field.account_user_id.enabledByDefault=false


entities.dlpmail.field.full_name.column=full_name
entities.dlpmail.field.full_name.name =  Display Name
entities.dlpmail.field.full_name.type = STRING
entities.dlpmail.field.full_name.rank = 2
entities.dlpmail.field.full_name.lov = true
#entities.dlpmail.field.full_name.enabledByDefault=false

entities.dlpmail.field.application.column=application
entities.dlpmail.field.application.name =  Application
entities.dlpmail.field.application.score = application_score
entities.dlpmail.field.application.type = STRING
entities.dlpmail.field.application.rank = 3
entities.dlpmail.field.application.lov = true


entities.dlpmail.field.destination_file.column=destination_file
entities.dlpmail.field.destination_file.name =  Attachment File
entities.dlpmail.field.destination_file.type = STRING
entities.dlpmail.field.destination_file.rank = 5
entities.dlpmail.field.destination_file.lov = true
#entities.dlpmail.field.destination_file.enabledByDefault=false

entities.dlpmail.field.detail_file_size_kb.column=detail_file_size_kb
entities.dlpmail.field.detail_file_size_kb.name =  Detail File Size KB
entities.dlpmail.field.detail_file_size_kb.score = detail_file_size_score
entities.dlpmail.field.detail_file_size_kb.type = NUMBER
entities.dlpmail.field.detail_file_size_kb.rank = 190
entities.dlpmail.field.detail_file_size_kb.lov = true
entities.dlpmail.field.detail_file_size_kb.format = sizeBytes
entities.dlpmail.field.detail_file_size_kb.enabledByDefault=false

entities.dlpmail.field.DNS_hostname.column=DNS_hostname
entities.dlpmail.field.DNS_hostname.name =  DNS Hostname
entities.dlpmail.field.DNS_hostname.type = STRING
entities.dlpmail.field.DNS_hostname.rank = 200
entities.dlpmail.field.DNS_hostname.lov = true
#entities.dlpmail.field.DNS_hostname.attributes = internal
entities.dlpmail.field.DNS_hostname.enabledByDefault=false


entities.dlpmail.field.email_recipient.column=email_recipient
entities.dlpmail.field.email_recipient.name =  Email Recipient
entities.dlpmail.field.email_recipient.type = STRING
entities.dlpmail.field.email_recipient.rank = 10
entities.dlpmail.field.email_recipient.lov = true

entities.dlpmail.field.email_recipient_domain.column=email_recipient_domain
entities.dlpmail.field.email_recipient_domain.name =  Email Recipient Domain
entities.dlpmail.field.email_recipient_domain.score = email_recipient_domain_score
entities.dlpmail.field.email_recipient_domain.type = STRING
entities.dlpmail.field.email_recipient_domain.rank = 250
entities.dlpmail.field.email_recipient_domain.lov = true
#entities.dlpmail.field.email_recipient_domain.attributes = internal
entities.dlpmail.field.email_recipient_domain.enabledByDefault=false

entities.dlpmail.field.email_recipient_type.column=email_recipient_type
entities.dlpmail.field.email_recipient_type.name =  Email Recipient Type
entities.dlpmail.field.email_recipient_type.type = STRING
entities.dlpmail.field.email_recipient_type.rank = 260
entities.dlpmail.field.email_recipient_type.lov = true
#entities.dlpmail.field.email_recipient_type.attributes = internal
entities.dlpmail.field.email_recipient_type.enabledByDefault=false

entities.dlpmail.field.email_sender.column=email_sender
entities.dlpmail.field.email_sender.name =  Email Sender
entities.dlpmail.field.email_sender.score = email_sender_score
entities.dlpmail.field.email_sender.type = STRING
entities.dlpmail.field.email_sender.rank = 4
entities.dlpmail.field.email_sender.lov = true

entities.dlpmail.field.email_subject.column=email_subject
entities.dlpmail.field.email_subject.name =  Email Subject
entities.dlpmail.field.email_subject.type = STRING
entities.dlpmail.field.email_subject.rank = 11
entities.dlpmail.field.email_subject.lov = true
#entities.dlpmail.field.email_subject.attributes = internal
entities.dlpmail.field.email_subject.enabledByDefault=false


entities.dlpmail.field.has_alert_event.column=has_alert_event
entities.dlpmail.field.has_alert_event.score = has_alert_event_score
entities.dlpmail.field.has_alert_event.name =  Has Alert
entities.dlpmail.field.has_alert_event.type = STRING
entities.dlpmail.field.has_alert_event.rank = 350
entities.dlpmail.field.has_alert_event.lov = true
entities.dlpmail.field.has_alert_event.enabledByDefault=false

entities.dlpmail.field.has_src_classification.column=has_src_classification
entities.dlpmail.field.has_src_classification.name =  Has Src Classification
entities.dlpmail.field.has_src_classification.score = has_src_classification_score
entities.dlpmail.field.has_src_classification.type = STRING
entities.dlpmail.field.has_src_classification.rank = 370
entities.dlpmail.field.has_src_classification.lov = true
entities.dlpmail.field.has_src_classification.enabledByDefault=false

entities.dlpmail.field.is_outbound.column=is_outbound
entities.dlpmail.field.is_outbound.name =  Is Outbound
entities.dlpmail.field.is_outbound.score = outbound_score
entities.dlpmail.field.is_outbound.type = STRING
entities.dlpmail.field.is_outbound.rank = 380
entities.dlpmail.field.is_outbound.lov = true
entities.dlpmail.field.is_outbound.enabledByDefault=false



entities.dlpmail.field.network_address.column=network_address
entities.dlpmail.field.network_address.name =  Source IP
entities.dlpmail.field.network_address.type = STRING
entities.dlpmail.field.network_address.rank = 410
entities.dlpmail.field.network_address.lov = true
entities.dlpmail.field.network_address.enabledByDefault=false


entities.dlpmail.field.source_file.column=source_file
entities.dlpmail.field.source_file.name =  Source File
entities.dlpmail.field.source_file.type = STRING
entities.dlpmail.field.source_file.rank = 6
entities.dlpmail.field.source_file.lov = true
entities.dlpmail.field.source_file.enabledByDefault=false
entities.dlpmail.field.source_file.attributes = internal



entities.dlpmail.field.destination_file_type.column=destination_file_type
entities.dlpmail.field.destination_file_type.name =  Attachment File Type
entities.dlpmail.field.destination_file_type.type = STRING
entities.dlpmail.field.destination_file_type.rank = 550
entities.dlpmail.field.destination_file_type.lov = true

entities.dlpmail.field.source_file_type.column=source_file_type
entities.dlpmail.field.source_file_type.name =  Source File Type
entities.dlpmail.field.source_file_type.type = STRING
entities.dlpmail.field.source_file_type.rank = 560
entities.dlpmail.field.source_file_type.lov = true
entities.dlpmail.field.source_file_type.enabledByDefault=false
entities.dlpmail.field.source_file_type.attributes = internal



### score fields
entities.dlpmail.field.application_score.column=application_score
entities.dlpmail.field.application_score.name =  Application Score
entities.dlpmail.field.application_score.type = NUMBER
entities.dlpmail.field.application_score.score =
entities.dlpmail.field.application_score.valueList =
entities.dlpmail.field.application_score.rank = 100
entities.dlpmail.field.application_score.lov = true
entities.dlpmail.field.application_score.enabledByDefault = false


entities.dlpmail.field.email_recipient_domain_score.column=email_recipient_domain_score
entities.dlpmail.field.email_recipient_domain_score.name =  Email Recipient Domain Score
entities.dlpmail.field.email_recipient_domain_score.type = NUMBER
entities.dlpmail.field.email_recipient_domain_score.score =
entities.dlpmail.field.email_recipient_domain_score.valueList =
entities.dlpmail.field.email_recipient_domain_score.rank = 100
entities.dlpmail.field.email_recipient_domain_score.lov = true
entities.dlpmail.field.email_recipient_domain_score.enabledByDefault = false


entities.dlpmail.field.detail_file_size_score.column=detail_file_size_score
entities.dlpmail.field.detail_file_size_score.name =  Detail File Size Score
entities.dlpmail.field.detail_file_size_score.type = NUMBER
entities.dlpmail.field.detail_file_size_score.score =
entities.dlpmail.field.detail_file_size_score.valueList =
entities.dlpmail.field.detail_file_size_score.rank = 103
entities.dlpmail.field.detail_file_size_score.lov = true
entities.dlpmail.field.detail_file_size_score.enabledByDefault = false

entities.dlpmail.field.email_sender_score.column=email_sender_score
entities.dlpmail.field.email_sender_score.name =  Email Sender Score
entities.dlpmail.field.email_sender_score.type = NUMBER
entities.dlpmail.field.email_sender_score.score =
entities.dlpmail.field.email_sender_score.valueList =
entities.dlpmail.field.email_sender_score.rank = 104
entities.dlpmail.field.email_sender_score.lov = true
entities.dlpmail.field.email_sender_score.enabledByDefault = false

entities.dlpmail.field.has_alert_event_score.column=has_alert_event_score
entities.dlpmail.field.has_alert_event_score.name =  Has Alert Score
entities.dlpmail.field.has_alert_event_score.type = NUMBER
entities.dlpmail.field.has_alert_event_score.score =
entities.dlpmail.field.has_alert_event_score.valueList =
entities.dlpmail.field.has_alert_event_score.rank = 106
entities.dlpmail.field.has_alert_event_score.lov = true
entities.dlpmail.field.has_alert_event_score.enabledByDefault = false

entities.dlpmail.field.has_src_classification_score.column=has_src_classification_score
entities.dlpmail.field.has_src_classification_score.name =  Has Src Classification Score
entities.dlpmail.field.has_src_classification_score.type = NUMBER
entities.dlpmail.field.has_src_classification_score.score =
entities.dlpmail.field.has_src_classification_score.valueList =
entities.dlpmail.field.has_src_classification_score.rank = 107
entities.dlpmail.field.has_src_classification_score.lov = true
entities.dlpmail.field.has_src_classification_score.enabledByDefault = false

entities.dlpmail.field.outbound_score.column=outbound_score
entities.dlpmail.field.outbound_score.name =  Outbound Score
entities.dlpmail.field.outbound_score.type = NUMBER
entities.dlpmail.field.outbound_score.score =
entities.dlpmail.field.outbound_score.valueList =
entities.dlpmail.field.outbound_score.rank = 108
entities.dlpmail.field.outbound_score.lov = true
entities.dlpmail.field.outbound_score.enabledByDefault = false


####### Actual schema definition (logical to phisical mapping)
entities.dlpmail.field.type.column = "dlpmail"
entities.dlpmail.field.username.column = account_name
entities.dlpmail.field.normalized_username.column = normalized_username
entities.dlpmail.field.source_ip.column = network_address
entities.dlpmail.field.source_machine.column = computer_name
entities.dlpmail.field.normalized_src_machine.column = normalized_src_machine
entities.dlpmail.field.status.column =  'Success'
entities.dlpmail.field.event_time.column = date_time
entities.dlpmail.field.event_time.rank = 1
entities.dlpmail.field.event_time_utc.column = date_time_unix
entities.dlpmail.field.event_time_score.column = date_time_score
entities.dlpmail.field.event_score.column = eventscore
entities.dlpmail.field.is_user_administrator.column = if(1=1,'false','false')
entities.dlpmail.field.is_user_administrator.is_logical_only = true
entities.dlpmail.field.is_user_executive.column = if(1=1,'false','false')
entities.dlpmail.field.is_user_executive.is_logical_only = true
entities.dlpmail.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.dlpmail.field.is_sensitive_machine.column =  ${fortscale.tags.sensitive.machine}
entities.dlpmail.field.normalized_src_machine_score.column = normalized_src_machine_score
entities.dlpmail.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end
entities.dlpmail.field.lr.column=if(1=1,null,null)
entities.dlpmail.field.lr.is_logical_only = true

entities.dlpmail.field.normalized_src_machine.enabledByDefault = true


#### Hidden fiedls
entities.dlpmail.field.event_time_utc.attributes = internal
entities.dlpmail.field.source_machine.attributes = internal
entities.dlpmail.field.source_machine.enabledByDefault=false
entities.dlpmail.field.event_time_utc.enabledByDefault=false
entities.dlpmail.field.is_sensitive_machine.attributes = internal
entities.dlpmail.field.is_sensitive_machine.enabledByDefault=false
entities.dlpmail.field.status.attributes = internal
entities.dlpmail.field.status.enabledByDefault = false
entities.dlpmail.field.is_user_administrator.attributes = internal
entities.dlpmail.field.is_user_administrator.enabledByDefault = false
entities.dlpmail.field.is_user_executive.attributes = internal
entities.dlpmail.field.is_user_executive.enabledByDefault = false
entities.dlpmail.field.username.attributes=internal
entities.dlpmail.field.username.enabledByDefault = false


