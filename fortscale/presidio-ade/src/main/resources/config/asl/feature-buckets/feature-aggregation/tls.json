{
  "BucketConfs": [
    {
      "name": "srcIpHistogramJa3OutboundTlsHourly",
      "contextFieldNames": [
        "ja3"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "distinctSrcIpHistogram",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationJa3OutboundTlsHourly",
      "contextFieldNames": [
        "ja3"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationDstOrgOutboundTlsHourly",
      "contextFieldNames": [
        "dstOrg"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationDstOrgSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "dstOrg",
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationDstPortOutboundTlsHourly",
      "contextFieldNames": [
        "dstPort"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationDstPortSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "dstPort",
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationDomainOutboundTlsHourly",
      "contextFieldNames": [
        "domain.name"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationDomainSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "domain.name",
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentSummationSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentSummation",
          "featureNamesMap": {
            "sum": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_sum_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationDomainOutboundTlsHourly",
      "contextFieldNames": [
        "domain.name"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationDomainSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "domain.name",
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationDstOrgOutboundTlsHourly",
      "contextFieldNames": [
        "dstOrg"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationDstOrgSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "dstOrg",
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationDstPortOutboundTlsHourly",
      "contextFieldNames": [
        "dstPort"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    },
    {
      "name": "numOfBytesSentBySrcIpSummationDstPortSslSubjectOutboundTlsHourly",
      "contextFieldNames": [
        "dstPort",
        "sslSubject"
      ],
      "adeEventTypes": [
        "tls"
      ],
      "strategyName": "fixed_duration_hourly",
      "predicates": [
        {
          "type": "regex",
          "fieldName": "direction",
          "pattern": "OUTBOUND"
        }
      ],
      "aggrFeatureConfs": [
        {
          "name": "numOfBytesSentBySrcIpSummation",
          "featureNamesMap": {
            "groupBy": [
              "srcIp"
            ],
            "incrementBy": [
              "numOfBytesSent"
            ]
          },
          "aggrFeatureFuncJson": {
            "type": "aggr_feature_multi_key_histogram_func"
          }
        }
      ]
    }
  ]
}
