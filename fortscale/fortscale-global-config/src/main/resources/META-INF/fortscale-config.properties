######################################### Application flags ###########################################
analyst.first.admin.username=admin@fortscale.com
analyst.first.admin.password=admin
analyst.first.admin.firstname=admin
analyst.first.admin.lastname=fortscale

############# Tags #############
fortscale.tags.admin=is_user_administrator
fortscale.tags.executive=is_user_executive
fortscale.tags.service=is_user_service_account
fortscale.tags.LR=LR
fortscale.tags.sensitive.machine=is_sensitive_machine

######################################### Data Sources ###############################################
fortscale.data.source=ssh,vpn,kerberos_logins,kerberos_tgt,vpn_session,crmsf,wame,ntlm,gwame,prnlog,oracle,dlpmail,dlpfile

######################################### #################################################### HDFS #############################################################################################
hdfs.configuration.resources=${hdfs.configuration.resources}
hdfs.user.path=/user/${user.account.name}
hdfs.user.data.path=${hdfs.user.path}/data
hdfs.user.data.kerberos_logins.path=${hdfs.user.data.path}/wmi4769

hdfs.user.data.ssh.path=${hdfs.user.data.path}/ssh
hdfs.user.data.vpn.path=${hdfs.user.data.path}/vpn
hdfs.user.data.ldap.path=${hdfs.user.data.path}/ldap
hdfs.user.data.users.path=${hdfs.user.data.path}/users

hdfs.user.processeddata.path=${hdfs.user.path}/processeddata
hdfs.user.processeddata.kerberos_logins.path=${hdfs.user.processeddata.path}/authentication
hdfs.user.processeddata.kerberos_logins.top.path=${hdfs.user.processeddata.path}/authentication_top
hdfs.user.processeddata.ssh.path=${hdfs.user.processeddata.path}/sshscores
hdfs.user.processeddata.ssh.top.path=${hdfs.user.processeddata.path}/sshscores_top
hdfs.user.processeddata.vpn.path=${hdfs.user.processeddata.path}/vpn
hdfs.user.processeddata.vpn.top.path=${hdfs.user.processeddata.path}/vpn_top
hdfs.user.processeddata.vpn_session.path=${hdfs.user.processeddata.path}/vpnsession
hdfs.user.processeddata.vpn_session.top.path=${hdfs.user.processeddata.path}/vpnsession_top

hdfs.user.enricheddata.path=${hdfs.user.path}/enricheddata
hdfs.user.enricheddata.kerberos_logins.path=${hdfs.user.enricheddata.path}/security_events

hdfs.user.enricheddata.ssh.path=${hdfs.user.enricheddata.path}/ssh
hdfs.user.enricheddata.vpn.path=${hdfs.user.enricheddata.path}/vpn


############################### File names #############################################################



### Scores
hdfs.user.processeddata.kerberos_logins.file.name=${impala.score.kerberos_logins.table.name}.csv
hdfs.user.processeddata.ssh.file.name=${impala.score.ssh.table.name}.csv
hdfs.user.processeddata.vpn.file.name=${impala.score.vpn.table.name}.csv
hdfs.user.processeddata.vpn_session.file.name=${impala.score.vpn_session.table.name}.csv

### Enrich
hdfs.enricheddata.ssh.file.name=${impala.enricheddata.ssh.table.name}.csv
hdfs.enricheddata.vpn.file.name=${impala.enricheddata.vpn.table.name}.csv
hdfs.enricheddata.kerberos_logins.file.name=${impala.enricheddata.kerberos_logins.table.name}.csv

hdfs.user.rawdata.path=${hdfs.user.path}/rawdata
hdfs.user.data.kerberos_tgt.path=${hdfs.user.rawdata.path}/login

######################################### Retention ###################################################

hdfs.user.data.vpn.retention=365
hdfs.user.data.kerberos_tgt.retention=365
hdfs.user.data.security.events.4769.retention=365
hdfs.user.processeddata.security.events.4769.retention=365
hdfs.user.processeddata.security.top.events.4769.retention=365
hdfs.user.data.ssh.retention=365
hdfs.user.processeddata.ssh.retention=365
hdfs.user.processeddata.ssh.top.retention=365
hdfs.user.processeddata.group.membership.score.retention=365
hdfs.user.processeddata.security.login.retention=365
hdfs.user.processeddata.vpnscores.retention=365
hdfs.user.processeddata.vpnscores_top.retention=365
hdfs.user.processeddata.vpnscores.session.retention=365
hdfs.user.processeddata.vpnscores.session.top.retention=365
hdfs.user.enricheddata.security.events.retention=365
hdfs.user.enricheddata.ssh.retention=365
hdfs.user.enricheddata.vpn.retention=365
#50 hours (in seconds)
ip2hostname.retention=180000
ip2hostname.retention.enabled=false
#90 days (in seconds)
vpnsession.retention=7776000
vpnsession.retention.enabled=true
vpnsession.create.vpn.session.with.no.open.event=true


######################################### Streaming EVENTS ####################################################
streaming.event.datasource.field.name=data_source
streaming.event.field.type=event_type
streaming.event.field.type.aggr_event=aggr_event
streaming.event.field.type.entity_event=entity_event

streaming.aggr_event.field.bucket_conf_name=bucket_conf_name
streaming.aggr_event.field.aggregated_feature_name=aggregated_feature_name
streaming.aggr_event.field.aggregated_feature_value=aggregated_feature_value
streaming.aggr_event.field.context=context


streaming.entity_event.field.entity_event_type=entity_event_type



fortscale.streaming.scores.to.event.mapping.conf.json.file.path=classpath:scorers/scores_to_event_map.json
fortscale.streaming.scores.to.event.mapping.conf.json.overriding.file.path=file:${fortscale.home.dir}/config/streaming/scorers/scores_to_event_map*.json


######################################### DATABASE ####################################################
mongo.host.name=${mongo.host.name}
mongo.host.port=${mongo.host.port}
mongo.db.name=${mongo.db.name}
mongo.db.user=${mongo.db.user}
mongo.db.password=${mongo.db.password}
mongo.map.dot.replacement=#dot#
mongo.map.dollar.replacement=#dlr#

impala.host=${impala.host}
impala.port=${impala.port}
impala.url=${impala.url}



impala.table.fields.username=username
impala.table.fields.normalized.username=normalized_username
impala.table.fields.updateTimestamp=update_timestamp
impala.table.fields.normalized_src_machine=normalized_src_machine
impala.table.fields.source_ip=source_ip
impala.table.fields.epochtime=date_time_unix
impala.table.fields.data.source=data_source
impala.table.vpn.fields.status=status
impala.table.vpn.values.status.success=SUCCESS
impala.table.vpn.values.status.closed=CLOSED
impala.table.vpn.values.data.sources=vpn,vpn_session

impala.table.field.event.score=eventscore
impala.table.field.event.normalized_src_machine_score=normalized_src_machine_score
impala.table.field.event.normalized_dst_machine_score=normalized_dst_machine_score
impala.table.field.event.date_time_score=date_time_score
impala.table.field.global.score=globalScore


impala.data.table.fields.normalized_username=normalized_username
impala.data.table.fields.epochtime=date_time_unix



################################################################################# Kerberos TGT (login 4768 4771) ##################################################################################


##### Data Schema
impala.kerberos_tgt.have.data=true

impala.rawdata.security.events.login.table.field.timeGeneratedRaw=timeGeneratedRaw
impala.rawdata.security.events.login.table.field.date_time=date_time
impala.rawdata.security.events.login.table.field.date_time_unix=date_time_unix
impala.rawdata.security.events.login.table.field.account_name=account_name
impala.rawdata.security.events.login.table.field.account_domain=account_domain
impala.rawdata.security.events.login.table.field.security_id=security_id
impala.rawdata.security.events.login.table.field.eventCode=eventCode
impala.rawdata.security.events.login.table.field.client_address=client_address
impala.rawdata.security.events.login.table.field.status=status
impala.rawdata.security.events.login.table.field.failure_code=failure_code
impala.rawdata.security.events.login.table.field.authentication_type=authentication_type
impala.rawdata.security.events.login.table.field.ticket_options=ticket_options
impala.rawdata.security.events.login.table.field.forwardable=forwardable
impala.rawdata.security.events.login.table.field.forwarded=forwarded
impala.rawdata.security.events.login.table.field.proxied=proxied
impala.rawdata.security.events.login.table.field.postdated=postdated
impala.rawdata.security.events.login.table.field.renew_request=renew_request
impala.rawdata.security.events.login.table.field.constraint_delegation=constraint_delegation
impala.rawdata.security.events.login.table.field.is_nat=is_nat



impala.data.kerberos_tgt.table.fields=${impala.rawdata.security.events.login.table.field.timeGeneratedRaw} STRING,${impala.rawdata.security.events.login.table.field.date_time} TIMESTAMP,${impala.rawdata.security.events.login.table.field.date_time_unix} BIGINT,${impala.rawdata.security.events.login.table.field.account_name} STRING,${impala.rawdata.security.events.login.table.field.account_domain} STRING,${impala.rawdata.security.events.login.table.field.security_id} STRING,${impala.rawdata.security.events.login.table.field.eventCode} STRING,${impala.rawdata.security.events.login.table.field.client_address} STRING,${impala.rawdata.security.events.login.table.field.status} STRING,${impala.rawdata.security.events.login.table.field.failure_code} STRING,${impala.rawdata.security.events.login.table.field.authentication_type} STRING,${impala.rawdata.security.events.login.table.field.ticket_options} STRING,${impala.rawdata.security.events.login.table.field.forwardable} BOOLEAN,${impala.rawdata.security.events.login.table.field.forwarded} BOOLEAN,${impala.rawdata.security.events.login.table.field.proxied} BOOLEAN,${impala.rawdata.security.events.login.table.field.postdated} BOOLEAN,${impala.rawdata.security.events.login.table.field.renew_request} BOOLEAN,${impala.rawdata.security.events.login.table.field.constraint_delegation} BOOLEAN,${impala.rawdata.security.events.login.table.field.is_nat} BOOLEAN,${fortscale.tags.LR} BOOLEAN,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN
impala.data.kerberos_tgt.table.delimiter=|
impala.data.kerberos_tgt.table.name=loginrawdata
impala.data.kerberos_tgt.table.partition.type=monthly
kafka.security.events.login.message.record.field.data_source=data_source
kafka.security.events.login.message.record.field.last_state=last_state
kafka.security.events.login.message.record.fields=${impala.data.kerberos_tgt.table.fields},${kafka.security.events.login.message.record.field.data_source},${kafka.security.events.login.message.record.field.last_state}


##################

##### Enriched Schema
impala.kerberos_tgt.have.enrich=true

impala.data.security.events.login.table.field.timeGeneratedRaw=timeGeneratedRaw
impala.data.security.events.login.table.field.date_time=date_time
impala.data.security.events.login.table.field.date_time_unix=${impala.data.table.fields.epochtime}
impala.data.security.events.login.table.field.account_name=account_name
impala.data.security.events.login.table.field.account_domain=account_domain
impala.data.security.events.login.table.field.security_id=security_id
impala.data.security.events.login.table.field.eventCode=eventCode
impala.data.security.events.login.table.field.normalized_username=${impala.data.table.fields.normalized_username}
impala.data.security.events.login.table.field.client_address=client_address
impala.data.security.events.login.table.field.machine_name=machine_name
impala.data.security.events.login.table.field.src_class=src_class
impala.data.security.events.login.table.field.service_name=service_name
impala.data.security.events.login.table.field.dst_class=dst_class
impala.data.security.events.login.table.field.status=status
impala.data.security.events.login.table.field.failure_code=failure_code
impala.data.security.events.login.table.field.authentication_type=authentication_type
impala.data.security.events.login.table.field.ticket_options=ticket_options
impala.data.security.events.login.table.field.forwardable=forwardable
impala.data.security.events.login.table.field.forwarded=forwarded
impala.data.security.events.login.table.field.proxied=proxied
impala.data.security.events.login.table.field.postdated=postdated
impala.data.security.events.login.table.field.renew_request=renew_request
impala.data.security.events.login.table.field.constraint_delegation=constraint_delegation
impala.data.security.events.login.table.field.is_nat=is_nat
impala.data.security.events.login.table.field.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.data.security.events.login.table.field.normalized_dst_machine=normalized_dst_machine
impala.data.security.events.login.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.security.events.login.table.morphline.fields=${impala.data.security.events.login.table.field.timeGeneratedRaw} STRING,${impala.data.security.events.login.table.field.date_time} TIMESTAMP,${impala.data.security.events.login.table.field.date_time_unix} BIGINT,${impala.data.security.events.login.table.field.account_name} STRING,${impala.data.security.events.login.table.field.account_domain} STRING,${impala.data.security.events.login.table.field.security_id} STRING,${impala.data.security.events.login.table.field.eventCode} STRING,${impala.data.security.events.login.table.field.client_address} STRING,${impala.data.security.events.login.table.field.machine_name} STRING,${impala.data.security.events.login.table.field.service_name} STRING,${impala.data.security.events.login.table.field.status} STRING,${impala.data.security.events.login.table.field.failure_code} STRING,${impala.data.security.events.login.table.field.authentication_type} STRING,${impala.data.security.events.login.table.field.ticket_options} STRING,${impala.data.security.events.login.table.field.forwardable} BOOLEAN,${impala.data.security.events.login.table.field.forwarded} BOOLEAN,${impala.data.security.events.login.table.field.proxied} BOOLEAN,${impala.data.security.events.login.table.field.postdated} BOOLEAN,${impala.data.security.events.login.table.field.renew_request} BOOLEAN,${impala.data.security.events.login.table.field.constraint_delegation} BOOLEAN,${impala.data.security.events.login.table.field.is_nat} BOOLEAN,${impala.data.security.events.login.table.field.src_class} STRING,${impala.data.security.events.login.table.field.normalized_src_machine} STRING,${impala.data.security.events.login.table.field.is_sensitive_machine} BOOLEAN,${fortscale.tags.LR} BOOLEAN,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN

impala.enricheddata.kerberos_tgt.table.fields=${impala.data.security.events.login.table.morphline.fields},${impala.data.table.fields.normalized_username} STRING
impala.enricheddata.kerberos_tgt.table.delimiter=|
impala.enricheddata.kerberos_tgt.table.name=logindata
impala.enricheddata.kerberos_tgt.table.partition.type=daily

hdfs.enricheddata.kerberos_tgt.file.name=${impala.enricheddata.kerberos_tgt.table.name}.csv
hdfs.user.enricheddata.kerberos_tgt.path=${hdfs.user.enricheddata.path}/kerberos_tgt
hdfs.user.enricheddata.kerberos_tgt.retention=365

##################

##### Score Schema
impala.kerberos_tgt.have.topScore=true


impala.score.kerberos_tgt.table.name=kerberostgtscore
impala.score.kerberos_tgt.table.delimiter=|
impala.score.kerberos_tgt.table.fields=${impala.enricheddata.kerberos_tgt.table.fields},date_time_score DOUBLE,failure_code_score DOUBLE,normalized_src_machine_score DOUBLE,eventscore DOUBLE
impala.score.kerberos_tgt.table.partition.type=daily
hdfs.user.processeddata.kerberos_tgt.path = ${hdfs.user.processeddata.path}/kerberos_tgt
hdfs.processeddata.kerberos_tgt.file.name = ${impala.score.kerberos_tgt.table.name}.csv

##### Top Score Schema
impala.score.kerberos_tgt.top.table.name=kerberostgtscore_top
impala.score.kerberos_tgt.top.table.delimiter=|
impala.score.kerberos_tgt.top.table.fields=${impala.score.kerberos_tgt.table.fields}
impala.score.kerberos_tgt.top.table.partition.type=daily
hdfs.user.processeddata.kerberos_tgt.top.path = ${hdfs.user.processeddata.path}/kerberos_tgt_top
hdfs.processeddata.kerberos_tgt.top.file.name = ${impala.score.kerberos_tgt.top.table.name}.csv

##################


###################################################################################################################################################################################

####################################################################################  4769 ########################################################################################

##### Data Schema
impala.kerberos_logins.have.data=true

#################

impala.data.security.events.4769.table.morphline.fields.username=account_name
impala.data.security.events.4769.table.field.timeGeneratedRaw=timeGeneratedRaw
impala.data.security.events.4769.table.field.date_time=date_time
impala.data.security.events.4769.table.field.categoryString=categoryString
impala.data.security.events.4769.table.field.eventCode=eventCode
impala.data.security.events.4769.table.field.logfile=logfile
impala.data.security.events.4769.table.field.recordNumber=recordNumber
impala.data.security.events.4769.table.field.sourceName=sourceName
impala.data.security.events.4769.table.field.src_class=src_class
impala.data.security.events.4769.table.field.username=${impala.data.security.events.4769.table.morphline.fields.username}
impala.data.security.events.4769.table.field.account_domain=account_domain
impala.data.security.events.4769.table.field.service_name=service_name
impala.data.security.events.4769.table.field.dst_class=dst_class
impala.data.security.events.4769.table.field.service_id=service_id
impala.data.security.events.4769.table.field.client_address=client_address
impala.data.security.events.4769.table.field.ticket_options=ticket_options
impala.data.security.events.4769.table.field.failure_code=failure_code
impala.data.security.events.4769.table.field.source_network_address=source_network_address
impala.data.security.events.4769.table.field.date_time_unix=${impala.data.table.fields.epochtime}
impala.data.security.events.4769.table.field.machine_name=machine_name
impala.data.security.events.4769.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.security.events.4769.table.field.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.data.security.events.4769.table.field.normalized_dst_machine=normalized_dst_machine
impala.data.security.events.4769.table.field.is_nat=is_nat
impala.data.security.events.4769.table.field.normalized_username=${impala.data.table.fields.normalized_username}
impala.data.security.events.4769.table.field.is_user_service_account=${fortscale.tags.service}
impala.data.security.events.4769.table.field.is_user_administrator=${fortscale.tags.admin}
impala.data.security.events.4769.table.field.is_user_executive=${fortscale.tags.executive}

impala.data.kerberos_logins.table.morphline.fields=${impala.data.security.events.4769.table.field.timeGeneratedRaw} STRING,${impala.data.security.events.4769.table.field.date_time} TIMESTAMP,${impala.data.security.events.4769.table.field.categoryString} STRING,${impala.data.security.events.4769.table.field.eventCode} STRING,${impala.data.security.events.4769.table.field.logfile} STRING,${impala.data.security.events.4769.table.field.recordNumber} STRING,${impala.data.security.events.4769.table.field.sourceName} STRING,${impala.data.security.events.4769.table.morphline.fields.username} STRING,${impala.data.security.events.4769.table.field.account_domain} STRING,${impala.data.security.events.4769.table.field.service_name} STRING,${impala.data.security.events.4769.table.field.service_id} STRING,${impala.data.security.events.4769.table.field.client_address} STRING,${impala.data.security.events.4769.table.field.ticket_options} STRING,${impala.data.security.events.4769.table.field.failure_code} STRING,${impala.data.security.events.4769.table.field.source_network_address} STRING,${impala.data.security.events.4769.table.field.date_time_unix} BIGINT,${impala.data.security.events.4769.table.field.machine_name} STRING,${impala.data.security.events.4769.table.field.is_nat} BOOLEAN,${impala.data.security.events.4769.table.field.dst_class} STRING,${impala.data.security.events.4769.table.field.src_class} STRING,${impala.data.security.events.4769.table.field.normalized_src_machine} STRING,${impala.data.security.events.4769.table.field.normalized_dst_machine} STRING,${impala.data.security.events.4769.table.field.is_user_service_account} BOOLEAN,${impala.data.security.events.4769.table.field.is_user_administrator} BOOLEAN,${impala.data.security.events.4769.table.field.is_user_executive} BOOLEAN,${impala.data.security.events.4769.table.field.is_sensitive_machine} BOOLEAN,${fortscale.tags.LR} BOOLEAN
impala.data.kerberos_logins.table.fields=${impala.data.kerberos_logins.table.morphline.fields},${impala.data.table.fields.normalized_username} STRING
impala.data.kerberos_logins.table.delimiter=|
impala.data.kerberos_logins.table.name=wmiEvents4769
impala.data.kerberos_logins.table.partition.type=monthly
kafka.kerberos_logins.message.record.field.data_source=data_source
kafka.kerberos_logins.message.record.field.last_state=last_state
kafka.kerberos_logins.message.record.fields = ${impala.data.kerberos_logins.table.fields},${kafka.kerberos_logins.message.record.field.data_source},${kafka.kerberos_logins.message.record.field.last_state}



##################

##### Enriched Schema
impala.kerberos_logins.have.enrich=true

impala.enricheddata.security.events.table.field.date_time=date_time
impala.enricheddata.security.events.table.field.record_number=recordNumber
impala.enricheddata.security.events.table.field.username=account_name
impala.enricheddata.security.events.table.field.account_domain=account_domain
impala.enricheddata.security.events.table.field.service_name=service_name
impala.enricheddata.security.events.table.field.service_id=service_id
impala.enricheddata.security.events.table.field.client_address=client_address
impala.enricheddata.security.events.table.field.failure_code=failure_code
impala.enricheddata.security.events.table.field.date_time_unix=date_time_unix
impala.enricheddata.security.events.table.field.machine_name=machine_name
impala.enricheddata.security.events.table.field.is_nat=is_nat
impala.enricheddata.security.events.table.field.dst_class=dst_class
impala.enricheddata.security.events.table.field.src_class=src_class
impala.enricheddata.security.events.table.field.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.enricheddata.security.events.table.field.normalized_dst_machine=normalized_dst_machine
impala.enricheddata.security.events.table.field.is_user_service_account=${fortscale.tags.service}
impala.enricheddata.security.events.table.field.is_user_administrator=${fortscale.tags.admin}
impala.enricheddata.security.events.table.field.is_user_executive=${fortscale.tags.executive}
impala.enricheddata.security.events.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.enricheddata.security.events.table.field.normalized_username=normalized_username
impala.enricheddata.security.events.table.field.LR=LR

impala.enricheddata.kerberos_logins.table.name=4769enriched
impala.enricheddata.kerberos_logins.table.delimiter=|
impala.enricheddata.kerberos_logins.table.fields=${impala.enricheddata.security.events.table.field.date_time} TIMESTAMP,${impala.enricheddata.security.events.table.field.record_number} STRING,${impala.enricheddata.security.events.table.field.username} STRING,${impala.enricheddata.security.events.table.field.account_domain} STRING,${impala.enricheddata.security.events.table.field.service_name} STRING,${impala.enricheddata.security.events.table.field.service_id} STRING,${impala.enricheddata.security.events.table.field.client_address} STRING,${impala.enricheddata.security.events.table.field.failure_code} STRING,${impala.enricheddata.security.events.table.field.date_time_unix} BIGINT,${impala.enricheddata.security.events.table.field.machine_name} STRING,${impala.enricheddata.security.events.table.field.is_nat} BOOLEAN,${impala.enricheddata.security.events.table.field.dst_class} STRING,${impala.enricheddata.security.events.table.field.src_class} STRING,${impala.enricheddata.security.events.table.field.normalized_src_machine} STRING,${impala.enricheddata.security.events.table.field.normalized_dst_machine} STRING,${impala.enricheddata.security.events.table.field.is_user_service_account} BOOLEAN,${impala.enricheddata.security.events.table.field.is_user_administrator} BOOLEAN,${impala.enricheddata.security.events.table.field.is_user_executive} BOOLEAN,${impala.enricheddata.security.events.table.field.is_sensitive_machine} BOOLEAN,${impala.enricheddata.security.events.table.field.normalized_username} STRING,${impala.enricheddata.security.events.table.field.LR} BOOLEAN
impala.enricheddata.kerberos_logins.table.partition.type=daily



##################

##### Score Schema
impala.kerberos_logins.have.topScore=true

impala.score.ldapauth.table.fields.timeGenerated=date_time
impala.score.ldapauth.table.fields.date_time_unix=date_time_unix
impala.score.ldapauth.table.fields.date_timeScore=${impala.table.field.event.date_time_score}
impala.score.ldapauth.table.fields.account_name=account_name
impala.score.ldapauth.table.fields.account_domain=account_domain
impala.score.ldapauth.table.fields.normalized_username=normalized_username
impala.score.ldapauth.table.fields.is_user_administrator=${fortscale.tags.admin}
impala.score.ldapauth.table.fields.is_user_executive=${fortscale.tags.executive}
impala.score.ldapauth.table.fields.is_user_service_account=${fortscale.tags.service}
impala.score.ldapauth.table.fields.failure_code=failure_code
impala.score.ldapauth.table.fields.failure_codeScore=failure_codescore
impala.score.ldapauth.table.fields.client_address=client_address
impala.score.ldapauth.table.fields.is_nat=is_nat
impala.score.ldapauth.table.fields.machine_name=machine_name
impala.score.ldapauth.table.fields.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.score.ldapauth.table.fields.hostnameScore=${impala.table.field.event.normalized_src_machine_score}
impala.score.ldapauth.table.fields.src_class=src_class
impala.score.ldapauth.table.fields.service_name=service_name
impala.score.ldapauth.table.fields.normalized_dst_machine=normalized_dst_machine
impala.score.ldapauth.table.fields.destScore=${impala.table.field.event.normalized_dst_machine_score}
impala.score.ldapauth.table.fields.dst_class=dst_class
impala.score.ldapauth.table.fields.service_id=service_id
impala.score.ldapauth.table.fields.eventscore=${impala.table.field.event.score}
impala.score.ldapauth.table.fields.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.score.ldapauth.table.fields.LR=LR

impala.score.kerberos_logins.table.name=authenticationscores
impala.score.kerberos_logins.table.delimiter=,
impala.score.kerberos_logins.table.fields=${impala.score.ldapauth.table.fields.timeGenerated} TIMESTAMP,${impala.score.ldapauth.table.fields.date_time_unix} BIGINT,${impala.score.ldapauth.table.fields.date_timeScore} DOUBLE,${impala.score.ldapauth.table.fields.account_name} STRING,${impala.score.ldapauth.table.fields.account_domain} STRING,${impala.score.ldapauth.table.fields.normalized_username} STRING,${impala.score.ldapauth.table.fields.is_user_administrator} BOOLEAN,${impala.score.ldapauth.table.fields.is_user_service_account} BOOLEAN,${impala.score.ldapauth.table.fields.is_user_executive} BOOLEAN,${impala.score.ldapauth.table.fields.is_sensitive_machine} BOOLEAN,${impala.score.ldapauth.table.fields.failure_code} STRING,${impala.score.ldapauth.table.fields.failure_codeScore} DOUBLE,${impala.score.ldapauth.table.fields.client_address} STRING,${impala.score.ldapauth.table.fields.is_nat} BOOLEAN,${impala.score.ldapauth.table.fields.machine_name} STRING,${impala.score.ldapauth.table.fields.normalized_src_machine} STRING,${impala.score.ldapauth.table.fields.hostnameScore} DOUBLE,${impala.score.ldapauth.table.fields.src_class} STRING,${impala.score.ldapauth.table.fields.service_name} STRING,${impala.score.ldapauth.table.fields.normalized_dst_machine} STRING,${impala.score.ldapauth.table.fields.destScore} DOUBLE,${impala.score.ldapauth.table.fields.dst_class} STRING,${impala.score.ldapauth.table.fields.service_id} STRING,${impala.score.ldapauth.table.fields.LR} BOOLEAN,${impala.score.ldapauth.table.fields.eventscore} DOUBLE
impala.score.kerberos_logins.table.partition.type=daily

impala.score.kerberos_logins.top.table.name=authenticationscores_top
impala.score.kerberos_logins.top.table.delimiter=,
impala.score.kerberos_logins.top.table.fields=${impala.score.kerberos_logins.table.fields}
impala.score.kerberos_logins.top.table.partition.type=daily

##################

###################################################################################################################################################################################

####################################################################################  VPN  ########################################################################################


##### Data Schema
impala.vpn.have.data=true


impala.data.vpn.table.fiels.date_time=date_time
impala.data.vpn.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.data.vpn.table.field.username=${impala.table.fields.username}
impala.data.vpn.table.field.source_ip=source_ip
impala.data.vpn.table.field.local_ip=local_ip
impala.data.vpn.table.field.status=status
impala.data.vpn.table.field.country=country
impala.data.vpn.table.field.countrycode=countrycode
impala.data.vpn.table.field.region=region
impala.data.vpn.table.field.city=city
impala.data.vpn.table.field.isp=isp
impala.data.vpn.table.field.ipusage=ipusage
impala.data.vpn.table.field.hostname=hostname
impala.data.vpn.table.field.totalbytes=totalbytes
impala.data.vpn.table.field.readbytes=readbytes
impala.data.vpn.table.field.writebytes=writebytes
impala.data.vpn.table.field.duration=duration
impala.data.vpn.table.field.databucket=databucket
impala.data.vpn.table.field.data_source=data_source
impala.data.vpn.table.field.normalized_username=${impala.data.table.fields.normalized_username}
impala.data.vpn.table.field.is_user_administrator=${fortscale.tags.admin}
impala.data.vpn.table.field.is_user_executive=${fortscale.tags.executive}
impala.data.vpn.table.morphline.fields=${impala.data.vpn.table.fiels.date_time} TIMESTAMP,${impala.data.vpn.table.field.epochtime} BIGINT,${impala.data.vpn.table.field.username} STRING,${impala.data.vpn.table.field.source_ip} STRING,${impala.data.vpn.table.field.local_ip} STRING,${impala.data.vpn.table.field.status} STRING,${impala.data.vpn.table.field.country} STRING,${impala.data.vpn.table.field.countrycode} STRING,${impala.data.vpn.table.field.region} STRING,${impala.data.vpn.table.field.city} STRING,${impala.data.vpn.table.field.isp} STRING,${impala.data.vpn.table.field.ipusage} STRING,${impala.data.vpn.table.field.hostname} STRING,${impala.data.vpn.table.field.totalbytes} BIGINT,${impala.data.vpn.table.field.readbytes} BIGINT,${impala.data.vpn.table.field.writebytes} BIGINT,${impala.data.vpn.table.field.duration} INT,${impala.data.vpn.table.field.databucket} INT,${impala.data.vpn.table.field.is_user_administrator} BOOLEAN,${impala.data.vpn.table.field.is_user_executive} BOOLEAN,${fortscale.tags.LR} BOOLEAN
impala.data.vpn.table.fields=${impala.data.vpn.table.morphline.fields},${impala.data.table.fields.normalized_username} STRING
impala.data.vpn.table.delimiter=|
impala.data.vpn.table.name=vpndata
impala.data.vpn.table.partition.type=monthly
impala.data.vpn.table.filesplit.type=daily
kafka.vpn.message.record.field.data_source=data_source
kafka.vpn.message.record.field.last_state=last_state
kafka.vpn.message.record.fields = ${impala.data.vpn.table.fields},${kafka.vpn.message.record.field.data_source},${kafka.vpn.message.record.field.last_state}

#####################

##### Enriched Schema
impala.vpn.have.enrich=true


impala.enricheddata.vpn.table.field.date_time=date_time
impala.enricheddata.vpn.table.field.date_time_unix=date_time_unix
impala.enricheddata.vpn.table.field.username=username
impala.enricheddata.vpn.table.field.source_ip=source_ip
impala.enricheddata.vpn.table.field.local_ip=local_ip
impala.enricheddata.vpn.table.field.status=status
impala.enricheddata.vpn.table.field.country=country
impala.enricheddata.vpn.table.field.country_code=countrycode
impala.enricheddata.vpn.table.field.region=region
impala.enricheddata.vpn.table.field.city=city
impala.enricheddata.vpn.table.field.isp=isp
impala.enricheddata.vpn.table.field.ip_usage=ipusage
impala.enricheddata.vpn.table.field.hostname=hostname
impala.enricheddata.vpn.table.field.totalbytes=totalbytes
impala.enricheddata.vpn.table.field.readbytes=readbytes
impala.enricheddata.vpn.table.field.writebytes=writebytes
impala.enricheddata.vpn.table.field.duration=duration
impala.enricheddata.vpn.table.field.databucket=databucket
impala.enricheddata.vpn.table.field.is_user_administrator=${fortscale.tags.admin}
impala.enricheddata.vpn.table.field.is_user_executive=${fortscale.tags.executive}
impala.enricheddata.vpn.table.field.normalized_username=normalized_username
impala.enricheddata.vpn.table.field.LR=LR

impala.enricheddata.vpn.table.name=vpnenriched
impala.enricheddata.vpn.table.delimiter=|
impala.enricheddata.vpn.table.fields=${impala.enricheddata.vpn.table.field.date_time} TIMESTAMP,${impala.enricheddata.vpn.table.field.date_time_unix} BIGINT,${impala.enricheddata.vpn.table.field.username} STRING,${impala.enricheddata.vpn.table.field.source_ip} STRING,${impala.enricheddata.vpn.table.field.local_ip} STRING,${impala.enricheddata.vpn.table.field.status} STRING,${impala.enricheddata.vpn.table.field.country} STRING,${impala.enricheddata.vpn.table.field.country_code} STRING,${impala.enricheddata.vpn.table.field.region} STRING,${impala.enricheddata.vpn.table.field.city} STRING,${impala.enricheddata.vpn.table.field.isp} STRING,${impala.enricheddata.vpn.table.field.ip_usage} STRING,${impala.enricheddata.vpn.table.field.hostname} STRING,${impala.enricheddata.vpn.table.field.totalbytes} BIGINT,${impala.enricheddata.vpn.table.field.readbytes} BIGINT,${impala.enricheddata.vpn.table.field.writebytes} BIGINT,${impala.enricheddata.vpn.table.field.duration} INT,${impala.enricheddata.vpn.table.field.databucket} INT,${impala.enricheddata.vpn.table.field.is_user_administrator} BOOLEAN,${impala.enricheddata.vpn.table.field.is_user_executive} BOOLEAN,${impala.enricheddata.vpn.table.field.normalized_username} STRING,${impala.enricheddata.vpn.table.field.LR} BOOLEAN
impala.enricheddata.vpn.table.partition.type=daily





#####################

##### Score Schema
impala.vpn.have.topScore=true

impala.score.vpn.table.name=vpndatares
impala.score.vpn.table.field.date_time=date_time
impala.score.vpn.table.field.date_time_unix=date_time_unix
impala.score.vpn.table.field.date_timeScore=${impala.table.field.event.date_time_score}
impala.score.vpn.table.field.username=${impala.table.fields.username}
impala.score.vpn.table.field.normalized_username=${impala.data.table.fields.normalized_username}
impala.score.vpn.table.field.status=status
impala.score.vpn.table.field.source_ip=source_ip
impala.score.vpn.table.field.hostname=hostname
impala.score.vpn.table.field.hostname.score=${impala.table.field.event.normalized_src_machine_score}
impala.score.vpn.table.field.local_ip=local_ip
impala.score.vpn.table.field.country=country
impala.score.vpn.table.field.country.score=countryscore
impala.score.vpn.table.field.countrycode=countrycode
impala.score.vpn.table.field.region=region
impala.score.vpn.table.field.city=city
impala.score.vpn.table.field.isp=isp
impala.score.vpn.table.field.ipusage=ipusage
impala.score.vpn.table.field.is_user_administrator=${fortscale.tags.admin}
impala.score.vpn.table.field.is_user_executive=${fortscale.tags.executive}
impala.score.vpn.table.fields.LR=LR
impala.score.vpn.table.field.event.score=${impala.table.field.event.score}
impala.score.vpn.table.fields=${impala.score.vpn.table.field.date_time} TIMESTAMP,${impala.score.vpn.table.field.date_time_unix} BIGINT,${impala.score.vpn.table.field.date_timeScore} DOUBLE,${impala.score.vpn.table.field.username} STRING,${impala.data.table.fields.normalized_username} STRING,${impala.score.vpn.table.field.is_user_administrator} BOOLEAN,${impala.score.vpn.table.field.is_user_executive} BOOLEAN,${impala.score.vpn.table.field.status} STRING,${impala.score.vpn.table.field.source_ip} STRING,${impala.score.vpn.table.field.hostname} STRING,${impala.score.vpn.table.field.hostname.score} DOUBLE,${impala.score.vpn.table.field.local_ip} STRING,${impala.score.vpn.table.field.country} STRING,${impala.score.vpn.table.field.country.score} DOUBLE,${impala.score.vpn.table.field.countrycode} STRING,${impala.score.vpn.table.field.region} STRING,${impala.score.vpn.table.field.city} STRING,${impala.score.vpn.table.field.isp} STRING,${impala.score.vpn.table.field.ipusage} STRING,${impala.score.vpn.table.fields.LR} BOOLEAN,${impala.table.field.event.score} DOUBLE
impala.score.vpn.table.delimiter=,
impala.score.vpn.table.partition.type=daily

impala.score.vpn.top.table.name=vpndatares_top
impala.score.vpn.top.table.fields=${impala.score.vpn.table.fields}
impala.score.vpn.top.table.delimiter=,
impala.score.vpn.top.table.partition.type=daily

##################


####################################################################################  SSH  ########################################################################################

##### Data Schema
impala.ssh.have.data=true

impala.data.ssh.table.field.date_time=date_time
impala.data.ssh.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.data.ssh.table.field.source_ip=source_ip
impala.data.ssh.table.field.is_nat=is_nat
impala.data.ssh.table.field.target_machine=target_machine
target_machine_temp=target_machine_temp
impala.data.ssh.table.field.username=${impala.table.fields.username}
impala.data.ssh.table.field.status=status
impala.data.ssh.table.field.auth_method=auth_method
impala.data.ssh.table.field.hostname=hostname
impala.data.ssh.table.field.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.data.ssh.table.field.normalized_dst_machine=normalized_dst_machine
impala.data.ssh.table.field.normalized_username=${impala.data.table.fields.normalized_username}
impala.data.ssh.table.field.is_user_administrator=${fortscale.tags.admin}
impala.data.ssh.table.field.is_user_executive=${fortscale.tags.executive}
impala.data.ssh.table.field.is_user_service_account=${fortscale.tags.service}
impala.data.ssh.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.ssh.table.field.data_source=data_source
impala.data.ssh.table.morphline.fields=${impala.data.ssh.table.field.date_time} TIMESTAMP,${impala.data.ssh.table.field.epochtime} BIGINT,${impala.data.ssh.table.field.source_ip} STRING,${impala.data.ssh.table.field.target_machine} STRING,${impala.data.ssh.table.field.username} STRING,${impala.data.ssh.table.field.status} STRING,${impala.data.ssh.table.field.auth_method} STRING,${impala.data.ssh.table.field.hostname} STRING,${impala.data.ssh.table.field.normalized_src_machine} STRING,${impala.data.ssh.table.field.normalized_dst_machine} STRING,${impala.data.ssh.table.field.is_nat} BOOLEAN,${impala.data.ssh.table.field.is_sensitive_machine} BOOLEAN,${impala.data.ssh.table.field.is_user_administrator} BOOLEAN,${impala.data.ssh.table.field.is_user_executive} BOOLEAN,${impala.data.ssh.table.field.is_user_service_account} BOOLEAN,${fortscale.tags.LR} BOOLEAN
impala.data.ssh.table.fields=${impala.data.ssh.table.morphline.fields},${impala.data.table.fields.normalized_username} STRING
impala.data.ssh.table.delimiter=,
impala.data.ssh.table.name=sshdata
impala.data.ssh.table.partition.type=monthly
kafka.ssh.message.record.field.data_source=data_source
kafka.ssh.message.record.field.last_state=last_state
kafka.ssh.message.record.fields = ${impala.data.ssh.table.fields},${kafka.ssh.message.record.field.data_source},${kafka.ssh.message.record.field.last_state}

#####################

##### Enriched Schema
impala.ssh.have.enrich=true


impala.enricheddata.ssh.table.field.date_time=date_time
impala.enricheddata.ssh.table.field.date_time_unix=date_time_unix
impala.enricheddata.ssh.table.field.source_ip=source_ip
impala.enricheddata.ssh.table.field.target_machine=target_machine
impala.enricheddata.ssh.table.field.username=username
impala.enricheddata.ssh.table.field.status=status
impala.enricheddata.ssh.table.field.auth_method=auth_method
impala.enricheddata.ssh.table.field.hostname=hostname
impala.enricheddata.ssh.table.field.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.enricheddata.ssh.table.field.normalized_dst_machine=normalized_dst_machine
impala.enricheddata.ssh.table.field.is_nat=is_nat
impala.enricheddata.ssh.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.enricheddata.ssh.table.field.is_user_administrator=${fortscale.tags.admin}
impala.enricheddata.ssh.table.field.is_user_executive=${fortscale.tags.executive}
impala.enricheddata.ssh.table.field.is_user_service_account=${fortscale.tags.service}
impala.enricheddata.ssh.table.field.normalized_username=normalized_username
impala.enricheddata.ssh.table.field.LR=LR

impala.enricheddata.ssh.table.name=sshenriched
impala.enricheddata.ssh.table.delimiter=,
impala.enricheddata.ssh.table.fields=${impala.enricheddata.ssh.table.field.date_time} TIMESTAMP,${impala.enricheddata.ssh.table.field.date_time_unix} BIGINT,${impala.enricheddata.ssh.table.field.source_ip} STRING,${impala.enricheddata.ssh.table.field.target_machine} STRING,${impala.enricheddata.ssh.table.field.username} STRING,${impala.enricheddata.ssh.table.field.status} STRING,${impala.enricheddata.ssh.table.field.auth_method} STRING,${impala.enricheddata.ssh.table.field.hostname} STRING,${impala.enricheddata.ssh.table.field.normalized_src_machine} STRING,${impala.enricheddata.ssh.table.field.normalized_dst_machine} STRING,${impala.enricheddata.ssh.table.field.is_nat} BOOLEAN,${impala.enricheddata.ssh.table.field.is_sensitive_machine} BOOLEAN,${impala.enricheddata.ssh.table.field.is_user_administrator} BOOLEAN,${impala.enricheddata.ssh.table.field.is_user_executive} BOOLEAN,${impala.enricheddata.ssh.table.field.is_user_service_account} BOOLEAN,${impala.enricheddata.ssh.table.field.normalized_username} STRING,${impala.enricheddata.ssh.table.field.LR} BOOLEAN
impala.enricheddata.ssh.table.partition.type=daily


#####################

##### Score Schema
impala.ssh.have.topScore=true

impala.score.ssh.table.name=sshscores
impala.score.ssh.table.fields.date_time=date_time
impala.score.ssh.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.ssh.table.fields.date_time_score=${impala.table.field.event.date_time_score}
impala.score.ssh.table.field.username=${impala.table.fields.username}
impala.score.ssh.table.fields.normalized_username=${impala.data.table.fields.normalized_username}
impala.score.ssh.table.fields.is_user_administrator=${fortscale.tags.admin}
impala.score.ssh.table.fields.is_user_executive=${fortscale.tags.executive}
impala.score.ssh.table.fields.is_user_service_account=${fortscale.tags.service}
impala.score.ssh.table.fields.status=status
impala.score.ssh.table.fields.auth_method=auth_method
impala.score.ssh.table.fields.auth_method_score=auth_method_score
impala.score.ssh.table.fields.source_ip=source_ip
impala.score.ssh.table.field.is_nat=is_nat
impala.score.ssh.table.field.hostname=hostname
impala.score.ssh.table.field.src_class=src_class
impala.score.ssh.table.field.dst_class=dst_class
impala.score.ssh.table.field.normalized_src_machine=${impala.table.fields.normalized_src_machine}
impala.score.ssh.table.field.normalized_src_machine_score=${impala.table.field.event.normalized_src_machine_score}
impala.score.ssh.table.field.target_machine=target_machine
impala.score.ssh.table.field.normalized_dst_machine=normalized_dst_machine
impala.score.ssh.table.field.normalized_dst_machine_score=${impala.table.field.event.normalized_dst_machine_score}
impala.score.ssh.table.fields.LR=LR
impala.score.ssh.table.field.EventScore=${impala.table.field.event.score}
impala.score.ssh.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.score.ssh.table.fields=${impala.score.ssh.table.fields.date_time} TIMESTAMP,${impala.score.ssh.table.field.epochtime} BIGINT,${impala.score.ssh.table.fields.date_time_score} DOUBLE,${impala.score.ssh.table.field.username} STRING,${impala.score.ssh.table.fields.normalized_username} STRING,${impala.score.ssh.table.fields.is_user_administrator} BOOLEAN,${impala.score.ssh.table.fields.is_user_executive} BOOLEAN,${impala.score.ssh.table.fields.is_user_service_account} BOOLEAN,${impala.score.ssh.table.fields.status} STRING,${impala.score.ssh.table.fields.auth_method} STRING,${impala.score.ssh.table.fields.auth_method_score} DOUBLE,${impala.score.ssh.table.fields.source_ip} STRING,${impala.score.ssh.table.field.is_nat} BOOLEAN,${impala.score.ssh.table.field.hostname} STRING,${impala.score.ssh.table.field.normalized_src_machine} STRING,${impala.score.ssh.table.field.normalized_src_machine_score} DOUBLE,${impala.score.ssh.table.field.target_machine} STRING,${impala.score.ssh.table.field.normalized_dst_machine} STRING,${impala.score.ssh.table.field.normalized_dst_machine_score} DOUBLE,${impala.score.ssh.table.field.is_sensitive_machine} BOOLEAN,${impala.score.ssh.table.fields.LR} BOOLEAN,${impala.score.ssh.table.field.EventScore} DOUBLE,${impala.score.ssh.table.field.src_class} STRING,${impala.score.ssh.table.field.dst_class} STRING
impala.score.ssh.table.delimiter=,
impala.score.ssh.table.partition.type=daily

impala.score.ssh.top.table.name=sshscores_top
impala.score.ssh.top.table.fields=${impala.score.ssh.table.fields}
impala.score.ssh.top.table.delimiter=,
impala.score.ssh.top.table.partition.type=daily


#####################


###################################################################################################################################################################################

####################################################################################  VPN Session  ########################################################################################

##### Data Schema
impala.vpn_session.have.data=false
#################

##### Enriched Schema
impala.vpn_session.have.enrich=false
#################

##### Score Schema
impala.vpn_session.have.topScore=true

impala.score.vpn.session.table.field.date_time=date_time
impala.score.vpn.session.table.field.normalizedtime=normalizedTime
impala.score.vpn.session.table.field.hostname=hostname
impala.score.vpn.session.table.field.country=country
impala.score.vpn.session.table.field.countrycode=countrycode
impala.score.vpn.session.table.field.region=region
impala.score.vpn.session.table.field.city=city
impala.score.vpn.session.table.field.isp=isp
impala.score.vpn.session.table.field.ipusage=ipusage
impala.score.vpn.session.table.field.source_ip=source_ip
impala.score.vpn.session.table.field.status=status
impala.score.vpn.session.table.field.local_ip=local_ip
impala.score.vpn.session.table.field.totalbytes=totalbytes
impala.score.vpn.session.table.field.readbytes=readbytes
impala.score.vpn.session.table.field.writebytes=writebytes
impala.score.vpn.session.table.field.duration=duration
impala.score.vpn.session.table.field.databucket=databucket
impala.score.vpn.session.table.field.bytesavg=bytesavg
impala.score.vpn.session.table.field.date_time.score=date_timeScore
impala.score.vpn.session.table.field.hostname.score=${impala.table.field.event.normalized_src_machine_score}
impala.score.vpn.session.table.field.country.score=countryscore
impala.score.vpn.session.table.field.databucket.score=databucketScore
impala.score.vpn.session.table.field.EntityGroupedById=EntityGroupedById
impala.score.vpn.session.table.fields.LR=LR

impala.score.vpn_session.table.name=vpnsessiondatares
impala.score.vpn_session.table.fields=${impala.score.vpn.session.table.field.date_time} TIMESTAMP,${impala.data.vpn.table.field.epochtime} BIGINT,${impala.data.table.fields.normalized_username} STRING,${impala.table.fields.username} STRING,${impala.score.vpn.session.table.field.hostname} STRING,${impala.score.vpn.session.table.field.hostname.score} DOUBLE,${impala.score.vpn.session.table.field.country} STRING,${impala.score.vpn.session.table.field.country.score} DOUBLE,${impala.score.vpn.session.table.field.countrycode} STRING,${impala.score.vpn.session.table.field.region} STRING,${impala.score.vpn.session.table.field.city} STRING,${impala.score.vpn.session.table.field.databucket} INT,${impala.score.vpn.session.table.field.databucket.score} DOUBLE,${impala.score.vpn.session.table.field.isp} STRING,${impala.score.vpn.session.table.field.ipusage} STRING,${impala.score.vpn.session.table.field.source_ip} STRING,${impala.score.vpn.session.table.field.status} STRING,${impala.score.vpn.session.table.field.local_ip} STRING,${impala.score.vpn.session.table.field.totalbytes} BIGINT,${impala.score.vpn.session.table.field.readbytes} BIGINT,${impala.score.vpn.session.table.field.writebytes} BIGINT,${impala.score.vpn.session.table.field.duration} INT,${impala.score.vpn.session.table.field.bytesavg} DOUBLE,${impala.score.vpn.session.table.fields.LR} BOOLEAN,${impala.table.field.event.score} DOUBLE
impala.score.vpn_session.table.delimiter=,
impala.score.vpn_session.table.partition.type=daily

impala.score.vpn_session.top.table.name=vpnsessiondatares_top
impala.score.vpn_session.top.table.fields=${impala.score.vpn_session.table.fields}
impala.score.vpn_session.top.table.delimiter=,
impala.score.vpn_session.top.table.partition.type=daily



########################################### crmsf ########################################################
impala.data.crmsf.table.field.username=username
impala.data.crmsf.table.field.source=source_ip
impala.data.crmsf.table.field.source_name=hostname
impala.data.crmsf.table.field.src_class=src_class
impala.data.crmsf.table.field.normalized_src_machine=normalized_src_machine
impala.data.crmsf.table.field.target=target_ip
impala.data.crmsf.table.field.target_name=target
impala.data.crmsf.table.field.dst_class=dst_class
impala.data.crmsf.table.field.normalized_dst_machine=normalized_dst_machine
impala.data.crmsf.table.field.epochtime=date_time_unix
impala.data.crmsf.table.field.src_country=src_country
impala.data.crmsf.table.field.countryIsoCode=countryIsoCode
impala.data.crmsf.table.field.region=region
impala.data.crmsf.table.field.city=city
impala.data.crmsf.table.field.isp=isp
impala.data.crmsf.table.field.ipusage=ipusage


########### Data Schema
impala.crmsf.have.data=true
impala.data.crmsf.table.delimiter=,
impala.data.crmsf.table.name=crmsfdata
hdfs.user.data.crmsf.path=${hdfs.user.data.path}/crmsf
hdfs.user.data.crmsf.retention=365
impala.data.crmsf.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.crmsf.table.partition.type=monthly
impala.data.crmsf.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,country STRING,longtitude STRING,latitude STRING,countryIsoCode STRING,region STRING,city STRING,isp STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_country STRING,dst_longtitude STRING,dst_latitude STRING,dst_countryIsoCode STRING,dst_region STRING,dst_city STRING,dst_isp STRING,dst_usageType STRING,action_type STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,login_type STRING,browser STRING,platform STRING,application STRING,login_url STRING,is_from_vpn BOOLEAN,LR BOOLEAN


########### Enrich Schema
impala.crmsf.have.enrich=true
impala.enricheddata.crmsf.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,country STRING,longtitude STRING,latitude STRING,countryIsoCode STRING,region STRING,city STRING,isp STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_country STRING,dst_longtitude STRING,dst_latitude STRING,dst_countryIsoCode STRING,dst_region STRING,dst_city STRING,dst_isp STRING,dst_usageType STRING,action_type STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,login_type STRING,browser STRING,platform STRING,application STRING,login_url STRING,is_from_vpn BOOLEAN,LR BOOLEAN
impala.enricheddata.crmsf.table.delimiter=,
impala.enricheddata.crmsf.table.name=crmsfenriched
hdfs.user.enricheddata.crmsf.path=${hdfs.user.enricheddata.path}/crmsf
hdfs.user.enricheddata.crmsf.retention=365
hdfs.enricheddata.crmsf.file.name=${impala.enricheddata.crmsf.table.name}.csv
impala.enricheddata.crmsf.table.partition.type=daily
impala.enricheddata.crmsf.table.field.date_time_unix=date_time_unix
impala.enricheddata.crmsf.table.field.normalized_username=normalized_username
########### Score Schema
impala.score.crmsf.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,country STRING,longtitude STRING,latitude STRING,countryIsoCode STRING,region STRING,city STRING,isp STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_country STRING,dst_longtitude STRING,dst_latitude STRING,dst_countryIsoCode STRING,dst_region STRING,dst_city STRING,dst_isp STRING,dst_usageType STRING,action_type STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,source_machine_score DOUBLE,country_score DOUBLE,destination_machine_score DOUBLE,action_type_score DOUBLE,status_score DOUBLE,login_type STRING,browser STRING,platform STRING,application STRING,login_url STRING,is_from_vpn BOOLEAN,LR BOOLEAN
impala.score.crmsf.table.delimiter=,
impala.score.crmsf.table.name=crmsfscore
hdfs.user.processeddata.crmsf.path=${hdfs.user.processeddata.path}/crmsf
hdfs.user.processeddata.crmsf.retention=365
impala.score.crmsf.table.partition.type=daily
impala.score.crmsf.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.crmsf.table.fields.normalized_username=${impala.data.table.fields.normalized_username}

########### Top Score Schema
impala.crmsf.have.topScore=true
impala.score.crmsf.top.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,country STRING,longtitude STRING,latitude STRING,countryIsoCode STRING,region STRING,city STRING,isp STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_country STRING,dst_longtitude STRING,dst_latitude STRING,dst_countryIsoCode STRING,dst_region STRING,dst_city STRING,dst_isp STRING,dst_usageType STRING,action_type STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,source_machine_score DOUBLE,country_score DOUBLE,destination_machine_score DOUBLE,action_type_score DOUBLE,status_score DOUBLE,login_type STRING,browser STRING,platform STRING,application STRING,login_url STRING,is_from_vpn BOOLEAN,LR BOOLEAN
impala.score.crmsf.top.table.delimiter=,
impala.score.crmsf.top.table.name=crmsfscore_top
hdfs.user.processeddata.crmsf.top.path=${hdfs.user.processeddata.path}/crmsf_top
hdfs.user.processeddata.crmsf.top.retention=365
impala.score.crmsf.top.table.partition.type=daily

crmsf.EventsJoiner.ttl=86400
kafka.crmsf.message.record.field.data_source=data_source
kafka.crmsf.message.record.field.last_state=last_state
kafka.crmsf.message.record.fields = ${impala.data.crmsf.table.fields},${kafka.crmsf.message.record.field.data_source},${kafka.crmsf.message.record.field.last_state}
readCRMSF.morphline=file:resources/conf-files/parseCRMSF.conf
enrichCRMSF.morphline=file:resources/conf-files/enrichment/readCRMSF_enrich.conf


########################################### wame ########################################################
impala.data.wame.table.field.username=username
impala.data.wame.table.field.source=source_ip
impala.data.wame.table.field.source_name=hostname
impala.data.wame.table.field.src_class=src_class
impala.data.wame.table.field.normalized_src_machine=normalized_src_machine
impala.data.wame.table.field.epochtime=date_time_unix
impala.data.wame.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}


########### Data Schema
impala.wame.have.data=true
impala.data.wame.table.delimiter=,
impala.data.wame.table.name=wamedata
hdfs.user.data.wame.path=${hdfs.user.data.path}/wame
hdfs.user.data.wame.retention=365
impala.data.wame.table.partition.type=monthly
impala.data.wame.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,action_type STRING,user_domain STRING,target_user_name STRING,target_user_domain STRING,target_normalized_username STRING


########### Enrich Schema
impala.wame.have.enrich=true
impala.enricheddata.wame.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,action_type STRING,user_domain STRING,target_user_name STRING,target_user_domain STRING,target_normalized_username STRING
impala.enricheddata.wame.table.delimiter=,
impala.enricheddata.wame.table.name=wameenriched
hdfs.user.enricheddata.wame.path=${hdfs.user.enricheddata.path}/wame
hdfs.user.enricheddata.wame.retention=365
hdfs.enricheddata.wame.file.name=${impala.enricheddata.wame.table.name}.csv
impala.enricheddata.wame.table.partition.type=daily
impala.enricheddata.wame.table.field.date_time_unix=date_time_unix
impala.enricheddata.wame.table.field.normalized_username=normalized_username

########### Score Schema
impala.score.wame.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,action_type STRING,date_time_score DOUBLE,eventscore DOUBLE,source_machine_score DOUBLE,action_type_score DOUBLE,user_domain STRING,target_user_name STRING,target_user_domain STRING,target_normalized_username STRING
impala.score.wame.table.delimiter=,
impala.score.wame.table.name=wamescore
hdfs.user.processeddata.wame.path=${hdfs.user.processeddata.path}/wame
hdfs.user.processeddata.wame.retention=365
impala.score.wame.table.partition.type=daily
impala.score.wame.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.wame.table.fields.normalized_username=normalized_username


########### Top Score Schema
impala.wame.have.topScore=true
impala.score.wame.top.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,action_type STRING,date_time_score DOUBLE,eventscore DOUBLE,source_machine_score DOUBLE,action_type_score DOUBLE,user_domain STRING,target_user_name STRING,target_user_domain STRING,target_normalized_username STRING
impala.score.wame.top.table.delimiter=,
impala.score.wame.top.table.name=wamescore_top
hdfs.user.processeddata.wame.top.path=${hdfs.user.processeddata.path}/wame_top
hdfs.user.processeddata.wame.top.retention=365
impala.score.wame.top.table.partition.type=daily

wame.EventsJoiner.ttl=86400
kafka.wame.message.record.field.data_source=data_source
kafka.wame.message.record.field.last_state=last_state
kafka.wame.message.record.fields = ${impala.data.wame.table.fields},${kafka.wame.message.record.field.data_source},${kafka.wame.message.record.field.last_state}
readWAME.morphline=file:resources/conf-files/parseWAME.conf
enrichWAME.morphline=file:resources/conf-files/enrichment/readWAME_enrich.conf

#################   ORACLE     ###############

impala.data.oracle.table.field.username=username
impala.data.oracle.table.field.source=source_ip
impala.data.oracle.table.field.hostname=hostname
impala.data.oracle.table.field.source_name=hostname
impala.score.oracle.table.field.src_class=src_class
impala.score.oracle.table.field.dst_class=dst_class
impala.score.oracle.table.field.return_code=return_code
impala.data.oracle.table.field.src_class=src_class
impala.data.oracle.table.field.normalized_src_machine=normalized_src_machine
impala.data.oracle.table.field.target=target_ip
impala.data.oracle.table.field.target_name=target
impala.data.oracle.table.field.dst_class=dst_class
impala.data.oracle.table.field.normalized_dst_machine=normalized_dst_machine
impala.data.oracle.table.field.epochtime=date_time_unix
impala.data.oracle.table.field.normalized_username=${impala.table.fields.normalized.username}
impala.data.oracle.table.field.is_user_service=is_user_service
impala.data.oracle.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.oracle.table.field.is_from_vpn=is_from_vpn

########### Data Schema
impala.oracle.have.data=true
impala.data.oracle.table.delimiter=,
impala.data.oracle.table.name=oracledata
hdfs.user.data.oracle.path=${hdfs.user.data.path}/oracle
hdfs.user.data.oracle.retention=365
impala.data.oracle.table.partition.type=monthly
impala.data.oracle.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,db_username STRING,db_id STRING,priv_used STRING,db_object STRING,return_code STRING,action_type STRING, is_from_vpn BOOLEAN

readORACLE.morphline=file:resources/conf-files/db/oracle/parseORACLE.conf
enrichORACLE.morphline=file:resources/conf-files/enrichment/readORACLE_enrich.conf

########### Enrich Schema
impala.oracle.have.enrich=true
impala.enricheddata.oracle.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,db_username STRING,db_id STRING,priv_used STRING,db_object STRING,return_code STRING,action_type STRING,is_from_vpn BOOLEAN
impala.enricheddata.oracle.table.field.date_time_unix=date_time_unix
impala.enricheddata.oracle.table.field.normalized_username=normalized_username
impala.enricheddata.oracle.table.delimiter=,
impala.enricheddata.oracle.table.name=oracleenriched
hdfs.user.enricheddata.oracle.path=${hdfs.user.enricheddata.path}/oracle
hdfs.user.enricheddata.oracle.retention=365
hdfs.enricheddata.oracle.file.name=${impala.enricheddata.oracle.table.name}.csv
impala.enricheddata.oracle.table.partition.type=daily

########### Score Schema
impala.score.oracle.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,normalized_src_machine_score DOUBLE,normalized_dst_machine_score DOUBLE,db_username STRING,db_id STRING,priv_used STRING,db_object STRING,return_code STRING,action_type STRING,db_username_score DOUBLE,return_code_score DOUBLE,db_object_score DOUBLE,action_type_score DOUBLE,is_from_vpn BOOLEAN
impala.score.oracle.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.oracle.table.delimiter=,
impala.score.oracle.table.name=oraclescore
hdfs.user.processeddata.oracle.path=${hdfs.user.processeddata.path}/oracle
hdfs.user.processeddata.oracle.retention=365
impala.score.oracle.table.partition.type=daily
hdfs.user.processeddata.oracle.file.name=${impala.score.oracle.table.name}.csv


########### Top Score Schema
impala.oracle.have.topScore=true
impala.score.oracle.top.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,normalized_src_machine_score DOUBLE,normalized_dst_machine_score DOUBLE,db_username STRING,db_id STRING,priv_used STRING,db_object STRING,return_code STRING,action_type STRING,db_username_score DOUBLE,return_code_score DOUBLE,db_object_score DOUBLE,action_type_score DOUBLE, is_from_vpn BOOLEAN
impala.score.oracle.top.table.delimiter=,
impala.score.oracle.top.table.name=oraclescore_top
hdfs.user.processeddata.oracle.top.path=${hdfs.user.processeddata.path}/oracle_top
hdfs.user.processeddata.oracle.top.retention=365
impala.score.oracle.top.table.partition.type=daily

oracle.EventsJoiner.ttl=86400
kafka.oracle.message.record.field.data_source=data_source
kafka.oracle.message.record.field.last_state=last_state
kafka.oracle.message.record.fields = ${impala.data.oracle.table.fields},${kafka.oracle.message.record.field.data_source},${kafka.oracle.message.record.field.last_state}

#################   NTLM        ###############

impala.data.ntlm.table.field.username=username
impala.data.ntlm.table.field.source=source_ip
impala.data.ntlm.table.field.source_name=hostname
impala.data.ntlm.table.field.src_class=src_class
impala.data.ntlm.table.field.normalized_src_machine=normalized_src_machine
impala.data.ntlm.table.field.epochtime=date_time_unix
impala.data.ntlm.table.field.normalized_username=${impala.table.fields.normalized.username}
########### Data Schema
impala.ntlm.have.data=true
impala.data.ntlm.table.delimiter=,
impala.data.ntlm.table.name=ntlmdata
hdfs.user.data.ntlm.path=${hdfs.user.data.path}/ntlm
hdfs.user.data.ntlm.retention=360
impala.data.ntlm.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.ntlm.table.partition.type=monthly
impala.data.ntlm.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,failure_code STRING,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN


########### Enrich Schema
impala.ntlm.have.enrich=true
impala.enricheddata.ntlm.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,failure_code STRING,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN
impala.enricheddata.ntlm.table.delimiter=,
impala.enricheddata.ntlm.table.name=ntlmenriched
hdfs.user.enricheddata.ntlm.path=${hdfs.user.enricheddata.path}/ntlm
hdfs.user.enricheddata.ntlm.retention=365
hdfs.enricheddata.ntlm.file.name=${impala.enricheddata.ntlm.table.name}.csv
impala.enricheddata.ntlm.table.partition.type=daily
impala.enricheddata.ntlm.table.field.date_time_unix=date_time_unix
impala.enricheddata.ntlm.table.field.normalized_username=normalized_username


########### Score Schema
impala.score.ntlm.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,normalized_src_machine_score DOUBLE,failure_code STRING,failure_code_score DOUBLE,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN
impala.score.ntlm.table.delimiter=,
impala.score.ntlm.table.name=ntlmscore
hdfs.user.processeddata.ntlm.path=${hdfs.user.processeddata.path}/ntlm
hdfs.user.processeddata.ntlm.retention=365
impala.score.ntlm.table.partition.type=daily
hdfs.user.processeddata.ntlm.file.name=${impala.score.ntlm.table.name}.csv
impala.score.ntlm.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.ntlm.table.fields.normalized_username=normalized_username
impala.score.ntlm.table.field.failure_code=failure_code


########### Top Score Schema
impala.ntlm.have.topScore=true
impala.score.ntlm.top.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,normalized_src_machine_score DOUBLE,failure_code STRING,failure_code_score DOUBLE,LR BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN
impala.score.ntlm.top.table.delimiter=,
impala.score.ntlm.top.table.name=ntlmscore_top
hdfs.user.processeddata.ntlm.top.file.name=${impala.score.ntlm.top.table.name}.csv
hdfs.user.processeddata.ntlm.top.path=${hdfs.user.processeddata.path}/ntlm_top
hdfs.user.processeddata.ntlm.top.retention=365
impala.score.ntlm.top.table.partition.type=daily

ntlm.EventsJoiner.ttl=86400
kafka.ntlm.message.record.field.data_source=data_source
kafka.ntlm.message.record.field.last_state=last_state
kafka.ntlm.message.record.fields = ${impala.data.ntlm.table.fields},${kafka.ntlm.message.record.field.data_source},${kafka.ntlm.message.record.field.last_state}
readNTLM.morphline=file:resources/conf-files/parseNTLM.conf
enrichNTLM.morphline=file:resources/conf-files/enrichment/readNTLM_enrich.conf

#############################################

########################################### gwame ########################################################
impala.data.gwame.table.field.username=username
impala.data.gwame.table.field.source=source_ip
impala.data.gwame.table.field.source_name=hostname
impala.data.gwame.table.field.src_class=src_class
impala.data.gwame.table.field.normalized_src_machine=normalized_src_machine
impala.data.gwame.table.field.epochtime=date_time_unix
impala.data.gwame.table.field.normalized_username=${impala.table.fields.normalized.username}
########### Data Schema
impala.gwame.have.data=true
impala.data.gwame.table.delimiter=|
impala.data.gwame.table.name=gwamedata
hdfs.user.data.gwame.path=${hdfs.user.data.path}/gwame
hdfs.user.data.gwame.retention=365
impala.data.gwame.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.gwame.table.partition.type=monthly
impala.data.gwame.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,user_domain STRING,target_username STRING,target_DN STRING,target_user_domain STRING,target_normalized_username STRING,group_name STRING,action_type STRING,${fortscale.tags.LR} BOOLEAN


########### Enrich Schema
impala.enricheddata.gwame.table.field.epochtime=${impala.table.fields.epochtime}
impala.gwame.have.enrich=true
impala.enricheddata.gwame.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,user_domain STRING,target_username STRING,target_DN STRING,target_user_domain STRING,target_normalized_username STRING,group_name STRING,action_type STRING,${fortscale.tags.LR} BOOLEAN
impala.enricheddata.gwame.table.delimiter=|
impala.enricheddata.gwame.table.name=gwameenriched
hdfs.user.enricheddata.gwame.path=${hdfs.user.enricheddata.path}/gwame
hdfs.user.enricheddata.gwame.retention=365
hdfs.enricheddata.gwame.file.name=${impala.enricheddata.gwame.table.name}.csv
impala.enricheddata.gwame.table.partition.type=daily
########### Score Schema
impala.score.gwame.table.field.epochtime=${impala.table.fields.epochtime}
impala.score.gwame.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,source_machine_score DOUBLE,user_domain STRING,target_username STRING,target_DN STRING,target_user_domain STRING,target_normalized_username STRING,group_name STRING,action_type STRING,${fortscale.tags.LR} BOOLEAN
impala.score.gwame.table.delimiter=|
impala.score.gwame.table.name=gwamescore
hdfs.user.processeddata.gwame.path=${hdfs.user.processeddata.path}/gwame
hdfs.user.processeddata.gwame.retention=365
impala.score.gwame.table.partition.type=daily
hdfs.user.processeddata.gwame.file.name=${impala.score.gwame.table.name}.csv
########### Top Score Schema
impala.gwame.have.topScore=true
impala.score.gwame.top.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,source_machine_score DOUBLE,user_domain STRING,target_username STRING,target_DN STRING,target_user_domain STRING,target_normalized_username STRING,group_name STRING,action_type STRING,${fortscale.tags.LR} BOOLEAN
impala.score.gwame.top.table.delimiter=|
impala.score.gwame.top.table.name=gwamescore_top
hdfs.user.processeddata.gwame.top.file.name=${impala.score.gwame.top.table.name}.csv
hdfs.user.processeddata.gwame.top.path=${hdfs.user.processeddata.path}/gwame_top
hdfs.user.processeddata.gwame.top.retention=365
impala.score.gwame.top.table.partition.type=daily

gwame.EventsJoiner.ttl=86400
kafka.gwame.message.record.field.data_source=data_source
kafka.gwame.message.record.field.last_state=last_state
kafka.gwame.message.record.fields = ${impala.data.gwame.table.fields},${kafka.gwame.message.record.field.data_source},${kafka.gwame.message.record.field.last_state},target_DN
readGWAME.morphline=file:resources/conf-files/parseGWAME.conf
enrichGWAME.morphline=file:resources/conf-files/enrichment/readGWAME_enrich.conf



########################################### prnlog ########################################################
impala.data.prnlog.table.field.username=username
impala.data.prnlog.table.field.source=source_ip
impala.data.prnlog.table.field.source_name=hostname
impala.data.prnlog.table.field.src_class=src_class
impala.data.prnlog.table.field.normalized_src_machine=normalized_src_machine
impala.data.prnlog.table.field.target=target_ip
impala.data.prnlog.table.field.target_name=target_machine
impala.data.prnlog.table.field.dst_class=dst_class
impala.data.prnlog.table.field.normalized_dst_machine=normalized_dst_machine
impala.data.prnlog.table.field.epochtime=date_time_unix
impala.data.prnlog.table.field.normalized_username=${impala.table.fields.normalized.username}
########### Data Schema
impala.prnlog.have.data=true
impala.data.prnlog.table.delimiter=,
impala.data.prnlog.table.name=prnlogdata
hdfs.user.data.prnlog.path=${hdfs.user.data.path}/prnlog
hdfs.user.data.prnlog.retention=365
impala.data.prnlog.table.field.is_sensitive_machine=${fortscale.tags.sensitive.machine}
impala.data.prnlog.table.partition.type=monthly
impala.data.prnlog.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_isp STRING,dst_usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,file_size DOUBLE,file_name STRING,total_pages DOUBLE,is_from_vpn BOOLEAN


########### Enrich Schema
impala.prnlog.have.enrich=true
impala.enricheddata.prnlog.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_isp STRING,dst_usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,file_size DOUBLE,file_name STRING,total_pages DOUBLE,is_from_vpn BOOLEAN
impala.enricheddata.prnlog.table.delimiter=,
impala.enricheddata.prnlog.table.name=prnlogenriched
hdfs.user.enricheddata.prnlog.path=${hdfs.user.enricheddata.path}/prnlog
hdfs.user.enricheddata.prnlog.retention=365
hdfs.enricheddata.prnlog.file.name=${impala.enricheddata.prnlog.table.name}.csv
impala.enricheddata.prnlog.table.partition.type=daily
impala.enricheddata.prnlog.table.field.date_time_unix=date_time_unix
impala.enricheddata.prnlog.table.field.normalized_username=normalized_username

########### Score Schema
impala.score.prnlog.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_isp STRING,dst_usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,normalized_src_machine_score DOUBLE,normalized_dst_machine_score DOUBLE,file_size DOUBLE,file_name STRING,total_pages DOUBLE,is_from_vpn BOOLEAN
impala.score.prnlog.table.delimiter=,
impala.score.prnlog.table.name=prnlogscore
hdfs.user.processeddata.prnlog.path=${hdfs.user.processeddata.path}/prnlog
hdfs.user.processeddata.prnlog.retention=365

impala.score.prnlog.table.partition.type=daily
hdfs.user.processeddata.prnlog.file.name=${impala.score.prnlog.table.name}.csv
impala.score.prnlog.table.fields.normalized_username=${impala.data.table.fields.normalized_username}
impala.score.prnlog.table.field.epochtime=${impala.data.table.fields.epochtime}
########### Top Score Schema
impala.prnlog.have.topScore=true
impala.score.prnlog.top.table.fields=date_time TIMESTAMP,date_time_unix BIGINT,username STRING,normalized_username STRING,source_ip STRING,hostname STRING,normalized_src_machine STRING,src_class STRING,usageType STRING,target_ip STRING,target_machine STRING,normalized_dst_machine STRING,dst_class STRING,dst_isp STRING,dst_usageType STRING,status STRING,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN,${fortscale.tags.service} BOOLEAN,${fortscale.tags.sensitive.machine} BOOLEAN,LR BOOLEAN,date_time_score DOUBLE,eventscore DOUBLE,normalized_src_machine_score DOUBLE,normalized_dst_machine_score DOUBLE,file_size DOUBLE,file_name STRING,total_pages DOUBLE,is_from_vpn BOOLEAN
impala.score.prnlog.top.table.delimiter=,
impala.score.prnlog.top.table.name=prnlogscore_top
hdfs.user.processeddata.prnlog.top.file.name=${impala.score.prnlog.top.table.name}.csv
hdfs.user.processeddata.prnlog.top.path=${hdfs.user.processeddata.path}/prnlog_top
hdfs.user.processeddata.prnlog.top.retention=365
impala.score.prnlog.top.table.partition.type=daily

prnlog.EventsJoiner.ttl=86400
kafka.prnlog.message.record.field.data_source=data_source
kafka.prnlog.message.record.field.last_state=last_state
kafka.prnlog.message.record.fields = ${impala.data.prnlog.table.fields},${kafka.prnlog.message.record.field.data_source},${kafka.prnlog.message.record.field.last_state}
readPRNLOG.morphline=file:resources/conf-files/parsePRNLOG.conf
enrichPRNLOG.morphline=file:resources/conf-files/enrichment/readPRNLOG_enrich.conf


########################################### dlpmail ########################################################
########### Fields
impala.data.dlpmail.table.field.epochtime=date_time_unix
impala.data.dlpmail.table.field.event_type=event_type
impala.data.dlpmail.table.field.event_id=event_id
impala.data.dlpmail.table.field.username=username
impala.data.dlpmail.table.field.full_name=full_name
impala.data.dlpmail.table.field.normalized_username=${impala.table.fields.normalized.username}
impala.data.dlpmail.table.field.normalized_src_machine=normalized_src_machine
impala.data.dlpmail.table.field.email_application=email_application
impala.data.dlpmail.table.field.source_name=hostname
impala.data.dlpmail.table.field.attachment_file_name=attachment_file_name
impala.data.dlpmail.table.field.attachment_file_size=attachment_file_size
impala.data.dlpmail.table.field.email_recipient=email_recipient
impala.data.dlpmail.table.field.email_recipient_domain=email_recipient_domain
impala.data.dlpmail.table.field.email_sender=email_sender
impala.data.dlpmail.table.field.email_subject=email_subject
impala.data.dlpmail.table.field.ipaddress=source_ip
impala.data.dlpmail.table.field.is_external=is_external
impala.data.dlpmail.table.field.num_of_recipients=num_of_recipients
impala.data.dlpmail.table.field.is_attachment_extension_blacklisted=is_attachment_extension_blacklisted
impala.data.dlpmail.table.field.attachment_file_directory=attachment_file_directory
impala.data.dlpmail.table.field.attachment_file_extension=attachment_file_extension
impala.data.dlpmail.table.field.was_classified=was_classified
impala.data.dlpmail.table.field.was_blocked=was_blocked
impala.data.dlpmail.table.field.malware_scan_result=malware_scan_result
impala.data.dlpmail.table.field.policy_name=policy_name
impala.data.dlpmail.table.field.event_description=event_description


########### Data Schema
impala.dlpmail.have.data=true
impala.data.dlpmail.table.delimiter=,
impala.data.dlpmail.table.name=dlpmaildata
hdfs.user.data.dlpmail.path=${hdfs.user.data.path}/dlpmail
hdfs.user.data.dlpmail.retention=365
impala.data.dlpmail.table.partition.type=daily
impala.data.dlpmail.table.fields=date_time TIMESTAMP,${impala.data.dlpmail.table.field.epochtime} BIGINT,${impala.data.dlpmail.table.field.event_description} STRING,${impala.data.dlpmail.table.field.event_type} STRING,${impala.data.dlpmail.table.field.event_id} STRING,${impala.data.dlpmail.table.field.username} STRING,${impala.data.dlpmail.table.field.normalized_username} STRING,${impala.data.dlpmail.table.field.full_name} STRING,${impala.data.dlpmail.table.field.ipaddress} STRING,${impala.data.dlpmail.table.field.source_name} STRING,${impala.data.dlpmail.table.field.normalized_src_machine} STRING,${impala.data.dlpmail.table.field.email_application} STRING,${impala.data.dlpmail.table.field.attachment_file_name} STRING,${impala.data.dlpmail.table.field.attachment_file_size} DOUBLE,${impala.data.dlpmail.table.field.email_recipient} STRING,${impala.data.dlpmail.table.field.email_recipient_domain} STRING,${impala.data.dlpmail.table.field.email_sender} STRING,${impala.data.dlpmail.table.field.email_subject} STRING,${impala.data.dlpmail.table.field.is_external} BOOLEAN,${impala.data.dlpmail.table.field.num_of_recipients} BIGINT,${impala.data.dlpmail.table.field.is_attachment_extension_blacklisted} BOOLEAN,${impala.data.dlpmail.table.field.attachment_file_directory} STRING,${impala.data.dlpmail.table.field.attachment_file_extension} STRING,${impala.data.dlpmail.table.field.was_classified} BOOLEAN,${impala.data.dlpmail.table.field.was_blocked} BOOLEAN,${impala.data.dlpmail.table.field.malware_scan_result} STRING,${impala.data.dlpmail.table.field.policy_name} STRING


########### Enrich Schema
impala.dlpmail.have.enrich=true
impala.enricheddata.dlpmail.table.fields=${impala.data.dlpmail.table.fields}
impala.enricheddata.dlpmail.table.delimiter=,
impala.enricheddata.dlpmail.table.name=dlpmailenriched
hdfs.user.enricheddata.dlpmail.path=${hdfs.user.enricheddata.path}/dlpmail
hdfs.user.enricheddata.dlpmail.retention=365
hdfs.enricheddata.dlpmail.file.name=${impala.enricheddata.dlpmail.table.name}.csv
impala.enricheddata.dlpmail.table.partition.type=daily
impala.enricheddata.dlpmail.table.field.date_time_unix=date_time_unix
impala.enricheddata.dlpmail.table.field.normalized_username=${impala.table.fields.normalized.username}

########### Score Fields
impala.score.dlpmail.table.field.date_time_score=date_time_score
impala.score.dlpmail.table.field.normalized_src_machine_score=normalized_src_machine_score
impala.score.dlpmail.table.field.email_application_score=email_application_score
impala.score.dlpmail.table.field.attachment_file_size_score=attachment_file_size_score
impala.score.dlpmail.table.field.email_recipient_domain_score=email_recipient_domain_score
impala.score.dlpmail.table.field.email_sender_score=email_sender_score
impala.score.dlpmail.table.field.attachment_file_extension_score=attachment_file_extension_score


########### Score Schema
impala.dlpmail.have.score=true
impala.score.dlpmail.table.fields=${impala.data.dlpmail.table.fields},${impala.table.field.event.score} DOUBLE,${impala.score.dlpmail.table.field.date_time_score} DOUBLE,${impala.score.dlpmail.table.field.normalized_src_machine_score} DOUBLE,${impala.score.dlpmail.table.field.email_application_score} DOUBLE,${impala.score.dlpmail.table.field.attachment_file_size_score} DOUBLE,${impala.score.dlpmail.table.field.email_recipient_domain_score} DOUBLE,${impala.score.dlpmail.table.field.email_sender_score} DOUBLE,${impala.score.dlpmail.table.field.attachment_file_extension_score} DOUBLE
impala.score.dlpmail.table.delimiter=,
impala.score.dlpmail.table.name=dlpmailscore
hdfs.user.processeddata.dlpmail.path=${hdfs.user.processeddata.path}/dlpmail
hdfs.user.processeddata.dlpmail.retention=365
impala.score.dlpmail.table.partition.type=daily
impala.score.dlpmail.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.dlpmail.table.fields.normalized_username=normalized_username


########### Top Score Schema
impala.dlpmail.have.topScore=true
impala.score.dlpmail.top.table.fields=${impala.score.dlpmail.table.fields}
impala.score.dlpmail.top.table.delimiter=,
impala.score.dlpmail.top.table.name=dlpmailscore_top
hdfs.user.processeddata.dlpmail.top.path=${hdfs.user.processeddata.path}/dlpmail_top
hdfs.user.processeddata.dlpmail.top.retention=365
impala.score.dlpmail.top.table.partition.type=daily

dlpmail.EventsJoiner.ttl=86400
kafka.dlpmail.message.record.field.data_source=data_source
kafka.dlpmail.message.record.field.last_state=last_state
kafka.dlpmail.message.record.fields = ${impala.data.dlpmail.table.fields},${kafka.dlpmail.message.record.field.data_source},${kafka.dlpmail.message.record.field.last_state}


readDlpmail.morphline=file:resources/conf-files/parseDGMail.conf
enrichdlpmail.morphline=file:resources/conf-files/enrichment/readDlpMail_enrich.conf
########################################### dlpmail end ########################################################




########################################### dlpfile ########################################################
########### Fields
impala.data.dlpfile.table.field.event_date_time=date_time
impala.data.dlpfile.table.field.epochtime=date_time_unix
impala.data.dlpfile.table.field.event_type=event_type
impala.data.dlpfile.table.field.event_id=event_id
impala.data.dlpfile.table.field.username=username
impala.data.dlpfile.table.field.normalized_username=normalized_username
impala.data.dlpfile.table.field.full_name=full_name
impala.data.dlpfile.table.field.hostname=hostname
impala.data.dlpfile.table.field.normalized_src_machine=normalized_src_machine
impala.data.dlpfile.table.field.source_ip=source_ip
impala.data.dlpfile.table.field.file_application=file_application
impala.data.dlpfile.table.field.source_path=source_path
impala.data.dlpfile.table.field.destination_path=destination_path
impala.data.dlpfile.table.field.source_file_name=source_file_name
impala.data.dlpfile.table.field.destination_file_name=destination_file_name
impala.data.dlpfile.table.field.file_size=file_size
impala.data.dlpfile.table.field.source_drive_type=source_drive_type
impala.data.dlpfile.table.field.destination_drive_type=destination_drive_type
impala.data.dlpfile.table.field.was_classified=was_classified
impala.data.dlpfile.table.field.was_blocked=was_blocked
impala.data.dlpfile.table.field.malware_scan_result=malware_scan_result
impala.data.dlpfile.table.field.policy_name=policy_name
impala.data.dlpfile.table.field.is_rdp=is_rdp
impala.data.dlpfile.table.field.is_admin_activity=is_admin_activity
impala.data.dlpfile.table.field.is_registry_changed=is_registry_changed


########### Data Schema
impala.dlpfile.have.data=true
impala.data.dlpfile.table.delimiter=,
impala.data.dlpfile.table.name=dlpfiledata
hdfs.user.data.dlpfile.path=${hdfs.user.data.path}/dlpfile
hdfs.user.data.dlpfile.retention=365
impala.data.dlpfile.table.partition.type=daily
impala.data.dlpfile.table.fields=${impala.data.dlpfile.table.field.event_date_time} TIMESTAMP,${impala.data.dlpfile.table.field.epochtime} BIGINT,${impala.data.dlpfile.table.field.event_type} STRING,${impala.data.dlpfile.table.field.event_id} STRING,${impala.data.dlpfile.table.field.username} STRING,${impala.data.dlpfile.table.field.normalized_username} STRING,${impala.data.dlpfile.table.field.full_name} STRING,${impala.data.dlpfile.table.field.hostname} STRING,${impala.data.dlpfile.table.field.normalized_src_machine} STRING,${impala.data.dlpfile.table.field.source_ip} STRING,${impala.data.dlpfile.table.field.file_application} STRING,${impala.data.dlpfile.table.field.source_path} STRING,${impala.data.dlpfile.table.field.destination_path} STRING,${impala.data.dlpfile.table.field.source_file_name} STRING,${impala.data.dlpfile.table.field.destination_file_name} STRING,${impala.data.dlpfile.table.field.file_size} DOUBLE,${impala.data.dlpfile.table.field.source_drive_type} STRING,${impala.data.dlpfile.table.field.destination_drive_type} STRING,${impala.data.dlpfile.table.field.was_classified} BOOLEAN,${impala.data.dlpfile.table.field.was_blocked} BOOLEAN,${impala.data.dlpfile.table.field.malware_scan_result} STRING,${impala.data.dlpfile.table.field.policy_name} STRING,${impala.data.dlpfile.table.field.is_rdp} STRING,${impala.data.dlpfile.table.field.is_admin_activity} STRING,${impala.data.dlpfile.table.field.is_registry_changed} STRING

########### Enrich Schema
impala.dlpfile.have.enrich=true
impala.enricheddata.dlpfile.table.fields=${impala.data.dlpfile.table.fields}
impala.enricheddata.dlpfile.table.delimiter=,
impala.enricheddata.dlpfile.table.name=dlpfileenriched
hdfs.user.enricheddata.dlpfile.path=${hdfs.user.enricheddata.path}/dlpfile
hdfs.user.enricheddata.dlpfile.retention=365
hdfs.enricheddata.dlpfile.file.name=${impala.enricheddata.dlpfile.table.name}.csv
impala.enricheddata.dlpfile.table.partition.type=daily
impala.enricheddata.dlpfile.table.field.date_time_unix=date_time_unix
impala.enricheddata.dlpfile.table.field.normalized_username=normalized_username



########### Score Fields
impala.score.dlpfile.table.field.date_time_score=date_time_score
impala.score.dlpfile.table.field.normalized_src_machine_score=normalized_src_machine_score

########### Score Schema
impala.dlpfile.have.score=true
impala.score.dlpfile.table.fields=${impala.data.dlpfile.table.fields},${impala.table.field.event.score} DOUBLE,${impala.score.dlpfile.table.field.date_time_score} DOUBLE,${impala.score.dlpfile.table.field.normalized_src_machine_score} DOUBLE
impala.score.dlpfile.table.delimiter=,
impala.score.dlpfile.table.name=dlpfilescore
hdfs.user.processeddata.dlpfile.path=${hdfs.user.processeddata.path}/dlpfile
hdfs.user.processeddata.dlpfile.retention=365
impala.score.dlpfile.table.partition.type=daily
impala.score.dlpfile.table.field.epochtime=${impala.data.table.fields.epochtime}
impala.score.dlpfile.table.fields.normalized_username=normalized_username


########### Top Score Schema
impala.dlpfile.have.topScore=true
impala.score.dlpfile.top.table.fields=${impala.score.dlpfile.table.fields}
impala.score.dlpfile.top.table.delimiter=,
impala.score.dlpfile.top.table.name=dlpfilescore_top
hdfs.user.processeddata.dlpfile.top.path=${hdfs.user.processeddata.path}/dlpfile_top
hdfs.user.processeddata.dlpfile.top.retention=365
impala.score.dlpfile.top.table.partition.type=daily

dlpfile.EventsJoiner.ttl=86400
kafka.dlpfile.message.record.field.data_source=data_source
kafka.dlpfile.message.record.field.last_state=last_state
kafka.dlpfile.message.record.fields = ${impala.data.dlpfile.table.fields},${kafka.dlpfile.message.record.field.data_source},${kafka.dlpfile.message.record.field.last_state}


readDlpfile.morphline=file:resources/conf-files/parseDGFile.conf
enrichdlpfile.morphline=file:resources/conf-files/enrichment/readDlpFile_enrich.conf
########################################### dlpfile end ########################################################




ldap.tables.fields.runtime=runtime
ldap.tables.fields.timestampepoch=timestampepoch

impala.ldapusers.table.name=ldapusers
impala.ldapusers.table.delimiter=|
impala.ldapusers.table.fields=${ldap.tables.fields.runtime} STRING,distinguishedName STRING,isCriticalSystemObject STRING,isDeleted STRING,badPwdCount INT,logonCount INT,primaryGroupID INT,sAMAccountType BIGINT,userAccountControl INT,accountExpires STRING,badPasswordTime STRING,lastLogoff STRING,lockoutTime STRING,assistant STRING,memberOf STRING,managedObjects STRING,manager STRING,masteredBy STRING,directReports STRING,secretary STRING,logonHours STRING,whenChanged STRING,streetAddress STRING,cn STRING,company STRING,c STRING,department STRING,description STRING,displayName STRING,division STRING,mail STRING,employeeID STRING,employeeNumber STRING,employeeType STRING,givenName STRING,l STRING,o STRING,personalTitle STRING,otherFacsimileTelephoneNumber STRING,otherHomePhone STRING,homePhone STRING,otherMobile STRING,mobile STRING,otherTelephone STRING,roomNumber STRING,userPrincipalName STRING,telephoneNumber STRING,title STRING,userParameters STRING,userWorkstations STRING,lastLogon STRING,pwdLastSet STRING,whenCreated STRING,sn STRING,sAMAccountName STRING,thumbnailPhoto STRING,objectSid STRING,objectGUID STRING,${ldap.tables.fields.timestampepoch} BIGINT
impala.ldapusers.table.partition.type=monthly

impala.ldapgroups.table.name=ldapgroups
impala.ldapgroups.table.delimiter=|
impala.ldapgroups.table.fields=${ldap.tables.fields.runtime} STRING,distinguishedName STRING,name STRING,isCriticalSystemObject STRING,isDeleted STRING,groupType INT,sAMAccountType STRING,memberOf STRING,managedBy STRING,managedObjects STRING,masteredBy STRING,member STRING,nonSecurityMember STRING,nonSecurityMemberBL STRING,directReports STRING,secretary STRING,whenChanged STRING,whenCreated STRING,accountNameHistory STRING,cn STRING,description STRING,displayName STRING,mail STRING,sAMAccountName STRING,objectSid STRING,objectGUID STRING,${ldap.tables.fields.timestampepoch} BIGINT
impala.ldapgroups.table.partition.type=monthly

impala.ldapcomputers.table.name=ldapcomputers
impala.ldapcomputers.table.delimiter=|
impala.ldapcomputers.table.fields=runtime STRING,distinguishedName STRING,ou STRING,operatingSystem STRING,operatingSystemHotfix STRING,operatingSystemServicePack STRING,operatingSystemVersion STRING,lastLogoff STRING,lastLogon STRING,lastLogonTimestamp STRING,logonCount STRING,whenChanged STRING,whenCreated STRING,cn STRING,description STRING,pwdLastSet STRING,memberOf STRING,objectSid STRING,objectGUID STRING,timestampepoch BIGINT
impala.ldapcomputers.table.partition.type=monthly

impala.ldapous.table.name=ldapous
impala.ldapous.table.delimiter=|
impala.ldapous.table.fields=runtime STRING,distinguishedName STRING,isCriticalSystemObject STRING,isDeleted STRING,defaultGroup STRING,memberOf STRING,managedBy STRING,managedObjects STRING,masteredBy STRING,nonSecurityMemberBL STRING,directReports STRING,whenChanged STRING,whenCreated STRING,cn STRING,c STRING,description STRING,displayName STRING,l STRING,ou STRING,objectSid STRING,objectGUID STRING,timestampepoch BIGINT
impala.ldapous.table.partition.type=monthly


impala.user.table.name=users
impala.user.table.delimiter=|

impala.user.fields=id STRING,followed BOOLEAN,username STRING,adUsernames STRING,secUsernames STRING,sshUsernames STRING,vpnUsernames STRING,displayName STRING,jobTitle STRING,employeeId STRING,employeeNumber STRING,dn STRING,ou STRING,userPrincipalName STRING,samAcountName STRING,accountExpires BIGINT,whenChanged BIGINT,whenCreated BIGINT,streetAddress STRING,company STRING,division STRING,roomNumber STRING,accountIsDisabled BOOLEAN,passwordExpired BOOLEAN,noPasswordRequire BOOLEAN,passwordNeverExpires BOOLEAN,directReportsDn STRING,groupsDn STRING,department STRING,email STRING,phone STRING,mobile STRING,homePhone STRING,managerName STRING,managerEmployeeId STRING,managerUsername STRING,managerId STRING,disableAccountTime TIMESTAMP,lastActivityTime TIMESTAMP,sshLastActivityTime TIMESTAMP,vpnLastActivityTime TIMESTAMP,loginLastActivityTime TIMESTAMP,${fortscale.tags.service} BOOLEAN,${fortscale.tags.admin} BOOLEAN,${fortscale.tags.executive} BOOLEAN


impala.user.fields.id = id
impala.user.fields.followed = followed
impala.user.fields.username = username
impala.user.fields.adUsernames = adUsernames
impala.user.fields.secUsernames = secUsernames
impala.user.fields.sshUsernames = sshUsernames
impala.user.fields.vpnUsernames = vpnUsernames
impala.user.fields.displayName = displayName
impala.user.fields.jobTitle = jobTitle
impala.user.fields.employeeId = employeeId
impala.user.fields.employeeNumber = employeeNumber
impala.user.fields.dn = dn
impala.user.fields.ou = ou
impala.user.fields.accountExpires = accountExpires
impala.user.fields.whenChanged = whenChanged
impala.user.fields.whenCreated = whenCreated
impala.user.fields.streetAddress = streetAddress
impala.user.fields.company = company
impala.user.fields.division = division
impala.user.fields.roomNumber = roomNumber
impala.user.fields.accountIsDisabled = accountIsDisabled
impala.user.fields.passwordExpired = passwordExpired
impala.user.fields.noPasswordRequire = noPasswordRequire
impala.user.fields.passwordNeverExpires = passwordNeverExpires
impala.user.fields.directReportsDn = directReportsDn
impala.user.fields.groupsDn = groupsDn
impala.user.fields.department = department
impala.user.fields.email = email
impala.user.fields.phone = phone
impala.user.fields.mobile = mobile
impala.user.fields.homePhone = homePhone
impala.user.fields.managerName = managerName
impala.user.fields.managerEmployeeId = managerEmployeeId
impala.user.fields.managerUsername = managerUsername
impala.user.fields.managerId = managerId
impala.user.fields.disableAccountTime = disableAccountTime
impala.user.fields.lastActivityTime = lastActivityTime
impala.user.fields.sshLastActivityTime = sshLastActivityTime
impala.user.fields.vpnLastActivityTime = vpnLastActivityTime
impala.user.fields.loginLastActivityTime = loginLastActivityTime
impala.user.fields.is_user_service_account = ${fortscale.tags.service}
impala.user.fields.is_user_administrator = ${fortscale.tags.admin}
impala.user.fields.is_user_executive = ${fortscale.tags.executive}

ldap.default_session_length_hours=10
vpn.default_session_length_hours=10
ssh.default_session_length_hours=10

vpn.geohopping.open.session.threshold.in.hours=6
vpn.geohopping.close.session.threshold.in.hours=1
vpn.sessionupdate.isAddSessionData=true
vpn.sessionupdate.isResolveIPForCiscoASA=false
vpn.sessionupdate.isdropCloseEventWhenOpenMissing=true
vpn.sessionupdate.resolveIPForCiscoASAFromInSec=30
vpn.sessionupdate.resolveIPForCiscoASAToInSec=120

###################################### CLASSIFIERS ###########################################################
login.service.name.regex=krbtgt
login.account.name.regex=.*[$].*


###################################### ENDPOINT CLASSIFIERS ##################################################
endpoint.desktop.name.regex=
endpoint.server.name.regex=
endpoint.desktop.os.regex=WINDOWS 8.*|WINDOWS 7.*|WINDOWS VISTA.*|MAC OS X
endpoint.server.os.regex=.*Server.*

endpoint.login.unknown.stale.threshold=7
endpoint.login.desktop.stale.threshold=60
endpoint.login.pattern.period=30

###################################### COMPUTER SERVICE ##################################################
computer.service.cache.max.items=10000
computer.service.cache.timeToExpireSec=0
computer.service.cache.updates.topic=computer-service-cache-updates

###################################### SENSITIVE MACHINE SERVICE ##################################################
sensitive-machine.service.cache.updates.topic=sensitive-machine-service-cache-updates


###################################### USERNAME SERVICE ##################################################
username.service.cache.updates.topic=username-service-cache-updates
samaccountname.service.samaccountname.cache.updates.topic=samaccountname-service-cache-updates
samaccountname.service.blacklist.timeToExpireSec=21600
samaccountname.service.blacklist.cache.max.items=30000

######################################
user.account.name=${user.account.name}

######################################################################################################
user.home.dir=${user.home.dir}
fortscale.home.dir=${user.home.dir}/fortscale


###################################### KAFKA STREAMING ################################################
kafka.vpn.struct.topic=fortscale-vpn-structured
kafka.ssh.struct.topic=fortscale-ssh-structured
kafka.4769.struct.topic=fortscale-4769-structured
kafka.4768.struct.topic=fortscale-4768-structured
kafka.generic.data.access.struct.topic=fortscale-generic-data-access-structured
kafka.entity.event.topic=fortscale-entity-event

kafka.broker.list=${kafka.broker.list}
#### Un-comment following lines to change from the default values
#kafka.requiredAcks=1
#kafka.producer.type=async
#kafka.serializer.class=kafka.serializer.DefaultEncoder
#kafka.partitioner.class=kafka.producer.DefaultPartitioner
#kafka.partitioner.retry.backoff.ms=10000

kafka.throttlingSleep=0


####################################### IP RESOLVING #####################################################

# determine which providers to use for ip resolving
ip2hostname.fileProvider.enabled=true
ip2hostname.loginProvider.enabled=true
ip2hostname.dhcpProvider.enabled=true
ip2hostname.iseProvider.enabled=true
ip2hostname.dnsProvider.enabled=true
ip2hostname.pxGridProvider.enabled=true

# regex pattern to have matching host names considered as unresolved
ip2hostname.hostnames.blacklist=localhost*|UNKNOWN-*

##### DNS resolver parameters  ######
# max queries to issue for dns per hour
dns.resolver.maxQueriesPerHour=1000
# timeout for accessing the dns server for queries
dns.resolver.timeoutInSeconds=1
# number of retries for accessing the dns server for queries
dns.resolver.retries=1
# dns servers, empty means default servers
dns.resolver.dnsServers=
# should we resolve past events
dns.resolver.skip.past.events=false
# how recent should the events be to be considered not in the past (value is in minutes)
dns.resolver.past.events.period.minutes:720
# max cache size for resolved ip addresses
dns.resolver.cache.size=100000
# time to keep records in dns resolving cache (after write), in seconds
dns.resolver.cache.timeToExpireSec=3600
# max cache size for blacklist entries (ip addresses without hostname resolution)
dns.resolver.blacklist.size=100000
# time to keep records in dns blacklsit cache (after write), in seconds
dns.resolver.blacklist.timeToExpireSec=3600
# determine if dns resolver will filter hostnames that starts with the ip address
dns.resolver.can.return.ipAddress=false

##### DHCP resolver parameters #####
dhcp.resolver.graceTimeInMins=1
dhcp.resolver.cache.max.items=30000
dhcp.resolver.cache.updates.topic=dhcp-resolver-cache

##### ISE resolver parameters #####
ise.resolver.graceTimeInMins=1
ise.resolver.cache.max.items=30000
ise.resolver.cache.updates.topic=ise-resolver-cache
ise.resolver.blacklist.timeToExpireSec=3600
ise.resolver.shouldUseBlackList=true

##### PxGrid resolver parameters #####
pxgrid.resolver.leaseTimeInMins=600
pxgrid.resolver.cache.max.items=30000
pxgrid.resolver.cache.updates.topic=pxgrid-resolver-cache
pxgrid.resolver.blacklist.timeToExpireSec=3600
pxgrid.resolver.shouldUseBlackList=true

##### Active directory groups resolver parameters #####
adgroups.resolver.cache.max.items=30000
adgroups.resolver.blacklist.timeToExpireSec=3600

##### Security Events resolver parameters #####
computer.login.resolver.leaseTimeInMins=600
computer.login.resolver.graceTimeInSec=5
computer.login.resolver.cache.max.items=30000
computer.login.resolver.ipToHostNameUpdateResolutionInMins=60
computer.login.resolver.is.use.cache.for.resolving=true
computer.login.resolver.cache.updates.topic=login-resolver-cache


###################################################################################################
group.membership.score.page.size=10000
users.page.size=10000
########################################### USERS LISTS ########################################################
user.list.custom_tags.path=resources/lists/customTags.csv
user.list.custom_tags.max.length=100
user.list.custom_tags.deletion_symbol=-
user.list.service_account.path=resources/lists/serviceAccount.txt
user.list.service_account.deletion_symbol=-
user.list.admin_groups.path=resources/lists/adminGroups.txt
user.list.executive_groups.path=resources/lists/executiveGroups.txt
user.list.service_sensitive_machine.path=resources/lists/sensitiveMachine.txt
user.list.service_sensitive_machine.deletion_symbol=-
########################################### USERNAME NORMALIZER ########################################################
collection.sec.etl.username.normalize.matchers=([\\S]+)@([^ \t\n\\x0B\f\r\\.]+)\\.([^ \t\n\\x0B\f\r\\.]+)# # #$1@$2.$3#####([\\S]+)@[^ \t\n\\x0B\f\r]+\\.([^ \t\n\\x0B\f\r\\.]+)\\.([^ \t\n\\x0B\f\r\\.]+)# # #$1@$2.$3#####((\\S+)@(\\S+))# # #$1@$2
collection.vpn.etl.username.normalize.matchers=
collection.ssh.etl.username.normalize.matchers=


################################### Morphline Command flags ###########################################
mophline.cmd.overflow=false
morphline.timezone= { "defaultTimezone" : "UTC" }

################################### GoeLocation data file ###################################
ip.to.location.db.full.path=data/geoip/iptolocationdata.bin
ip.to.location.license.key.full.path=data/geoip/license.key

################################### Fetch + ETL parameters ###################################
fetch.data.cycle.in.seconds=0

################################## Splunk Configuration #####################################
splunk.getSECdata.savedQuery=index="win_evt" source="wineventlog:security" (EventCode="4769" OR EventCode="4768" OR EventCode="4771") earliest=$args.earliest$ latest=$args.latest$ | sort 0 _time | table _time _raw
splunk.getSECdata.returnKeys=_time,_raw
splunk.getSEC4624data.savedQuery=index="win_evt" source="wineventlog:security" (EventCode=4624 AND Account_Name=*$*) earliest=$args.earliest$ latest=$args.latest$ | table _time Account_Name Source_Network_Address
splunk.getSEC4624data.returnKeys=_time,Account_Name,Source_Network_Address
splunk.getDHCPdata.savedQuery=index="win_dhcp" sourcetype=DhcpSrvLog (action=Renew OR action="DNS Update Successful" OR action=Assign) earliest=$args.earliest$ latest=$args.latest$ | sort 0 _time | table _time _raw
splunk.getDHCPdata.returnKeys=_time,action,ip,hn,mac,exp
splunk.getWAMEGroupdata.savedQuery=index="win_evt" earliest=$args.earliest$ latest=$args.latest$ (EventCode=4728 OR EventCode=4732 OR EventCode=4756) | eval Subject_Account_Name=mvindex(Account_Name, 0) |  eval Subject_Account_Domain=mvindex(Account_Domain, 0) | eval Member_Security_ID=mvindex(Security_ID, 1)  | eval Member_Account_Name=mvindex(Account_Name, 1)|eval Group_Account_Name=mvindex(Account_Name, 2) |eval Group_Account_Domain=mvindex(Account_Domain, 1) | eval Piped_Member_Account_Name= replace(Member_Account_Name , ",","|")  |search Subject_Account_Name!=*$ | search Member_Security_ID!=*$ | Table _time EventCode Subject_Account_Domain Subject_Account_Name Member_Security_ID ComputerName Piped_Member_Account_Name Group_Name Group_Domain Group_Account_Name Group_Account_Domain
splunk.getWAMEGroupdata.returnKeys=_time,EventCode,Subject_Account_Domain,Subject_Account_Name,Member_Security_ID,ComputerName,Piped_Member_Account_Name,Group_Name,Group_Domain,Group_Account_Name,Group_Account_Domain
splunk.getISEdata.savedQuery=index="ise" earliest=$args.earliest$ latest=$args.latest$ (3000 OR 3001 OR 3002) "host-name" "Framed-IP-Address" | rex "^(?<ise_time>[^ ]+) .+ (?<ise_eventcode>(3000|3001|3002)) NOTICE .+host-name=(?<ise_hostname>[^ ,]+), .+" | sort 0 _time | table _time ise_time ise_eventcode ise_hostname Framed_IP_Address Called_Station_ID
splunk.getISEdata.returnKeys=_time,ise_time,ise_eventcode,ise_hostname,Framed_IP_Address,Called_Station_ID
splunk.getNTLMdata.savedQuery=index="win_evt" source="wineventlog:security" EventCode=4776 earliest=$args.earliest$ latest=$args.latest$ | sort 0 _time | table _time Logon_Account Error_Code Source_Workstation ComputerName
splunk.getNTLMdata.returnKeys=_time,Logon_Account,Error_Code,Source_Workstation,ComputerName
splunk.getPRNLOGdata.savedQuery=index="main" earliest=$args.earliest$ latest=$args.latest$ | table _time operation type printer machine user document notify_name JobId data_type print_processor parameters driver_name status priority total_pages size_bytes submitted_time page_printed | sort 0 _time | table _time _raw
splunk.getPRNLOGdata.returnKeys=_raw
splunk.getSSHdata.savedQuery=index="fs_ssh" process=sshd (Accepted OR "Failed password") earliest=$args.earliest$ latest=$args.latest$ | sort 0 _time | table _time _raw
splunk.getSSHdata.returnKeys=_raw
splunk.getWAMEdata.savedQuery=index="win_evt" earliest=$args.earliest$ latest=$args.latest$ (EventCode=4722 OR EventCode=4723 OR EventCode=4724 OR EventCode=4767) | eval Subject_Account_Name=mvindex(Account_Name, 0) | eval Target_Account_Name=mvindex(Account_Name, 1) | eval Subject_Account_Domain=mvindex(Account_Domain, 0) | eval Target_Account_Domain=mvindex(Account_Domain, 1) | search Subject_Account_Name!=*$ | search Account_Name!=*$ | Table _time EventCode Subject_Account_Domain Subject_Account_Name Target_Account_Domain Target_Account_Name ComputerName | sort 0 _time
splunk.getWAMEdata.returnKeys=_time,EventCode,Subject_Account_Domain,Subject_Account_Name,Target_Account_Domain,Target_Account_Name,ComputerName
splunk.getVPNdata.savedQuery=index="fs_vpn" ovpn earliest=$args.earliest$ latest=$args.latest$ | sort 0 _time | table _time,_raw
splunk.getVPNdata.returnKeys=_raw

################################## QRadar Configuration #####################################
qradar.getSECdata.savedQuery=select StartTime,%s from events where (EventID=4769 or EventID=4768 or EventID=4771) order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getSECdata.returnKeys=utf8(payload)
qradar.getSEC4624data.savedQuery=select StartTime,%s from events where EventID=4624 order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getSEC4624data.returnKeys=utf8(payload)
qradar.getDHCPdata.savedQuery=select StartTime,%s from events where TEXT SEARCH 'dhcpd' order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getDHCPdata.returnKeys=utf8(payload)
qradar.getWAMEGroupdata.savedQuery=select StartTime,%s from events where (EventID=4728 or EventID=4732 or EventID=4756) order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getWAMEGroupdata.returnKeys=utf8(payload)
qradar.getISEdata.savedQuery=select StartTime,%s from events where (EventID=3000 or EventID=3001 or EventID=3002) order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getISEdata.returnKeys=utf8(payload)
qradar.getNTLMdata.savedQuery=select StartTime,%s from events where EventID=4776 order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getNTLMdata.returnKeys=utf8(payload)
qradar.getPRNLOGdata.savedQuery=select StartTime,%s from events where TEXT SEARCH 'printer' order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getPRNLOGdata.returnKeys=utf8(payload)
qradar.getSSHdata.savedQuery=select StartTime,%s from events where QIDNAME(qid)='Accepted Public Key' or QIDNAME(qid)='Accepted Password for User' or QIDNAME(qid)='Root Login' or QIDNAME(qid)='Root Login Failed' or QIDNAME(qid)='User failed to login to SSH, incorrect password' order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getSSHdata.returnKeys=utf8(payload)
qradar.getWAMEdata.savedQuery=select StartTime,%s from events where (EventID=4722 or EventID=4723 or EventID=4724 or EventID=4767) order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getWAMEdata.returnKeys=utf8(payload)
qradar.getVPNdata.savedQuery=select StartTime,%s from events where QIDNAME(qid)='Unexpected behavior' or QIDNAME(qid)='Remote peer has failed user authentication' or QIDNAME(qid)='Authentication: rejected' or QIDNAME(qid)='New SVC connection replacing old connection' or QIDNAME(qid)='Session disconnected' or QIDNAME(qid)='AAA unable to complete the request' or QIDNAME(qid)='AAA user authentication Rejected' or QIDNAME(qid)='Address assigned to session' or QIDNAME(qid)='IP ip WebVPN session terminated: User requested' or QIDNAME(qid)='System Information' or QIDNAME(qid)='Tunnel group search using certificate maps failed' order by StartTime asc START \'%s\' STOP\'%s\'
qradar.getVPNdata.returnKeys=utf8(payload)

################################### DHCP fetch from splunk parameters ###################################
dhcp.encloseQuotes=false

################################## NTLM fetch from splunk params #########################################
ntlm.encloseQuotes=false

################################### ISE ######################################
ise.encloseQuotes=false

########################################### GWAME #############################################################
gwame.encloseQuotes=false
gwame.morphline=file:resources/conf-files/parseGWAME.conf

########################################### WAME #############################################################
wame.encloseQuotes=false
wame.morphline=file:resources/conf-files/parseWAME.conf

########################################### PxGrid ########################################################

# config for cisco's pxGrid
pxgrid.morphline=file:resources/conf-files/ipresolving/parsePxGrid.conf
pxgrid.keystorePath=resources/certificates/pxGrid/self1.jks
pxgrid.truststorePath=resources/certificates/pxGrid/rootSample.jks
pxgrid.hosts=fs-ise-02.fortscale.dom
pxgrid.userName=Fortscale-client
pxgrid.group=ANC
pxgrid.keystorePassphrase=cisco123
pxgrid.truststorePassphrase=cisco123
pxgrid.numberOfRetries=6000

############ Active Directory connections file path ####################

############### Aggregation Framework ###############
fortscale.aggregation.feature.bucket.strategy.conf.json.file.name=classpath:config/asl/aggregation_framework_strategies.json
fortscale.aggregation.bucket.conf.json.file.name=classpath:config/asl/buckets.json
fortscale.aggregation.bucket.conf.json.overriding.files.path=file:${fortscale.home.dir}/config/asl/buckets/overriding/*.json
fortscale.aggregation.bucket.conf.json.additional.files.path=file:${fortscale.home.dir}/config/asl/buckets/additional/*.json
fortscale.aggregation.sync.timer.cycle.length.in.seconds=60
fortscale.aggregation.sync.timer.waiting.time.before.notification=900
fortscale.aggregation.feature.bucket.store.sync.page.size=100
fortscale.aggregation.sync.shouldUpdateFeatureBucketAfterSync=false
fortscale.aggregation.on.init.delete.all.feature.bucket.metadata=true

fortscale.aggregation.retention.strategy.conf.json.file.name=classpath:config/asl/retention_strategies.json
fortscale.aggregation.retention.strategy.conf.json.overriding.files.path=file:${fortscale.home.dir}/config/asl/retention_strategy/overriding/*.json
fortscale.aggregation.retention.strategy.conf.json.additional.files.path=file:${fortscale.home.dir}/config/asl/retention_strategy/additional/*.json

fortscale.aggregation.feature.event.conf.json.file.name=classpath:config/asl/aggregated_feature_events.json
fortscale.aggregation.feature.event.conf.json.overriding.files.path=file:${fortscale.home.dir}/config/asl/aggregation_events/overriding/*.json
fortscale.aggregation.feature.event.conf.json.additional.files.path=file:${fortscale.home.dir}/config/asl/aggregation_events/additional/*.json

fortscale.aggregation.event_topology_service.event_topology_json=config/topology/aggregation_events_topology.json


fortscale.aggregation.feature.bucket.keyvaluedb.retention.in.event.seconds=28800
fortscale.aggregation.feature.bucket.keyvaluedb.retention.in.system.seconds=3600
fortscale.aggregation.feature.bucket.keyvaluedb.retention.window.in.system.seconds=3600
fortscale.aggregation.feature.bucket.store.sync.threshold.in.event.seconds=0
fortscale.aggregation.feature.bucket.store.sync.window.in.system.seconds=900

fortscale.common.feature.extraction.feature_extract_service.feature_conf_json=classpath:config/asl/FeatureExtractors.json
fortscale.aggregation.events.counter.name.suffix=.counter

fortscale.samza.aggregation.events.streaming.metrics.task=aggregation-events-streaming
fortscale.samza.aggregation.events.streaming.metrics.class=fortscale.streaming.task.AggregationEventsStreamTask
fortscale.samza.aggregation.events.streaming.metrics.processed.message.count=aggregation-message-count
fortscale.samza.aggregation.events.streaming.metrics.skipped.message.count=aggregation-skipped-count
fortscale.samza.aggregation.events.streaming.metrics.last.message.epochtime=aggregation-events-streaming-last-message-epochtime
fortscale.samza.aggregation.prevalence.stats.metrics.task=fortscale-aggr-feature-events-prevalence-stats
fortscale.samza.aggregation.prevalence.stats.metrics.class=fortscale.streaming.service.AggregatedFeatureAndEntityEventsMetricsService

fortscale.scored.aggregation.store.page.size=200000
fortscale.store.collection.backup.prefix=a_

fortscale.aggregation.batch.bucket.retrieving.page.size=100000
fortscale.aggregation.batch.feature.event.to.send.save.page.size=10000
fortscale.aggregation.batch.feature.event.to.send.retrieving.page.size=400000

fortscale.aggregation.control.topic=fortscale-aggregation-events-control

############### Entity Events ###############
fortscale.entity.event.global.params.json.file.path=classpath:config/asl/entity_events_global_params.json
fortscale.entity.event.global.params.conf.json.overriding.files.path=file:${fortscale.home.dir}/config/asl/entity_events/overriding/global_params*.json
fortscale.entity.event.definitions.json.file.path=classpath:config/asl/entity_events.json
fortscale.entity.event.definitions.conf.json.overriding.files.path=file:${fortscale.home.dir}/config/asl/entity_events/overriding/entity_events*.json
fortscale.entity.event.retrieving.page.size=200000
fortscale.entity.event.store.page.size=1000

fortscale.scored.entity.event.store.page.size=10000

############### SMART Alert Creation ###############
# general evidence creation setting
fortscale.smart.f.score = 10
fortscale.smart.p.count = 0
# key value map between the input message and it's values
fortscale.smart.f.field.startdate = start_time_unix
fortscale.smart.f.field.enddate = end_time_unix
fortscale.smart.f.field.featurename = aggregated_feature_name
fortscale.smart.f.field.datasources = data_sources
fortscale.smart.f.field.score = score
fortscale.smart.f.field.featurescores = feature_scores
fortscale.smart.f.field.entities = context
fortscale.smart.f.field.anomalyvalue = aggregated_feature_value

############## Notifications Framework #############
collection.evidence.notification.fetch.type=notification
collection.evidence.notification.topic=fortscale-notification-event-score
collection.evidence.notification.score.field=notification_score
collection.evidence.notification.type.field=notification_type
collection.evidence.notification.value.field=notification_value
collection.evidence.notification.starttimestamp.field=date_time_unix_start
collection.evidence.notification.endtimestamp.field=date_time_unix_end
collection.evidence.notification.normalizedusername.field=normalized_username
collection.evidence.notification.supportinginformation.field=supportingInformation
collection.evidence.notification.datasource.field=data_source
collection.evidence.notification.numofevents.field=notification_num_of_events
collection.evidence.notification.score=50
#TODO - take evidence out of ignore once its ready for use
collection.evidence.notification.ignore=score_shot_up_message,score_shot_up_for_highscore_entity,admin_group_removed,has_new_admin_group,user_was_deleted,about_to_expire_week,about_to_expire_day,user_was_enabled,user_was_disabled

############## Tag evidence #############
collection.evidence.tag.score=50

############### Supporting Information ###############
evidence.supporting.information.time.period.in.days=90


############### BDP Run Information ##################
fortscale.bdp.run=false

############# Cloudera Manager Configuration #########
cloudera_manager_host=localhost
cm_user=admin
cm_pass=admin
cm_cluster_name=Cluster 1
cm_role_start_timeout_after = PT3M
cm_role_stop_timeout_after = PT3M
cm_role_check_role_status_window_duration=PT5S

################ Kafka Configuration #############
zookeeper.connection=${zookeeper.host}:${zookepeer.port}
broker.list=${kafka.broker.list}
zookeeper.timeout=5000
kafka.data.folder=/var/local/kafka/data

#################### Accumulator Configuration ####################
fortscale.accumulator.entity.event.from.period.ago.daily=P3M
fortscale.accumulator.entity.event.from.period.ago.hourly=P1M
fortscale.accumulator.entity.event.retention.daily=P3M
fortscale.accumulator.entity.event.retention.hourly=P1M
fortscale.accumulator.aggr.feature.event.from.period.ago.daily=P3M
fortscale.accumulator.aggr.feature.event.from.period.ago.hourly=P1M
fortscale.accumulator.aggr.feature.event.retention.daily=P3M
fortscale.accumulator.aggr.feature.event.retention.hourly=P1M

#################### Model Building Configuration ####################
fortscale.model.configurations.location.path=classpath:config/asl/models/*.json
fortscale.model.configurations.overriding.location.path=file:${fortscale.home.dir}/config/asl/models/overriding/*.json
fortscale.model.configurations.additional.location.path=file:${fortscale.home.dir}/config/asl/models/additional/*.json
fortscale.model.wait.sec.between.loads=3600
fortscale.model.max.sec.futureDiffBetweenModelAndEvent=2592000
fortscale.model.max.sec.diff.before.outdated=86400
fortscale.model.max.sec.diff.before.expired=15552000
fortscale.model.wait.sec.between.last.usage.epochtime.updates=86400
fortscale.model.max.sec.diff.before.cleaning.cache=604800
fortscale.model.sec.diff.between.cleaning.cache.checks=604800

#################### Model Building Streaming ####################
fortscale.model.build.control.input.topic=fortscale-model-building-control-input
fortscale.model.build.control.output.topic=fortscale-model-building-control-output
fortscale.model.build.entityEvents.control.input.topic=fortscale-entity-events-model-building-control-input
fortscale.model.build.entityEvents.control.output.topic=fortscale-entity-events-model-building-control-output
fortscale.model.build.control.output.topics=${fortscale.model.build.entityEvents.control.output.topic},${fortscale.model.build.control.output.topic}
fortscale.model.build.message.field.select.high.score.contexts=selectHighScoreContexts
fortscale.model.build.message.field.specified.context.ids=specifiedContextIds
fortscale.model.build.message.constant.all.models=ALL_MODELS
fortscale.model.build.retention.time.in.days=180
fortscale.model.build.selector.delta.in.seconds=604800

#################### Jade Configuration ##########################
jade.resources.folder=fortscale/fortscale-core/fortscale/fortscale-collection/target/resources/dynamic-html

# Fortscale date format service
fortscale.date.formats.app.config.key=fortscale.date.formats
optimize.date.format.auto.pattern.matching=false

#################### Event Topology ##########################
fortscale.streaming.topology.event_topology_json=config/topology/events_topology.json

#################### Event Structure ##########################
fortscale.event.context.json.prefix=context

################## Event Forwarding Configuration #############
destination.syslog.server.host=integ-splunk-07
destination.syslog.server.port=2514
destination.syslog.server.protocol=tcp
destination.syslog.server.appName=Fortscale
destination.syslog.server.use.ssl=false

################ Properties From Streaming Overriding #########
#VpnIpsPoolTopic
vpn.ip.pool.topic.name=fortscale-vpn-ip-pool
#Geo Ip properties
geo.ip.providers.service.bean=fortscaleGeoIpService,ipToLocationGeoIPService
##this will sign the maximum of distinct source that account can have so he still be fix source
FixSource.max.source.count.Threshold = 10
##this will sign the minimal days number of event accumulation so it can be tag
FixSource.min.daysBack.toWatch= 7
##this will sign the minimal days number of event accumulation so it can be tag
ServerDesktop.min.daysBack.toWatch=7
##this will sign the rate threshold that tag need(Server or Desktop) from the destination list to be tagging
ServerDesktop.rate.threshold=0.9
##this will sign how much days back to count for distinct destinations
sweeper.daysBack.toWatch = 7
##this will sign the minimal number of distinct destinations that account need  to be tagged as Sweeper
sweeper.min.destinations.count.threshold=200

################ User Activity Properties #########
user.activity.num.of.last.days.to.calculate=90
