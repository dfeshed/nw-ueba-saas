######################################### Access Event base entity ###########################################

entities.access_event.name = Access Event
entities.access_event.performance_field = event_score
entities.access_event.performance_field_min_value = 50
entities.access_event.fields = username, normalized_username, source_ip, source_machine, status, event_time, event_time_score, event_score, is_user_administrator, is_user_executive

entities.access_event.field.username.name = Username
entities.access_event.field.username.type = STRING

entities.access_event.field.normalized_username.name = Normalized Username
entities.access_event.field.normalized_username.type = STRING

entities.access_event.field.source_machine.name = Source Computer Name
entities.access_event.field.source_machine.type = STRING
entities.access_event.field.source_machine.score = source_machine_score

entities.access_event.field.source_ip.name = Source IP
entities.access_event.field.source_ip.type = STRING

entities.access_event.field.status.name = Status
entities.access_event.field.status.type = STRING

entities.access_event.field.event_time.name = Event Time
entities.access_event.field.event_time.type = DATE
entities.access_event.field.event_time.score = event_time_score

entities.access_event.field.event_time_utc.name = Event Time (UTC)
entities.access_event.field.event_time_utc.type = NUMBER

entities.access_event.field.event_time_score.name = Event Time Score
entities.access_event.field.event_time_score.type = NUMBER

entities.access_event.field.event_score.name = Event Score
entities.access_event.field.event_score.type = NUMBER

entities.access_event.field.is_user_administrator.name = Administrator User
entities.access_event.field.is_user_administrator.type = BOOLEAN

entities.access_event.field.is_user_executive.name = Executive User
entities.access_event.field.is_user_executive.type = BOOLEAN

######################################### Auth Event base entity ###########################################

entities.auth_event.name = Auth Event
entities.auth_event.extends = access_event
entities.auth_event.fields = source_machine_score, destination_machine, destination_machine_score, is_from_vpn, is_sensitive_machine, is_user_service

entities.access_event.field.source_machine_score.name = Source Computer Score
entities.access_event.field.source_machine_score.type = NUMBER

entities.auth_event.field.destination_machine.name = Destination Computer Name
entities.auth_event.field.destination_machine.type = STRING
entities.auth_event.field.destination_machine.score = destination_machine_score

entities.auth_event.field.destination_machine_score.name = Destination Computer Score
entities.auth_event.field.destination_machine_score.type = NUMBER

entities.auth_event.field.is_sensitive_machine.name = Is Sensitive Computer
entities.auth_event.field.is_sensitive_machine.type = BOOLEAN

entities.auth_event.field.is_from_vpn.name = Is From VPN
entities.auth_event.field.is_from_vpn.type = BOOLEAN

entities.auth_event.field.is_user_service.name = Service Account
entities.auth_event.field.is_user_service.type = BOOLEAN


######################################### Kerberos Logins ###########################################

entities.kerberos_logins.id = kerberos_logins
entities.kerberos_logins.name = Kerberos Logins
entities.kerberos_logins.extends = auth_event
entities.kerberos_logins.db = MySQL
entities.kerberos_logins.table = ${impala.score.ldapauth.table.name}
entities.kerberos_logins.partitions = event_time daily
entities.kerberos_logins.performance_table = ${impala.score.ldapauth_top.table.name}

################### Kerberos Logins fields ###################

entities.kerberos_logins.fields = source_machine_type, destination_machine_type, failure_code

entities.kerberos_logins.field.username.column = ${impala.score.ldapauth.table.fields.account_name}
entities.kerberos_logins.field.normalized_username.column = ${impala.score.ldapauth.table.fields.normalized_username}
entities.kerberos_logins.field.source_machine.column = ${impala.score.ldapauth.table.fields.machine_name}
entities.kerberos_logins.field.source_machine_score.column = ${impala.score.ldapauth.table.fields.hostnameScore}
entities.kerberos_logins.field.source_ip.column = ${impala.score.ldapauth.table.fields.client_address}
entities.kerberos_logins.field.destination_machine.column = ${impala.score.ldapauth.table.fields.service_name}
entities.kerberos_logins.field.destination_machine_score.column = ${impala.score.ldapauth.table.fields.destScore}
entities.kerberos_logins.field.status.column = if (${impala.score.ldapauth.table.fields.failure_code}='0x0', 'Success', 'Failure')
entities.kerberos_logins.field.event_time.column = ${impala.score.ldapauth.table.fields.timeGenerated}
entities.kerberos_logins.field.event_time_utc.column = ${impala.score.ldapauth.table.fields.date_time_unix}
entities.kerberos_logins.field.event_time_score.column = ${impala.score.ldapauth.table.fields.date_timeScore}
entities.kerberos_logins.field.event_score.column = ${impala.score.ldapauth.table.fields.eventscore}
entities.kerberos_logins.field.is_sensitive_machine.column = ${impala.score.ldapauth.table.fields.is_sensitive_machine}
entities.kerberos_logins.field.is_from_vpn.column = ${impala.score.ldapauth.table.fields.is_nat}
entities.kerberos_logins.field.is_user_administrator.column = ${impala.score.ldapauth.table.fields.isUserAdministrator}
entities.kerberos_logins.field.is_user_executive.column = ${impala.score.ldapauth.table.fields.isUserExecutive}
entities.kerberos_logins.field.is_user_service.column = ${impala.score.ldapauth.table.fields.isUserServiceAccount}

entities.kerberos_logins.field.source_machine_type.name = Source Computer Type
entities.kerberos_logins.field.source_machine_type.type = STRING
entities.kerberos_logins.field.source_machine_type.column = ${impala.score.ldapauth.table.fields.src_class}

entities.auth_event.field.destination_machine_type.name = Destination Computer Type
entities.auth_event.field.destination_machine_type.type = STRING
entities.kerberos_logins.field.destination_machine_type.column = ${impala.score.ldapauth.table.fields.dst_class}

entities.kerberos_logins.field.failure_code.name = Error Code
entities.kerberos_logins.field.failure_code.column = ${impala.score.ldapauth.table.fields.failure_code}
entities.kerberos_logins.field.failure_code.type = STRING

######################################### SSH ###########################################

entities.ssh.id = ssh
entities.ssh.name = SSH
entities.ssh.extends = auth_event
entities.ssh.db = MySQL
entities.ssh.table = ${impala.score.ssh.table.name}
entities.ssh.partitions = event_time daily
entities.ssh.performance_table = ${impala.score.ssh_top.table.name}

################### SSH fields ###################

entities.ssh.fields = auth_method, auth_method_score

entities.ssh.field.username.column = ${impala.score.ssh.table.field.username}
entities.ssh.field.normalized_username.column = ${impala.score.ssh.table.fields.normalized_username}
entities.ssh.field.source_machine.column = ${impala.score.ssh.table.field.hostname}
entities.ssh.field.source_machine_score.column = ${impala.score.ssh.table.field.normalized_src_machine_score}
entities.ssh.field.source_ip.column = ${impala.score.ssh.table.fields.source_ip}
entities.ssh.field.destination_machine.column = ${impala.score.ssh.table.field.target_machine}
entities.ssh.field.destination_machine_score.column = ${impala.score.ssh.table.field.normalized_dst_machine_score}
entities.ssh.field.status.column = ${impala.score.ssh.table.fields.status}
entities.ssh.field.event_time.column = ${impala.score.ssh.table.fields.date_time}
entities.ssh.field.event_time_utc.column = ${impala.score.ssh.table.field.epochtime}
entities.ssh.field.event_time_score.column = ${impala.score.ssh.table.fields.date_time_score}
entities.ssh.field.event_score.column = ${impala.score.ssh.table.field.EventScore}
entities.ssh.field.is_sensitive_machine.column = ${impala.score.ssh.table.field.is_sensitive_machine}
entities.ssh.field.is_from_vpn.column = ${impala.score.ssh.table.field.is_nat}
entities.ssh.field.is_user_administrator.column = ${impala.score.ssh.table.fields.isUserAdministrator}
entities.ssh.field.is_user_executive.column = ${impala.score.ssh.table.fields.isUserExecutive}
entities.ssh.field.is_user_service.column = ${impala.score.ssh.table.fields.isUserServiceAccount}

entities.ssh.field.auth_method.name = Auth Method
entities.ssh.field.auth_method.column = ${impala.score.ssh.table.fields.auth_method}
entities.ssh.field.auth_method.type = STRING
entities.ssh.field.auth_method.score = auth_method_score

entities.ssh.field.auth_method_score.name = Auth Method Score
entities.ssh.field.auth_method_score.column = ${impala.score.ssh.table.fields.auth_method_score}
entities.ssh.field.auth_method_score.type = NUMBER


######################################### VPN ###########################################

entities.vpn.id = vpn
entities.vpn.name = VPN
entities.vpn.extends = access_event
entities.vpn.db = MySQL
entities.vpn.table = ${impala.score.vpn.table.name}
entities.vpn.partitions = event_time daily
entities.vpn.performance_table = ${impala.score.vpn_top.table.name}

################### VPN fields ###################

entities.vpn.fields = country, country_score, country_code, isp, region, city, local_ip

entities.vpn.field.username.column = ${impala.score.vpn.table.field.username}
entities.vpn.field.normalized_username.column = ${impala.score.vpn.table.field.normalized_username}
entities.vpn.field.source_machine.column = ${impala.score.vpn.table.field.hostname}
entities.vpn.field.source_machine_score.column = ${impala.score.vpn.table.field.hostname.score}
entities.vpn.field.source_ip.column = ${impala.score.vpn.table.field.source_ip}
entities.vpn.field.status.column = ${impala.score.vpn.table.field.status}
entities.vpn.field.event_time.column = ${impala.score.vpn.table.field.date_time}
entities.vpn.field.event_time_utc.column = ${impala.score.vpn.table.field.date_time_unix}
entities.vpn.field.event_time_score.column = ${impala.score.vpn.table.field.date_timeScore}
entities.vpn.field.event_score.column = ${impala.score.vpn.table.field.event.score}
entities.vpn.field.is_user_administrator.column = ${impala.score.vpn.table.field.is_administrator_account}
entities.vpn.field.is_user_executive.column = ${impala.score.vpn.table.field.is_executive_account}

entities.vpn.field.country.name = Country
entities.vpn.field.country.column = ${impala.score.vpn.table.field.country}
entities.vpn.field.country.type = STRING
entities.vpn.field.country.score = country_score

entities.vpn.field.country_score.name = Country Score
entities.vpn.field.country_score.column = ${impala.score.vpn.table.field.country.score}
entities.vpn.field.country_score.type = NUMBER

entities.vpn.field.country_code.name = Country Code
entities.vpn.field.country_code.column = ${impala.score.vpn.table.field.countrycode}
entities.vpn.field.country_code.type = STRING

entities.vpn.field.isp.name = ISP
entities.vpn.field.isp.column = ${impala.score.vpn.table.field.isp}
entities.vpn.field.isp.type = STRING

entities.vpn.field.region.name = Region
entities.vpn.field.region.column = ${impala.score.vpn.table.field.region}
entities.vpn.field.region.type = STRING

entities.vpn.field.city.name = City
entities.vpn.field.city.column = ${impala.score.vpn.table.field.city}
entities.vpn.field.city.type = STRING

entities.vpn.field.local_ip.name = Local IP
entities.vpn.field.local_ip.column = ${impala.score.vpn.table.field.local_ip}
entities.vpn.field.local_ip.type = STRING