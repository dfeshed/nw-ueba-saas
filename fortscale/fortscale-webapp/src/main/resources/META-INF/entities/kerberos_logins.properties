entities.kerberos_logins.id = kerberos_logins
entities.kerberos_logins.name = Kerberos Logins
entities.kerberos_logins.db = MySQL
entities.kerberos_logins.table = ${impala.score.ldapauth.table.name}
entities.kerberos_logins.partitions = event_time daily
entities.kerberos_logins.performance_table = ${impala.score.ldapauth_top.table.name}

######################################### Fields ###########################################

entities.kerberos_logins.field.username.name = AD Username
entities.kerberos_logins.field.username.column = ${impala.score.ldapauth.table.fields.account_name}
entities.kerberos_logins.field.username.type = STRING

entities.kerberos_logins.field.normalized_username.name = Username
entities.kerberos_logins.field.normalized_username.column = ${impala.score.ldapauth.table.fields.normalized_username}
entities.kerberos_logins.field.normalized_username.type = STRING

entities.kerberos_logins.field.source_machine.name = Source Computer Name
entities.kerberos_logins.field.source_machine.column = ${impala.score.ldapauth.table.fields.machine_name}
entities.kerberos_logins.field.source_machine.type = STRING
entities.kerberos_logins.field.source_machine.score_column = ${impala.score.ldapauth.table.fields.hostnameScore}

entities.kerberos_logins.field.source_ip.name = Source IP
entities.kerberos_logins.field.source_ip.column = ${impala.score.ldapauth.table.fields.client_address}
entities.kerberos_logins.field.source_ip.type = STRING

entities.kerberos_logins.field.source_machine_type.name = Source Computer Type
entities.kerberos_logins.field.source_machine_type.column = ${impala.score.ldapauth.table.fields.src_class}
entities.kerberos_logins.field.source_machine_type.type = STRING

entities.kerberos_logins.field.destination_machine.name = Destination Computer Name
entities.kerberos_logins.field.destination_machine.column = ${impala.score.ldapauth.table.fields.service_name}
entities.kerberos_logins.field.destination_machine.type = STRING
entities.kerberos_logins.field.destination_machine.score_column = ${impala.score.ldapauth.table.fields.destScore}

entities.kerberos_logins.field.destination_machine_type.name = Destination Computer Type
entities.kerberos_logins.field.destination_machine_type.column = ${impala.score.ldapauth.table.fields.dst_class}
entities.kerberos_logins.field.destination_machine_type.type = STRING

entities.kerberos_logins.field.failure_code.name = Error Code
entities.kerberos_logins.field.failure_code.column = ${impala.score.ldapauth.table.fields.failure_code}
entities.kerberos_logins.field.failure_code.type = STRING

entities.kerberos_logins.field.status.name = Error Code
entities.kerberos_logins.field.status.column = if (${impala.score.ldapauth.table.fields.failure_code}='0x0', 'Success', 'Failure')
entities.kerberos_logins.field.status.type = STRING

entities.kerberos_logins.field.event_time.name = Event Time
entities.kerberos_logins.field.event_time.column = ${impala.score.ldapauth.table.fields.timeGenerated}
entities.kerberos_logins.field.event_time.type = TIMESTAMP
entities.kerberos_logins.field.event_time.score_column = ${impala.score.ldapauth.table.fields.date_timeScore}

entities.kerberos_logins.field.event_score.name = Event Score
entities.kerberos_logins.field.event_score.column = ${impala.score.ldapauth.table.fields.eventscore}
entities.kerberos_logins.field.event_score.type = NUMBER

entities.kerberos_logins.field.is_sensitive_machine.name = Is Sensitive Computer
entities.kerberos_logins.field.is_sensitive_machine.column = ${impala.score.ldapauth.table.fields.is_sensitive_machine}
entities.kerberos_logins.field.is_sensitive_machine.type = BOOLEAN

entities.kerberos_logins.field.is_from_vpn.name = Is From VPN
entities.kerberos_logins.field.is_from_vpn.column = ${impala.score.ldapauth.table.fields.is_nat}
entities.kerberos_logins.field.is_from_vpn.type = BOOLEAN