######################################################################################################################
#In order to override fortscale\fortscale-services\src\main\resources\META-INF\entities.properties
#
#######################################################################################################################

leaf_entities =  dlpmail
base_entities = access_event, session, scored_access_event,  auth_event, users, active_directory, customized_auth_event

entities.users.fields = id, severity, followed, normalized_username, ad_usernames, kerberos_logins_usernames, ssh_usernames, vpn_usernames, display_name, job_title, employee_id, employee_number, dn, ou, account_expiration_date, last_change_date, creation_date, street_address, company, division, room_number, account_is_disabled, password_expired, no_password_required, password_never_expires, direct_reports_dn, groups_dn, department, email, phone, mobile, home_phone, manager_name, manager_username, manager_id, account_disabled_date, last_activity_date, ssh_last_activity_date, vpn_last_activity_date, kerberos_logins_last_activity_date



######################################### dlpmail ###########################################

entities.dlpmail.id = dlpmail
entities.dlpmail.name = dlpmail
entities.dlpmail.nameForMenu = Digital Guardian - Mail events
entities.dlpmail.is_abstract = false
entities.dlpmail.show_in_explore = true
entities.dlpmail.short_name = dlpmail
entities.dlpmail.extends = scored_access_event
entities.dlpmail.db = MySQL
entities.dlpmail.table = dlpmailscore
entities.dlpmail.performance_table = dlpmailscore_top
entities.dlpmail.partitions=daily
entities.dlpmail.partition.base.field = event_time_utc


############ Additional fields

entities.dlpmail.fields = account_user_id,application,application_score,destination_file,detail_file_size_kb,DNS_hostname,email_recipient,email_recipient_domain,email_recipient_type,email_sender,email_subject,has_alert_event,has_src_classification,is_outbound,is_removable,network_address,source_file,was_blocked_event,destination_file_type,source_file_type,was_rdp,admin_activity,registry_changed,detail_file_size_score ,email_sender_score ,event_description_score ,has_alert_event_score ,has_src_classification_score ,outbound_score ,removable_device_score  ,was_blocked_event_score ,destination_file_type_score ,source_file_type_score ,was_rdp_score ,admin_activity_score , registry_changed_score,display_name

entities.dlpmail.field.account_user_id.column=account_user_id
entities.dlpmail.field.account_user_id.name =  Account User ID
entities.dlpmail.field.account_user_id.type = STRING
entities.dlpmail.field.account_user_id.rank = 80
entities.dlpmail.field.account_user_id.lov = true
entities.dlpmail.field.account_user_id.attributes = internal
entities.dlpmail.field.account_user_id.enabledByDefault=false


entities.dlpmail.field.display_name.column=display_name
entities.dlpmail.field.display_name.name =  Display Name
entities.dlpmail.field.display_name.type = STRING
entities.dlpmail.field.display_name.rank = 1
entities.dlpmail.field.display_name.lov = true
#entities.dlpmail.field.display_name.enabledByDefault=false

entities.dlpmail.field.application.column=application
entities.dlpmail.field.application.name =  Application
entities.dlpmail.field.application.score = application_score
entities.dlpmail.field.application.type = STRING
entities.dlpmail.field.application.rank = 5
entities.dlpmail.field.application.lov = true


entities.dlpmail.field.destination_file.column=destination_file
entities.dlpmail.field.destination_file.name =  Destination File
entities.dlpmail.field.destination_file.type = STRING
entities.dlpmail.field.destination_file.rank = 8
entities.dlpmail.field.destination_file.lov = true
#entities.dlpmail.field.destination_file.enabledByDefault=false

entities.dlpmail.field.detail_file_size_kb.column=detail_file_size_kb
entities.dlpmail.field.detail_file_size_kb.name =  Detail File Size KB
entities.dlpmail.field.detail_file_size_kb.score = detail_file_size_score
entities.dlpmail.field.detail_file_size_kb.type = NUMBER
entities.dlpmail.field.detail_file_size_kb.rank = 190
entities.dlpmail.field.detail_file_size_kb.lov = true
entities.dlpmail.field.detail_file_size_kb.format = sizeBytes
entities.dlpmail.field.detail_file_size_kb.enabledByDefault=false

entities.dlpmail.field.DNS_hostname.column=DNS_hostname
entities.dlpmail.field.DNS_hostname.name =  DNS Hostname
entities.dlpmail.field.DNS_hostname.type = STRING
entities.dlpmail.field.DNS_hostname.rank = 200
entities.dlpmail.field.DNS_hostname.lov = true
#entities.dlpmail.field.DNS_hostname.attributes = internal
entities.dlpmail.field.DNS_hostname.enabledByDefault=false


entities.dlpmail.field.email_recipient.column=email_recipient
entities.dlpmail.field.email_recipient.name =  Email Recipient
entities.dlpmail.field.email_recipient.type = STRING
entities.dlpmail.field.email_recipient.rank = 10
entities.dlpmail.field.email_recipient.lov = true

entities.dlpmail.field.email_recipient_domain.column=email_recipient_domain
entities.dlpmail.field.email_recipient_domain.name =  Email Recipient Domain
entities.dlpmail.field.email_recipient_domain.type = STRING
entities.dlpmail.field.email_recipient_domain.rank = 250
entities.dlpmail.field.email_recipient_domain.lov = true
#entities.dlpmail.field.email_recipient_domain.attributes = internal
entities.dlpmail.field.email_recipient_domain.enabledByDefault=false

entities.dlpmail.field.email_recipient_type.column=email_recipient_type
entities.dlpmail.field.email_recipient_type.name =  Email Recipient Type
entities.dlpmail.field.email_recipient_type.type = STRING
entities.dlpmail.field.email_recipient_type.rank = 260
entities.dlpmail.field.email_recipient_type.lov = true
#entities.dlpmail.field.email_recipient_type.attributes = internal
entities.dlpmail.field.email_recipient_type.enabledByDefault=false

entities.dlpmail.field.email_sender.column=email_sender
entities.dlpmail.field.email_sender.name =  Email Sender
entities.dlpmail.field.email_sender.score = email_sender_score
entities.dlpmail.field.email_sender.type = STRING
entities.dlpmail.field.email_sender.rank = 9
entities.dlpmail.field.email_sender.lov = true

entities.dlpmail.field.email_subject.column=email_subject
entities.dlpmail.field.email_subject.name =  Email Subject
entities.dlpmail.field.email_subject.type = STRING
entities.dlpmail.field.email_subject.rank = 11
entities.dlpmail.field.email_subject.lov = true
#entities.dlpmail.field.email_subject.attributes = internal
entities.dlpmail.field.email_subject.enabledByDefault=false


entities.dlpmail.field.has_alert_event.column=has_alert_event
entities.dlpmail.field.has_alert_event.score = has_alert_event_score
entities.dlpmail.field.has_alert_event.name =  Has Alert
entities.dlpmail.field.has_alert_event.type = STRING
entities.dlpmail.field.has_alert_event.rank = 350
entities.dlpmail.field.has_alert_event.lov = true
entities.dlpmail.field.has_alert_event.enabledByDefault=false

entities.dlpmail.field.has_alert_event_detail.column=has_alert_event_detail
entities.dlpmail.field.has_alert_event_detail.name =  Has Alert Event Detail
entities.dlpmail.field.has_alert_event_detail.type = BOOLEAN
entities.dlpmail.field.has_alert_event_detail.rank = 360
entities.dlpmail.field.has_alert_event_detail.lov = true
entities.dlpmail.field.has_alert_event_detail.attributes = internal
entities.dlpmail.field.has_alert_event_detail.enabledByDefault=false

entities.dlpmail.field.has_src_classification.column=has_src_classification
entities.dlpmail.field.has_src_classification.name =  Has Src Classification
entities.dlpmail.field.has_src_classification.score = has_src_classification_score
entities.dlpmail.field.has_src_classification.type = STRING
entities.dlpmail.field.has_src_classification.rank = 370
entities.dlpmail.field.has_src_classification.lov = true
entities.dlpmail.field.has_src_classification.enabledByDefault=false

entities.dlpmail.field.is_outbound.column=is_outbound
entities.dlpmail.field.is_outbound.name =  Is Outbound
entities.dlpmail.field.is_outbound.score = outbound_score
entities.dlpmail.field.is_outbound.type = STRING
entities.dlpmail.field.is_outbound.rank = 380
entities.dlpmail.field.is_outbound.lov = true
entities.dlpmail.field.is_outbound.enabledByDefault=false

entities.dlpmail.field.is_removable.column=is_removable
entities.dlpmail.field.is_removable.name =  Is Removable
entities.dlpmail.field.is_removable.score = removable_device_score
entities.dlpmail.field.is_removable.type = STRING
entities.dlpmail.field.is_removable.rank = 390
entities.dlpmail.field.is_removable.lov = true
entities.dlpmail.field.is_removable.enabledByDefault=false

entities.dlpmail.field.network_address.column=network_address
entities.dlpmail.field.network_address.name =  Source IP
entities.dlpmail.field.network_address.type = STRING
entities.dlpmail.field.network_address.rank = 410
entities.dlpmail.field.network_address.lov = true
entities.dlpmail.field.network_address.enabledByDefault=false


entities.dlpmail.field.source_file.column=source_file
entities.dlpmail.field.source_file.name =  Source File
entities.dlpmail.field.source_file.type = STRING
entities.dlpmail.field.source_file.rank = 6
entities.dlpmail.field.source_file.lov = true
#entities.dlpmail.field.source_file.enabledByDefault=false

entities.dlpmail.field.was_blocked_event.column=was_blocked_event
entities.dlpmail.field.was_blocked_event.name =  Was Blocked
entities.dlpmail.field.was_blocked_event.score = was_blocked_event_score
entities.dlpmail.field.was_blocked_event.type = STRING
entities.dlpmail.field.was_blocked_event.rank = 530
entities.dlpmail.field.was_blocked_event.lov = true
entities.dlpmail.field.was_blocked_event.enabledByDefault=false


entities.dlpmail.field.destination_file_type.column=destination_file_type
entities.dlpmail.field.destination_file_type.name =  Destination File Type
entities.dlpmail.field.destination_file_type.score = destination_file_type_score
entities.dlpmail.field.destination_file_type.type = STRING
entities.dlpmail.field.destination_file_type.rank = 550
entities.dlpmail.field.destination_file_type.lov = true

entities.dlpmail.field.source_file_type.column=source_file_type
entities.dlpmail.field.source_file_type.name =  Source File Type
entities.dlpmail.field.source_file_type.score =  source_file_type_score
entities.dlpmail.field.source_file_type.type = STRING
entities.dlpmail.field.source_file_type.rank = 560
entities.dlpmail.field.source_file_type.lov = true

entities.dlpmail.field.was_rdp.column=was_rdp
entities.dlpmail.field.was_rdp.name =  RDP Session
entities.dlpmail.field.was_rdp.score = was_rdp_score
entities.dlpmail.field.was_rdp.type = BOOLEAN
entities.dlpmail.field.was_rdp.rank = 570
entities.dlpmail.field.was_rdp.lov = true
entities.dlpmail.field.was_rdp.enabledByDefault=false

entities.dlpmail.field.admin_activity.column=admin_activity
entities.dlpmail.field.admin_activity.name =  Admin Activity
entities.dlpmail.field.admin_activity.score = admin_activity_score
entities.dlpmail.field.admin_activity.type = BOOLEAN
entities.dlpmail.field.admin_activity.rank = 580
entities.dlpmail.field.admin_activity.lov = true
entities.dlpmail.field.admin_activity.enabledByDefault=false

entities.dlpmail.field.registry_changed.column=registry_changed
entities.dlpmail.field.registry_changed.name =  Registry Changed
entities.dlpmail.field.registry_changed.score = registry_changed_score
entities.dlpmail.field.registry_changed.type = BOOLEAN
entities.dlpmail.field.registry_changed.rank = 590
entities.dlpmail.field.registry_changed.lov = true
entities.dlpmail.field.registry_changed.enabledByDefault=false



### score fields
entities.dlpmail.field.application_score.column=application_score
entities.dlpmail.field.application_score.name =  Application Score
entities.dlpmail.field.application_score.type = NUMBER
entities.dlpmail.field.application_score.score =
entities.dlpmail.field.application_score.valueList =
entities.dlpmail.field.application_score.rank = 100
entities.dlpmail.field.application_score.lov = true
entities.dlpmail.field.application_score.enabledByDefault = false

entities.dlpmail.field.detail_file_size_score.column=detail_file_size_score
entities.dlpmail.field.detail_file_size_score.name =  Detail File Size Score
entities.dlpmail.field.detail_file_size_score.type = NUMBER
entities.dlpmail.field.detail_file_size_score.score =
entities.dlpmail.field.detail_file_size_score.valueList =
entities.dlpmail.field.detail_file_size_score.rank = 103
entities.dlpmail.field.detail_file_size_score.lov = true
entities.dlpmail.field.detail_file_size_score.enabledByDefault = false

entities.dlpmail.field.email_sender_score.column=email_sender_score
entities.dlpmail.field.email_sender_score.name =  Email Sender Score
entities.dlpmail.field.email_sender_score.type = NUMBER
entities.dlpmail.field.email_sender_score.score =
entities.dlpmail.field.email_sender_score.valueList =
entities.dlpmail.field.email_sender_score.rank = 104
entities.dlpmail.field.email_sender_score.lov = true
entities.dlpmail.field.email_sender_score.enabledByDefault = false

entities.dlpmail.field.has_alert_event_score.column=has_alert_event_score
entities.dlpmail.field.has_alert_event_score.name =  Has Alert Score
entities.dlpmail.field.has_alert_event_score.type = NUMBER
entities.dlpmail.field.has_alert_event_score.score =
entities.dlpmail.field.has_alert_event_score.valueList =
entities.dlpmail.field.has_alert_event_score.rank = 106
entities.dlpmail.field.has_alert_event_score.lov = true
entities.dlpmail.field.has_alert_event_score.enabledByDefault = false

entities.dlpmail.field.has_src_classification_score.column=has_src_classification_score
entities.dlpmail.field.has_src_classification_score.name =  Has Src Classification Score
entities.dlpmail.field.has_src_classification_score.type = NUMBER
entities.dlpmail.field.has_src_classification_score.score =
entities.dlpmail.field.has_src_classification_score.valueList =
entities.dlpmail.field.has_src_classification_score.rank = 107
entities.dlpmail.field.has_src_classification_score.lov = true
entities.dlpmail.field.has_src_classification_score.enabledByDefault = false

entities.dlpmail.field.outbound_score.column=outbound_score
entities.dlpmail.field.outbound_score.name =  Outbound Score
entities.dlpmail.field.outbound_score.type = NUMBER
entities.dlpmail.field.outbound_score.score =
entities.dlpmail.field.outbound_score.valueList =
entities.dlpmail.field.outbound_score.rank = 108
entities.dlpmail.field.outbound_score.lov = true
entities.dlpmail.field.outbound_score.enabledByDefault = false

entities.dlpmail.field.removable_device_score.column=removable_device_score
entities.dlpmail.field.removable_device_score.name =  Removable Device Score
entities.dlpmail.field.removable_device_score.type = NUMBER
entities.dlpmail.field.removable_device_score.score =
entities.dlpmail.field.removable_device_score.valueList =
entities.dlpmail.field.removable_device_score.rank = 109
entities.dlpmail.field.removable_device_score.lov = true
entities.dlpmail.field.removable_device_score.enabledByDefault = false

entities.dlpmail.field.was_blocked_event_score.column=was_blocked_event_score
entities.dlpmail.field.was_blocked_event_score.name =  Was Blocked Score
entities.dlpmail.field.was_blocked_event_score.type = NUMBER
entities.dlpmail.field.was_blocked_event_score.score =
entities.dlpmail.field.was_blocked_event_score.valueList =
entities.dlpmail.field.was_blocked_event_score.rank = 111
entities.dlpmail.field.was_blocked_event_score.lov = true
entities.dlpmail.field.was_blocked_event_score.enabledByDefault = false

entities.dlpmail.field.destination_file_type_score.column=destination_file_type_score
entities.dlpmail.field.destination_file_type_score.name =  Destination File Type Score
entities.dlpmail.field.destination_file_type_score.type = NUMBER
entities.dlpmail.field.destination_file_type_score.score =
entities.dlpmail.field.destination_file_type_score.valueList =
entities.dlpmail.field.destination_file_type_score.rank = 112
entities.dlpmail.field.destination_file_type_score.lov = true
entities.dlpmail.field.destination_file_type_score.enabledByDefault = false

entities.dlpmail.field.source_file_type_score.column=source_file_type_score
entities.dlpmail.field.source_file_type_score.name = Source File Type Score
entities.dlpmail.field.source_file_type_score.type = NUMBER
entities.dlpmail.field.source_file_type_score.score =
entities.dlpmail.field.source_file_type_score.valueList =
entities.dlpmail.field.source_file_type_score.rank = 113
entities.dlpmail.field.source_file_type_score.lov = true
entities.dlpmail.field.source_file_type_score.enabledByDefault = false

entities.dlpmail.field.was_rdp_score.column=was_rdp_score
entities.dlpmail.field.was_rdp_score.name = RDP Session Score
entities.dlpmail.field.was_rdp_score.type = NUMBER
entities.dlpmail.field.was_rdp_score.score =
entities.dlpmail.field.was_rdp_score.valueList =
entities.dlpmail.field.was_rdp_score.rank = 114
entities.dlpmail.field.was_rdp_score.lov = true
entities.dlpmail.field.was_rdp_score.enabledByDefault = false

entities.dlpmail.field.admin_activity_score.column=admin_activity_score
entities.dlpmail.field.admin_activity_score.name = Admin Activity Score
entities.dlpmail.field.admin_activity_score.type = NUMBER
entities.dlpmail.field.admin_activity_score.score =
entities.dlpmail.field.admin_activity_score.valueList =
entities.dlpmail.field.admin_activity_score.rank = 115
entities.dlpmail.field.admin_activity_score.lov = true
entities.dlpmail.field.admin_activity_score.enabledByDefault = false

entities.dlpmail.field.registry_changed_score.column=registry_changed_score
entities.dlpmail.field.registry_changed_score.name = Registry Changed Score
entities.dlpmail.field.registry_changed_score.type = NUMBER
entities.dlpmail.field.registry_changed_score.score =
entities.dlpmail.field.registry_changed_score.valueList =
entities.dlpmail.field.registry_changed_score.rank = 116
entities.dlpmail.field.registry_changed_score.lov = true
entities.dlpmail.field.registry_changed_score.enabledByDefault = false



####### Actual schema definition (logical to phisical mapping)
entities.dlpmail.field.type.column = "dlpmail"
entities.dlpmail.field.username.column = account_name
entities.dlpmail.field.normalized_username.column = normalized_username
entities.dlpmail.field.source_ip.column = network_address
entities.dlpmail.field.source_machine.column = computer_name
entities.dlpmail.field.normalized_src_machine.column = normalized_src_machine
entities.dlpmail.field.status.column =  'Success'
entities.dlpmail.field.event_time.column = date_time
entities.dlpmail.field.event_time.rank = 1
entities.dlpmail.field.event_time_utc.column = date_time_unix
entities.dlpmail.field.event_time_score.column = date_time_score
entities.dlpmail.field.event_score.column = eventscore
entities.dlpmail.field.is_user_administrator.column = if(1=1,'false','false')
entities.dlpmail.field.is_user_administrator.is_logical_only = true
entities.dlpmail.field.is_user_executive.column = if(1=1,'false','false')
entities.dlpmail.field.is_user_executive.is_logical_only = true
entities.dlpmail.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.dlpmail.field.is_sensitive_machine.column =  ${fortscale.tags.sensitive.machine}
entities.dlpmail.field.normalized_src_machine_score.column = normalized_src_machine_score
entities.dlpmail.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end
entities.dlpmail.field.lr.column=if(1=1,null,null)
entities.dlpmail.field.lr.is_logical_only = true

entities.dlpmail.field.normalized_src_machine.enabledByDefault = true


#### Hidden fiedls
entities.dlpmail.field.event_time_utc.attributes = internal
entities.dlpmail.field.source_machine.attributes = internal
entities.dlpmail.field.source_machine.enabledByDefault=false
entities.dlpmail.field.event_time_utc.enabledByDefault=false
entities.dlpmail.field.is_sensitive_machine.attributes = internal
entities.dlpmail.field.is_sensitive_machine.enabledByDefault=false
entities.dlpmail.field.status.attributes = internal
entities.dlpmail.field.status.enabledByDefault = false
entities.dlpmail.field.is_user_administrator.attributes = internal
entities.dlpmail.field.is_user_administrator.enabledByDefault = false
entities.dlpmail.field.is_user_executive.attributes = internal
entities.dlpmail.field.is_user_executive.enabledByDefault = false


