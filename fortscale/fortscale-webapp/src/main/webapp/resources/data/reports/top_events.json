{
	"_mock_data": "top_events",
    "endpoint": {

                "api": "dataQuery",
				"dataQuery": {
                    "entity": "scored_access_event",
					"fields": [
						{
							"allFields": true
						},
						{
							"entity": "users",
							"id": "display_name"
						},
						{
							"entity": "users",
							"id": "followed"
						},
						{
							"entity": "users",
							"id": "account_is_disabled"
						},
						{
							"entity": "users",
							"id": "is_user_service"
						},
						{
							"entity": "users",
							"id": "is_user_executive"
						},
						{
							"entity": "users",
							"id": "is_user_administrator"
						}
					],
					"conditions": {
                            "operator": "AND",
                            "terms": [
                                {
                                    "type": "field",
                                    "id": "event_score",
                                    "operator": "greaterThanOrEquals",
                                    "valueParam": "minscore"
                                },
                                {
                                    "type": "field",
                                    "id": "event_time_utc",
                                    "operator": "dateRange",
                                    "valueParam": "dateRange"
                                },
                                {
                                    "type": "field",
                                    "id": "is_user_administrator",
                                    "entity": "users",
                                    "operator": "equals",
                                    "value": true,
                                    "enabled": {
                                        "field": "users",
                                        "operator": "contains",
                                        "value": "isuseradministrator"
                                    }
                                },
                                {
                                    "type": "field",
                                    "id": "is_user_executive",
                                    "entity": "users",
                                    "operator": "equals",
                                    "value": true,
                                    "enabled": {
                                        "field": "users",
                                        "operator": "contains",
                                        "value": "isuserexecutive"
                                    }
                                },
								{
									"type": "field",
									"id": "is_user_service",
									"entity": "users",
									"operator": "equals",
									"value": true,
									"enabled": {
										"field": "users",
										"operator": "contains",
										"value": "isuseraccountservice"
									}
								},
								{
									"type": "field",
									"id": "account_is_disabled",
									"entity": "users",
									"operator": "equals",
									"value": true,
									"enabled": {
										"field": "users",
										"operator": "contains",
										"value": "accountisdisabled"
									}
								}

                            ]
                        },
                    "entitiesJoin": {
                        "joinType": "right",
                        "entity": "users",
                        "joinFields": {
                            "left": "scored_access_event.normalized_username",
                            "right": "users.normalized_username"
                        }
                    },
                    "sort": [
                        {
                            "field": "event_score",
                            "direction": "desc"
                        },
                        {
                            "field": "event_time",
                            "direction": "DESC"
                        }
                    ],
                    "limit": 20
                }
            },
    "process": [
        {
            "processId": "sort",
            "params": {
                "direction": "desc",
				"field": "event_score"
            }
        },
        {
            "processId": "limit",
            "params": {
                "numOfRows": 20
            }
        },
        {
            "processId": "groupByField",
            "params": {
                "field": "normalized_username"
            }
        }

    ],
    "cache": "5m",
    "params": [
        {
            "field": "minscore",
            "dashboardParam": "minscore",
            "default": 50
        },
        {
            "field": "dateRange",
            "dashboardParam": "top_events_dates",
            "isRequired": true
        },
        {
            "field": "users",
            "dashboardParam": "top_events_users"
        }
    ]
}


