entities = ${leaf_entities},${base_entities}
leaf_entities =  kerberos_logins, kerberos_tgt, ssh, vpn, vpn_session, users, ntlm ,crmsf,wame,gwame, prnlog, oracle
base_entities = access_event, session, scored_access_event,  auth_event, users, active_directory, customized_auth_event

######################################### Active directory ###########################################

entities.active_directory.id = active_directory
entities.active_directory.name = Active Directory
entities.active_directory.is_abstract = true
entities.active_directory.show_in_explore = false
entities.active_directory.default_sort = display_name
entities.active_directory.fields = display_name

entities.active_directory.field.display_name.name = Display Name
entities.active_directory.field.display_name.type = STRING


######################################### Access Event base entity ###########################################

entities.access_event.name = Access Event
entities.access_event.db = MySQL
entities.access_event.is_abstract = true
entities.access_event.show_in_explore = false
entities.access_event.default_sort = event_time DESC
#entities.access_event.partitions = event_time_utc daily day_partition

entities.access_event.fields = type, username, normalized_username, source_ip, normalized_src_machine, source_machine, status, event_time, event_time_utc, update_time_utc

entities.access_event.field.type.name = Type
entities.access_event.field.type.type = STRING
entities.access_event.field.type.is_logical_only = true
entities.access_event.field.type.attributes = internal
entities.access_event.field.type.enabledByDefault = false
entities.access_event.field.type.explicit = true
entities.access_event.field.type.rank = 2

entities.access_event.field.username.name = Username
entities.access_event.field.username.type = STRING
entities.access_event.field.username.rank = 1
entities.access_event.field.username.enabledByDefault = true
entities.access_event.field.username.attributes = user
entities.access_event.field.username.tags = user


entities.access_event.field.normalized_username.name = Normalized Username
entities.access_event.field.normalized_username.type = STRING
entities.access_event.field.normalized_username.enabledByDefault = false
entities.access_event.field.normalized_username.rank = 3
entities.access_event.field.normalized_username.attributes = user,internal
entities.access_event.field.normalized_username.tags = user
entities.access_event.field.normalized_username.joinFrom = user

entities.access_event.field.source_machine.name = Source Computer Name
entities.access_event.field.source_machine.type = STRING
entities.access_event.field.source_machine.rank = 5
entities.access_event.field.source_machine.searchable = true
entities.access_event.field.source_machine.enabledByDefault = true

entities.access_event.field.normalized_src_machine.name = Source Computer Name
entities.access_event.field.normalized_src_machine.type = STRING
entities.access_event.field.normalized_src_machine.rank = 5
entities.access_event.field.normalized_src_machine.searchable = true
entities.access_event.field.normalized_src_machine.enabledByDefault = true

entities.access_event.field.source_ip.name = Source IP
entities.access_event.field.source_ip.type = STRING
entities.access_event.field.source_ip.enabledByDefault = false
entities.access_event.field.source_ip.rank = 4

entities.access_event.field.status.name = Status
entities.access_event.field.status.type = SELECT
entities.access_event.field.status.rank = 10
entities.access_event.field.status.lov = true
entities.access_event.field.status.enabledByDefault = false
entities.access_event.field.status.is_logical_only = true

entities.access_event.field.event_time.name = Event Time
entities.access_event.field.event_time.type = DATE_TIME
entities.access_event.field.event_time.rank = 99
entities.access_event.field.event_time.enabledByDefault = true

entities.access_event.field.event_time_utc.name = Event Time (UTC)
entities.access_event.field.event_time_utc.type = TIMESTAMP
entities.access_event.field.event_time_utc.enabledByDefault = false
entities.access_event.field.event_time_utc.rank = 99

entities.access_event.field.update_time_utc.name = Update Time (UTC)
entities.access_event.field.update_time_utc.column = ${impala.table.fields.updateTimestamp}
entities.access_event.field.update_time_utc.type = NUMBER
entities.access_event.field.update_time_utc.attributes = internal
entities.access_event.field.update_time_utc.enabledByDefault = false
entities.access_event.field.update_time_utc.explicit = true
entities.access_event.field.update_time_utc.rank = 2

#In order for a partition to work, it should be added here:
entities.access_event.field.yearmonthday.column = yearmonthday

######################################### Scored Access Event base entity ###########################################

entities.scored_access_event.name = Scored Access
entities.scored_access_event.db = MySQL
entities.scored_access_event.is_abstract = true
entities.scored_access_event.show_in_explore = false
entities.scored_access_event.extends = access_event
entities.scored_access_event.performance_field = event_score
entities.scored_access_event.performance_field_min_value = 50
entities.scored_access_event.fields = event_time_score, event_score, severity, suspicious_event_score, normalized_src_machine_score

entities.scored_access_event.field.event_time.score = event_time_score

entities.scored_access_event.field.event_time_score.name = Event Time Score
entities.scored_access_event.field.event_time_score.type = NUMBER
entities.scored_access_event.field.event_time_score.enabledByDefault = false
entities.scored_access_event.field.event_time_score.rank = 800

entities.scored_access_event.field.event_score.name = Event Score
entities.scored_access_event.field.event_score.type = NUMBER

entities.scored_access_event.field.severity.name = Severity
entities.scored_access_event.field.severity.type = STRING
entities.scored_access_event.field.severity.is_logical_only = true
entities.scored_access_event.field.severity.enabledByDefault = false
entities.scored_access_event.field.severity.explicit = true
entities.scored_access_event.field.severity.rank = 998
entities.scored_access_event.field.severity.lov = true
entities.scored_access_event.field.severity.attributes = internal

entities.scored_access_event.field.normalized_src_machine.score = normalized_src_machine_score
entities.scored_access_event.field.normalized_src_machine_score.name = Source Computer Score
entities.scored_access_event.field.normalized_src_machine_score.type = NUMBER
entities.scored_access_event.field.normalized_src_machine_score.enabledByDefault = false
entities.scored_access_event.field.normalized_src_machine_score.rank = 990

entities.scored_access_event.field.suspicious_event_score.name = Suspicious Event Score
entities.scored_access_event.field.suspicious_event_score.type = NUMBER
entities.scored_access_event.field.suspicious_event_score.enabledByDefault = false
entities.scored_access_event.field.suspicious_event_score.rank = 990
entities.scored_access_event.field.suspicious_event_score.is_logical_only = true


######################################### Auth Event base entity ###########################################

entities.auth_event.name = Auth Event
entities.auth_event.db = MySQL
entities.auth_event.is_abstract = true
entities.auth_event.show_in_explore = false
entities.auth_event.extends = scored_access_event
entities.auth_event.fields = normalized_src_machine_score, destination_machine, normalized_dst_machine, normalized_dst_machine_score, is_from_vpn, is_sensitive_machine


entities.auth_event.field.destination_machine.name = Destination Computer Name
entities.auth_event.field.destination_machine.type = STRING
entities.auth_event.field.destination_machine.rank = 6
entities.auth_event.field.destination_machine.searchable = true
entities.auth_event.field.destination_machine.tags = machine

entities.auth_event.field.normalized_dst_machine.name = Destination Computer Name
entities.auth_event.field.normalized_dst_machine.type = STRING
entities.auth_event.field.normalized_dst_machine.score = normalized_dst_machine_score
entities.auth_event.field.normalized_dst_machine.rank = 28
entities.auth_event.field.normalized_dst_machine.searchable = true
entities.auth_event.field.normalized_dst_machine.tags = machine

entities.auth_event.field.normalized_dst_machine_score.name = Destination Computer Score
entities.auth_event.field.normalized_dst_machine_score.type = NUMBER
entities.auth_event.field.normalized_dst_machine_score.enabledByDefault = false
entities.auth_event.field.normalized_dst_machine_score.rank = 991

entities.auth_event.field.is_sensitive_machine.name = Is Sensitive Computer
entities.auth_event.field.is_sensitive_machine.type = BOOLEAN
entities.auth_event.field.is_sensitive_machine.enabledByDefault = false
entities.auth_event.field.is_sensitive_machine.rank = 25

entities.auth_event.field.is_from_vpn.name = Is From VPN
entities.auth_event.field.is_from_vpn.type = BOOLEAN
entities.auth_event.field.is_from_vpn.enabledByDefault = false
entities.auth_event.field.is_from_vpn.rank = 26

######################################### Customized Auth Event base entity ###########################################

entities.customized_auth_event.name = Customized Auth Event
entities.customized_auth_event.db = MySQL
entities.customized_auth_event.is_abstract = true
entities.customized_auth_event.show_in_explore = false
entities.customized_auth_event.extends = auth_event

entities.customized_auth_event.fields = country, country_score, country_code, isp, region, city, action_type, action_type_score

entities.customized_auth_event.field.country.name = Country
entities.customized_auth_event.field.country.type = STRING
entities.customized_auth_event.field.country.score = country_score
entities.customized_auth_event.field.country.rank = 15
entities.customized_auth_event.field.country.searchable = true
entities.customized_auth_event.field.normalized_dst_machine_score.enabledByDefault = false

entities.customized_auth_event.field.country_score.name = Country Score
entities.customized_auth_event.field.country_score.type = NUMBER
entities.customized_auth_event.field.country_score.enabledByDefault = false
entities.customized_auth_event.field.country_score.rank = 995

entities.customized_auth_event.field.country_code.name = Country Code
entities.customized_auth_event.field.country_code.type = STRING
entities.customized_auth_event.field.country_code.enabledByDefault = false
entities.customized_auth_event.field.country_code.rank = 16
entities.customized_auth_event.field.country_code.searchable = true

entities.customized_auth_event.field.city.name = City
entities.customized_auth_event.field.city.type = STRING
entities.customized_auth_event.field.city.rank = 17
entities.customized_auth_event.field.city.searchable = true

entities.customized_auth_event.field.isp.name = ISP
entities.customized_auth_event.field.isp.type = STRING
entities.customized_auth_event.field.isp.enabledByDefault = false
entities.customized_auth_event.field.isp.rank = 19
entities.customized_auth_event.field.isp.searchable = true

entities.customized_auth_event.field.region.name = Region
entities.customized_auth_event.field.region.type = STRING
entities.customized_auth_event.field.region.enabledByDefault = false
entities.customized_auth_event.field.region.rank = 20
entities.customized_auth_event.field.region.searchable = true



entities.customized_auth_event.field.action_type.score = action_type_score
entities.customized_auth_event.field.action_type.name = Action Type
entities.customized_auth_event.field.action_type.type = STRING
entities.customized_auth_event.field.action_type.rank = 17
entities.customized_auth_event.field.action_type.searchable = true
entities.customized_auth_event.field.action_type.enabledByDefault = true

entities.customized_auth_event.field.action_type_score.name = Action Type Score
entities.customized_auth_event.field.action_type_score.type = NUMBER
entities.customized_auth_event.field.action_type_score.enabledByDefault = false
entities.customized_auth_event.field.action_type_score.rank = 990


#entities.customized_auth_event.field.data_usage.name = Data Usage
#entities.customized_auth_event.field.data_usage.type = NUMBER
#entities.customized_auth_event.field.data_usage.score = data_usage_score
#entities.customized_auth_event.field.data_usage.rank = 32
#entities.customized_auth_event.field.data_usage.format = sizeBytesForTime

#entities.customized_auth_event.field.data_usage_score.name = Data Usage Score
#entities.customized_auth_event.field.data_usage_score.type = NUMBER
#entities.customized_auth_event.field.data_usage_score.enabledByDefault = false
#entities.customized_auth_event.field.data_usage_score.rank = 992



######################################### Kerberos Logins ###########################################

entities.kerberos_logins.id = kerberos_logins
entities.kerberos_logins.name = Kerberos
entities.kerberos_logins.nameForMenu = Kerberos events
entities.kerberos_logins.is_abstract = false
entities.kerberos_logins.show_in_explore = true
entities.kerberos_logins.short_name = Kerberos
entities.kerberos_logins.extends = auth_event
entities.kerberos_logins.db = MySQL
entities.kerberos_logins.table = ${impala.score.kerberos_logins.table.name}
entities.kerberos_logins.performance_table = ${impala.score.kerberos_logins.top.table.name}
entities.kerberos_logins.partitions=${impala.score.kerberos_logins.table.partition.type}
entities.kerberos_logins.partition.base.field = event_time_utc

################### Kerberos Logins fields ###################

entities.kerberos_logins.fields = source_machine_type, destination_machine_type, failure_code,failure_code_score

entities.kerberos_logins.field.type.column = "${entities.kerberos_logins.short_name}"

entities.kerberos_logins.field.username.column = ${impala.score.ldapauth.table.fields.account_name}
entities.kerberos_logins.field.normalized_username.column = ${impala.score.ldapauth.table.fields.normalized_username}
entities.kerberos_logins.field.source_machine.column = ${impala.score.ldapauth.table.fields.machine_name}
entities.kerberos_logins.field.normalized_src_machine.column = ${impala.score.ldapauth.table.fields.normalized_src_machine}
entities.kerberos_logins.field.normalized_src_machine_score.column = ${impala.score.ldapauth.table.fields.hostnameScore}
entities.kerberos_logins.field.source_ip.column = ${impala.score.ldapauth.table.fields.client_address}
entities.kerberos_logins.field.source_ip.enabledByDefault = true
entities.kerberos_logins.field.destination_machine.column = ${impala.score.ldapauth.table.fields.normalized_dst_machine}
entities.kerberos_logins.field.normalized_dst_machine.column = ${impala.score.ldapauth.table.fields.service_name}
entities.kerberos_logins.field.normalized_dst_machine_score.column = ${impala.score.ldapauth.table.fields.destScore}
entities.kerberos_logins.field.event_time.column = ${impala.score.ldapauth.table.fields.timeGenerated}
entities.kerberos_logins.field.event_time_utc.column = ${impala.score.ldapauth.table.fields.date_time_unix}
entities.kerberos_logins.field.event_time_utc.attributes = internal
entities.kerberos_logins.field.event_time_score.column = ${impala.score.ldapauth.table.fields.date_timeScore}
entities.kerberos_logins.field.event_score.column = ${impala.score.ldapauth.table.fields.eventscore}
entities.kerberos_logins.field.severity.column = CASE WHEN ${impala.score.ldapauth.table.fields.eventscore} > 49 AND ${impala.score.ldapauth.table.fields.eventscore} < 80 THEN 'Medium' WHEN ${impala.score.ldapauth.table.fields.eventscore} >= 80 AND ${impala.score.ldapauth.table.fields.eventscore} < 95 THEN 'High' WHEN ${impala.score.ldapauth.table.fields.eventscore} >= 95 THEN 'Critical' else 'Low' end
entities.kerberos_logins.field.is_sensitive_machine.column = ${impala.score.ldapauth.table.fields.is_sensitive_machine}
entities.kerberos_logins.field.is_from_vpn.column = ${impala.score.ldapauth.table.fields.is_nat}


entities.kerberos_logins.field.suspicious_event_score.column = CASE WHEN ${impala.score.ldapauth.table.fields.eventscore} > 50 THEN 1 else 0 end

entities.kerberos_logins.field.status.column = if (${impala.score.ldapauth.table.fields.failure_code} = '0x0' OR ${impala.score.ldapauth.table.fields.failure_code} = '0x1b', 'Success', 'Failure')
entities.kerberos_logins.field.status.valueList = Success,Failure

entities.kerberos_logins.field.source_machine_type.name = Source Computer Type
entities.kerberos_logins.field.source_machine_type.type = SELECT
entities.kerberos_logins.field.source_machine_type.column = ${impala.score.ldapauth.table.fields.src_class}
entities.kerberos_logins.field.source_machine_type.enabledByDefault = false
entities.kerberos_logins.field.source_machine_type.rank = 5
entities.kerberos_logins.field.source_machine_type.valueList = Desktop,Server
entities.kerberos_logins.field.source_machine_type.lov = true

entities.kerberos_logins.field.destination_machine_type.name = Destination Computer Type
entities.kerberos_logins.field.destination_machine_type.type = SELECT
entities.kerberos_logins.field.destination_machine_type.column = ${impala.score.ldapauth.table.fields.dst_class}
entities.kerberos_logins.field.destination_machine_type.enabledByDefault = false
entities.kerberos_logins.field.destination_machine_type.rank = 6
entities.kerberos_logins.field.destination_machine_type.valueList = Desktop,Server
entities.kerberos_logins.field.destination_machine_type.lov = true

entities.kerberos_logins.field.failure_code.name = Error Code
entities.kerberos_logins.field.failure_code.column = ${impala.score.ldapauth.table.fields.failure_code}
entities.kerberos_logins.field.failure_code.type = STRING
entities.kerberos_logins.field.failure_code.enabledByDefault = true
entities.kerberos_logins.field.failure_code.rank = 10
entities.kerberos_logins.field.failure_code.lov = true
entities.kerberos_logins.field.failure_code.score = failure_code_score
entities.kerberos_logins.field.failure_code.searchable = true

entities.kerberos_logins.field.failure_code_score.name = Error Code Score
entities.kerberos_logins.field.failure_code_score.column = ${impala.score.ldapauth.table.fields.failure_codeScore}
entities.kerberos_logins.field.failure_code_score.type = NUMBER
entities.kerberos_logins.field.failure_code_score.enabledByDefault = false
entities.kerberos_logins.field.failure_code_score.rank = 995


#### Hidden fiedls
entities.kerberos_logins.field.source_machine.attributes = internal
entities.kerberos_logins.field.source_machine.enabledByDefault = false
entities.kerberos_logins.field.destination_machine.attributes = internal
entities.kerberos_logins.field.destination_machine.enabledByDefault = false


######################################### Kerberos TGT (4768 + 4771) ###########################################

entities.kerberos_tgt.id = kerberos_tgt
entities.kerberos_tgt.name = Kerberos TGT
entities.kerberos_tgt.nameForMenu = Kerberos TGT events
entities.kerberos_tgt.is_abstract = false
entities.kerberos_tgt.show_in_explore = true
entities.kerberos_tgt.short_name = TGT
entities.kerberos_tgt.extends = scored_access_event
entities.kerberos_tgt.db = MySQL
entities.kerberos_tgt.table = kerberostgtscore
entities.kerberos_tgt.performance_table = kerberostgtscore_top
entities.kerberos_tgt.partitions= daily
entities.kerberos_tgt.partition.base.field = event_time_utc

################### Logins fields ###################

entities.kerberos_tgt.fields = source_machine_type, failure_code, failure_code_score, authentication_type, is_sensitive_machine

entities.kerberos_tgt.field.type.column = "${entities.kerberos_tgt.short_name}"
entities.kerberos_tgt.field.username.column = ${impala.data.security.events.login.table.field.account_name}
entities.kerberos_tgt.field.normalized_username.column = ${impala.data.security.events.login.table.field.normalized_username}
entities.kerberos_tgt.field.source_machine.column = ${impala.data.security.events.login.table.field.machine_name}
entities.kerberos_tgt.field.normalized_src_machine.column = ${impala.data.security.events.login.table.field.normalized_src_machine}
entities.kerberos_tgt.field.normalized_src_machine_score.column = normalized_src_machine_score
entities.kerberos_tgt.field.normalized_dst_machine.column = ${impala.data.security.events.login.table.field.normalized_dst_machine}
entities.kerberos_tgt.field.source_ip.column = ${impala.data.security.events.login.table.field.client_address}
entities.kerberos_tgt.field.source_ip.enabledByDefault = true

entities.kerberos_tgt.field.status.column = if(${impala.data.security.events.login.table.field.status}='SUCCESS', 'Success', 'Failure')
entities.kerberos_tgt.field.status.valueList = Success,Failure
entities.kerberos_tgt.field.status.enabledByDefault = true

entities.kerberos_tgt.field.event_time.column = ${impala.data.security.events.login.table.field.date_time}
entities.kerberos_tgt.field.event_time_utc.column = ${impala.data.security.events.login.table.field.date_time_unix}
entities.kerberos_tgt.field.event_time_utc.attributes = internal

entities.kerberos_tgt.field.is_sensitive_machine.name = Is Sensitive Computer
entities.kerberos_tgt.field.is_sensitive_machine.type = BOOLEAN
entities.kerberos_tgt.field.is_sensitive_machine.column = ${impala.data.security.events.login.table.field.is_sensitive_machine}
entities.kerberos_tgt.field.is_sensitive_machine.enabledByDefault = false

entities.kerberos_tgt.field.is_from_vpn.column = ${impala.data.security.events.login.table.field.is_nat}
entities.kerberos_tgt.field.source_ip.column.enabledByDefault=true

entities.kerberos_tgt.field.event_time_score.column = date_time_score
entities.kerberos_tgt.field.event_score.column = eventscore
entities.kerberos_tgt.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.kerberos_tgt.field.suspicious_event_score.column =  CASE WHEN eventscore > 50 THEN 1 else 0 end



entities.kerberos_tgt.field.source_machine_type.name = Computer Type
entities.kerberos_tgt.field.source_machine_type.type = STRING
entities.kerberos_tgt.field.source_machine_type.column = ${impala.data.security.events.login.table.field.src_class}
entities.kerberos_tgt.field.source_machine_type.enabledByDefault = false
entities.kerberos_tgt.field.source_machine_type.rank = 5
entities.kerberos_tgt.field.source_machine_type.lov = true

entities.kerberos_tgt.field.authentication_type.name = Authentication Type
entities.kerberos_tgt.field.authentication_type.type = STRING
entities.kerberos_tgt.field.authentication_type.column = ${impala.data.security.events.login.table.field.authentication_type}
entities.kerberos_tgt.field.authentication_type.rank = 10
entities.kerberos_tgt.field.authentication_type.lov = true
entities.kerberos_tgt.field.authentication_type.enabledByDefault = false

entities.kerberos_tgt.field.failure_code.name = Failure Code
entities.kerberos_tgt.field.failure_code.column = ${impala.data.security.events.login.table.field.failure_code}
entities.kerberos_tgt.field.failure_code.score = failure_code_score
entities.kerberos_tgt.field.failure_code.type = STRING
entities.kerberos_tgt.field.failure_code.enabledByDefault = true
entities.kerberos_tgt.field.failure_code.rank = 11
entities.kerberos_tgt.field.failure_code.lov = true

entities.kerberos_tgt.field.failure_code_score.name =  Failure Code Score
entities.kerberos_tgt.field.failure_code_score.column = failure_code_score
entities.kerberos_tgt.field.failure_code_score.type = NUMBER
entities.kerberos_tgt.field.failure_code_score.score =
entities.kerberos_tgt.field.failure_code_score.valueList =
entities.kerberos_tgt.field.failure_code_score.rank = 10
entities.kerberos_tgt.field.failure_code_score.lov = true
entities.kerberos_tgt.field.failure_code_score.enabledByDefault = false


#### Hidden fiedls
entities.kerberos_tgt.field.source_machine.attributes = internal
entities.kerberos_tgt.field.source_machine.enabledByDefault = false


######################################### SSH ###########################################

entities.ssh.id = ssh
entities.ssh.name = SSH
entities.ssh.nameForMenu = SSH events
entities.ssh.is_abstract = false
entities.ssh.show_in_explore = true
entities.ssh.short_name = SSH
entities.ssh.extends = auth_event
entities.ssh.db = MySQL
entities.ssh.table = ${impala.score.ssh.table.name}
entities.ssh.performance_table = ${impala.score.ssh.top.table.name}
entities.ssh.partitions=${impala.score.ssh.table.partition.type}
entities.ssh.partition.base.field = event_time_utc

################### SSH fields ###################

entities.ssh.fields = auth_method, auth_method_score

entities.ssh.field.type.column = "${entities.ssh.short_name}"
entities.ssh.field.username.column = ${impala.score.ssh.table.field.username}
entities.ssh.field.normalized_username.column = ${impala.score.ssh.table.fields.normalized_username}
entities.ssh.field.source_machine.column = ${impala.score.ssh.table.field.hostname}
entities.ssh.field.normalized_src_machine.column = ${impala.score.ssh.table.field.normalized_src_machine}
entities.ssh.field.normalized_src_machine_score.column = ${impala.score.ssh.table.field.normalized_src_machine_score}
entities.ssh.field.source_ip.column = ${impala.score.ssh.table.fields.source_ip}
entities.ssh.field.source_ip.enabledByDefault = true
entities.ssh.field.destination_machine.column = ${impala.score.ssh.table.field.target_machine}
entities.ssh.field.normalized_dst_machine.column = ${impala.score.ssh.table.field.normalized_dst_machine}
entities.ssh.field.normalized_dst_machine_score.column = ${impala.score.ssh.table.field.normalized_dst_machine_score}
entities.ssh.field.event_time.column = ${impala.score.ssh.table.fields.date_time}
entities.ssh.field.event_time_utc.column = ${impala.score.ssh.table.field.epochtime}
entities.ssh.field.event_time_utc.attributes = internal
entities.ssh.field.event_time_score.column = ${impala.score.ssh.table.fields.date_time_score}
entities.ssh.field.event_score.column = ${impala.score.ssh.table.field.EventScore}
entities.ssh.field.severity.column = CASE WHEN ${impala.score.ssh.table.field.EventScore} > 49 AND ${impala.score.ssh.table.field.EventScore} < 80 THEN 'Medium' WHEN ${impala.score.ssh.table.field.EventScore} >= 80 AND ${impala.score.ssh.table.field.EventScore} < 95 THEN 'High' WHEN ${impala.score.ssh.table.field.EventScore} >= 95 THEN 'Critical' else 'Low' end
entities.ssh.field.is_sensitive_machine.column = ${impala.score.ssh.table.field.is_sensitive_machine}
entities.ssh.field.is_from_vpn.column = ${impala.score.ssh.table.field.is_nat}

entities.ssh.field.suspicious_event_score.column = CASE WHEN ${impala.score.ldapauth.table.fields.eventscore} > 50 THEN 1 else 0 end

entities.ssh.field.status.column = if(${impala.score.ssh.table.fields.status} = 'Accepted','Success','Failure')
entities.ssh.field.status.valueList = Success,Failure
entities.ssh.field.status.enabledByDefault = true



entities.ssh.field.auth_method.name = Auth Method
entities.ssh.field.auth_method.column = ${impala.score.ssh.table.fields.auth_method}
entities.ssh.field.auth_method.type = SELECT
entities.ssh.field.auth_method.score = auth_method_score
entities.ssh.field.auth_method.valueList = password,publickey,keyboard-interactive/pam,keyboard-interactive
entities.ssh.field.auth_method.rank = 10
entities.ssh.field.auth_method.lov = true

entities.ssh.field.auth_method_score.name = Auth Method Score
entities.ssh.field.auth_method_score.column = ${impala.score.ssh.table.fields.auth_method_score}
entities.ssh.field.auth_method_score.type = NUMBER
entities.ssh.field.auth_method_score.enabledByDefault = false
entities.ssh.field.auth_method_score.rank = 995

entities.ssh.field.source_machine_type.name = Source Computer Type
entities.ssh.field.source_machine_type.type = STRING
entities.ssh.field.source_machine_type.column = ${impala.score.ssh.table.field.src_class}
entities.ssh.field.source_machine_type.enabledByDefault = false
entities.ssh.field.source_machine_type.rank = 5
entities.ssh.field.source_machine_type.lov = true

entities.ssh.field.destination_machine_type.name = Destination Computer Type
entities.ssh.field.destination_machine_type.type = STRING
entities.ssh.field.destination_machine_type.column = ${impala.score.ssh.table.field.dst_class}
entities.ssh.field.destination_machine_type.enabledByDefault = false
entities.ssh.field.destination_machine_type.rank = 6
entities.ssh.field.destination_machine_type.lov = true

## hidden fields##
entities.ssh.field.source_machine.enabledByDefault = false
entities.ssh.field.source_machine.attributes = internal
entities.ssh.field.destination_machine.enabledByDefault = false
entities.ssh.field.destination_machine.attributes = internal

######################################### VPN ###########################################

entities.vpn.id = vpn
entities.vpn.name = VPN
entities.vpn.nameForMenu = VPN events
entities.vpn.is_abstract = false
entities.vpn.show_in_explore = true
entities.vpn.short_name = VPN
entities.vpn.extends = scored_access_event
entities.vpn.session_entity = vpn_session
entities.vpn.db = MySQL
entities.vpn.table = ${impala.score.vpn.table.name}
entities.vpn.performance_table = ${impala.score.vpn.top.table.name}
entities.vpn.partitions=${impala.score.vpn.table.partition.type}
entities.vpn.partition.base.field = event_time_utc

################### VPN fields ###################

entities.vpn.fields = country, country_score, country_code, isp, region, city, local_ip

entities.vpn.field.type.column = "${entities.vpn.short_name}"
entities.vpn.field.username.column = ${impala.score.vpn.table.field.username}
entities.vpn.field.normalized_username.column = ${impala.score.vpn.table.field.normalized_username}
entities.vpn.field.source_machine.column = ${impala.score.vpn.table.field.hostname}
entities.vpn.field.source_machine.enabledByDefault = true
entities.vpn.field.normalized_src_machine.column = ${impala.score.vpn.table.field.hostname}
entities.vpn.field.normalized_src_machine_score.column = ${impala.score.vpn.table.field.hostname.score}
entities.vpn.field.source_ip.column = ${impala.score.vpn.table.field.source_ip}
entities.vpn.field.source_ip.enabledByDefault = true
entities.vpn.field.event_time.column = ${impala.score.vpn.table.field.date_time}
entities.vpn.field.event_time_utc.column = ${impala.score.vpn.table.field.date_time_unix}
entities.vpn.field.event_time_utc.attributes = internal
entities.vpn.field.event_time_score.column = ${impala.score.vpn.table.field.date_timeScore}
entities.vpn.field.event_score.column = ${impala.score.vpn.table.field.event.score}
entities.vpn.field.severity.column = CASE WHEN ${impala.score.vpn.table.field.event.score} > 49 AND ${impala.score.vpn.table.field.event.score} < 80 THEN 'Medium' WHEN ${impala.score.vpn.table.field.event.score} >= 80 AND ${impala.score.vpn.table.field.event.score} < 95 THEN 'High' WHEN ${impala.score.vpn.table.field.event.score} >= 95 THEN 'Critical' else 'Low' end


entities.vpn.field.status.column = if(${impala.score.vpn.table.field.status}='SUCCESS', 'Success', 'Failure')
entities.vpn.field.status.enabledByDefault = true
entities.vpn.field.status.valueList = Success,Failure
entities.vpn.field.status.rank = 18

entities.vpn.field.suspicious_event_score.column = CASE WHEN ${impala.score.ldapauth.table.fields.eventscore} > 50 THEN 1 else 0 end

entities.vpn.field.country.name = Country
entities.vpn.field.country.column = ${impala.score.vpn.table.field.country}
entities.vpn.field.country.type = STRING
entities.vpn.field.country.score = country_score
entities.vpn.field.country.rank = 15
entities.vpn.field.country.lov = true
entities.vpn.field.country.searchable = true

entities.vpn.field.country_score.name = Country Score
entities.vpn.field.country_score.column = ${impala.score.vpn.table.field.country.score}
entities.vpn.field.country_score.type = NUMBER
entities.vpn.field.country_score.enabledByDefault = false
entities.vpn.field.country_score.rank = 995

entities.vpn.field.country_code.name = Country Code
entities.vpn.field.country_code.column = ${impala.score.vpn.table.field.countrycode}
entities.vpn.field.country_code.type = STRING
entities.vpn.field.country_code.enabledByDefault = false
entities.vpn.field.country_code.rank = 16
entities.vpn.field.country_code.searchable = true
entities.vpn.field.country_code.lov = true

entities.vpn.field.city.name = City
entities.vpn.field.city.column = ${impala.score.vpn.table.field.city}
entities.vpn.field.city.type = STRING
entities.vpn.field.city.rank = 17
entities.vpn.field.city.searchable = true

entities.vpn.field.isp.name = ISP
entities.vpn.field.isp.column = ${impala.score.vpn.table.field.isp}
entities.vpn.field.isp.type = STRING
entities.vpn.field.isp.enabledByDefault = false
entities.vpn.field.isp.rank = 19
entities.vpn.field.isp.searchable = true

entities.vpn.field.region.name = Region
entities.vpn.field.region.column = ${impala.score.vpn.table.field.region}
entities.vpn.field.region.type = STRING
entities.vpn.field.region.enabledByDefault = false
entities.vpn.field.region.rank = 20
entities.vpn.field.region.searchable = true

entities.vpn.field.local_ip.name = Local IP
entities.vpn.field.local_ip.column = ${impala.score.vpn.table.field.local_ip}
entities.vpn.field.local_ip.type = STRING
entities.vpn.field.local_ip.rank = 21

## hidden fields##
entities.vpn.field.normalized_src_machine.enabledByDefault = false
entities.vpn.field.normalized_src_machine.attributes = internal

######################################### Session base entity ###########################################

entities.session.name = Session
entities.session.db = MySQL
entities.session.is_abstract = true
entities.session.show_in_explore = false
entities.session.performance_field = session_score
entities.session.performance_field_min_value = 50
entities.session.default_sort = start_time DESC

entities.session.fields = event_type, session_score, username, normalized_username, start_time, start_time_utc, end_time, end_time_utc, session_time_utc, duration, duration_in_hours, severity, update_time_utc

entities.session.field.yearmonthday.column = yearmonthday

entities.session.field.session_score.name = Session Score
entities.session.field.session_score.type = NUMBER
entities.session.field.session_score.rank = 999
entities.session.field.session_score.enabledByDefault = true
entities.session.field.session_score.attributes = session

entities.session.field.event_type.name = Type
entities.session.field.event_type.type = STRING
entities.session.field.event_type.is_logical_only = true
entities.session.field.event_type.attributes = internal
entities.session.field.event_type.explicit = true
entities.session.field.event_type.rank = 1
entities.session.field.event_type.lov = true

entities.session.field.username.name = Username
entities.session.field.username.type = STRING
entities.session.field.username.rank = 2
entities.session.field.username.enabledByDefault = true
entities.session.field.username.attributes = user
entities.session.field.username.tags = user

entities.session.field.normalized_username.name = Normalized Username
entities.session.field.normalized_username.type = STRING
entities.session.field.normalized_username.enabledByDefault = false
entities.session.field.normalized_username.rank = 3
entities.session.field.normalized_username.attributes = internal
entities.session.field.normalized_username.joinFrom = user

entities.session.field.start_time.name = Start Time
entities.session.field.start_time.type = DATE_TIME
entities.session.field.start_time.enabledByDefault = true
entities.session.field.start_time.rank = 10

entities.session.field.start_time_utc.name = Start Time (UTC)
entities.session.field.start_time_utc.type = TIMESTAMP
entities.session.field.start_time_utc.enabledByDefault = false
entities.session.field.start_time_utc.rank = 10
entities.session.field.start_time_utc.attributes = internal

entities.session.field.end_time.name = End Time
entities.session.field.end_time.enabledByDefault = true
entities.session.field.end_time.type = DATE_TIME
entities.session.field.end_time.rank = 11

entities.session.field.end_time_utc.name = End Time (UTC)
entities.session.field.end_time_utc.type = TIMESTAMP
entities.session.field.end_time_utc.enabledByDefault = false
entities.session.field.end_time_utc.rank = 11
entities.session.field.end_time_utc.attributes = internal

entities.session.field.session_time_utc.name = Session Time
entities.session.field.session_time_utc.type = TIMESTAMP
entities.session.field.session_time_utc.is_logical_only = true
entities.session.field.session_time_utc.is_tokenized = true
entities.session.field.session_time_utc.attributes = internal
entities.session.field.session_time_utc.explicit = true
entities.session.field.session_time_utc.enabledByDefault = false
entities.session.field.session_time_utc.rank = 12

entities.session.field.duration.name = Duration (hh:mm:ss)
entities.session.field.duration.enabledByDefault = true
entities.session.field.duration.type = DURATION

entities.session.field.duration_in_hours.name = Duration in hours
entities.session.field.duration_in_hours.enabledByDefault = false
entities.session.field.duration_in_hours.type = NUMBER
entities.session.field.duration_in_hours.attributes = internal
entities.session.field.duration_in_hours.is_logical_only = true

entities.session.field.severity.name = Severity
entities.session.field.severity.type = STRING
entities.session.field.severity.is_logical_only = true
entities.session.field.severity.enabledByDefault = false
entities.session.field.severity.explicit = true
entities.session.field.severity.rank = 998
entities.session.field.severity.lov = true
entities.session.field.severity.attributes = internal

entities.session.field.update_time_utc.name = Update Time (UTC)
entities.session.field.update_time_utc.column = ${impala.table.fields.updateTimestamp}
entities.session.field.update_time_utc.type = NUMBER
entities.session.field.update_time_utc.attributes = internal
entities.session.field.update_time_utc.enabledByDefault = false
entities.session.field.update_time_utc.explicit = true
entities.session.field.update_time_utc.rank = 2

######################################### VPN Session ###########################################

entities.vpn_session.id = vpn_session
entities.vpn_session.name = VPN Session
entities.vpn_session.nameForMenu = VPN Sessions
entities.vpn_session.is_abstract = false
entities.vpn_session.show_in_explore = true
entities.vpn_session.short_name = VPN Session
entities.vpn_session.extends = session
entities.vpn_session.events_entity = vpn
entities.vpn_session.db = MySQL
entities.vpn_session.table = ${impala.score.vpn_session.table.name}
entities.vpn_session.performance_table = ${impala.score.vpn_session.top.table.name}
entities.vpn_session.partitions=${impala.score.vpn_session.table.partition.type}
entities.vpn_session.partition.base.field = end_time_utc

################### VPN Session fields ###################

entities.vpn_session.fields = local_ip, source_machine, normalized_src_machine_score, country, country_score, source_ip, country_code, isp, region, city, local_ip, ipusage, totalbytes, read_bytes, write_bytes, duration, data_bucket, data_bucket_score
entities.vpn_session.field.event_type.column = "${entities.vpn_session.short_name}"

entities.vpn_session.field.session_score.column = ${impala.score.vpn.table.field.event.score}
entities.vpn_session.field.start_time.column = seconds_sub(${entities.vpn_session.table}.${impala.score.vpn.session.table.field.date_time}, ${entities.vpn_session.table}.${impala.score.vpn.session.table.field.duration})
entities.vpn_session.field.start_time.is_logical_only = true
entities.vpn_session.field.end_time.column = ${impala.score.vpn.session.table.field.date_time}
entities.vpn_session.field.start_time_utc.column = (${entities.vpn_session.table}.${impala.score.vpn.table.field.date_time_unix} - ${entities.vpn_session.table}.${impala.score.vpn.session.table.field.duration})
entities.vpn_session.field.start_time_utc.is_logical_only = true
entities.vpn_session.field.end_time_utc.column = ${impala.score.vpn.table.field.date_time_unix}
entities.vpn_session.field.session_time_utc.column = ${entities.vpn_session.field.end_time_utc.column} BETWEEN {0} AND {1} OR ${entities.vpn_session.field.start_time_utc.column} BETWEEN {0} AND {1}
entities.vpn_session.field.username.column = ${impala.score.vpn.table.field.username}
entities.vpn_session.field.normalized_username.column = ${impala.score.vpn.table.field.normalized_username}
entities.vpn_session.field.normalized_src_machine.column = ${impala.score.vpn.session.table.field.hostname}

entities.vpn_session.field.source_machine.score = normalized_src_machine_score
entities.vpn_session.field.source_machine.name = Source Machine
entities.vpn_session.field.source_machine.type = STRING
entities.vpn_session.field.source_machine.column = ${impala.score.vpn.session.table.field.hostname}
entities.vpn_session.field.source_machine.rank = 5
entities.vpn_session.field.source_machine.enabledByDefault = false
entities.vpn_session.field.source_machine.searchable = true

entities.vpn_session.field.severity.column = CASE WHEN ${impala.score.vpn.table.field.event.score} > 49 AND ${impala.score.vpn.table.field.event.score} < 80 THEN 'Medium' WHEN ${impala.score.vpn.table.field.event.score} >= 80 AND ${impala.score.vpn.table.field.event.score} < 95 THEN 'High' WHEN ${impala.score.vpn.table.field.event.score} >= 95 THEN 'Critical' else 'Low' end

entities.vpn_session.field.source_ip.name = Source IP
entities.vpn_session.field.source_ip.column = ${impala.score.vpn.session.table.field.source_ip}
entities.vpn_session.field.source_ip.type = STRING
entities.vpn_session.field.source_ip.enabledByDefault = false
entities.vpn_session.field.source_ip.rank = 6

entities.vpn_session.field.normalized_src_machine_score.name = Source Machine Score
entities.vpn_session.field.normalized_src_machine_score.type = NUMBER
entities.vpn_session.field.normalized_src_machine_score.column = ${impala.score.vpn.session.table.field.hostname.score}
entities.vpn_session.field.normalized_src_machine_score.enabledByDefault = false
entities.vpn_session.field.normalized_src_machine_score.rank = 990

entities.vpn_session.field.local_ip.name = Local IP
entities.vpn_session.field.local_ip.column = ${impala.score.vpn.session.table.field.local_ip}
entities.vpn_session.field.local_ip.type = STRING
entities.vpn_session.field.local_ip.enabledByDefault = false
entities.vpn_session.field.local_ip.rank = 7

entities.vpn_session.field.country.name = Country
entities.vpn_session.field.country.column = ${impala.score.vpn.session.table.field.country}
entities.vpn_session.field.country.type = STRING
entities.vpn_session.field.country.score = country_score
entities.vpn_session.field.country.rank = 15
entities.vpn_session.field.country.searchable = true
entities.vpn_session.field.country.lov = true

entities.vpn_session.field.country_score.name = Country Score
entities.vpn_session.field.country_score.column = ${impala.score.vpn.session.table.field.country.score}
entities.vpn_session.field.country_score.type = NUMBER
entities.vpn_session.field.country_score.enabledByDefault = false
entities.vpn_session.field.country_score.rank = 991

entities.vpn_session.field.country_code.name = Country Code
entities.vpn_session.field.country_code.column = ${impala.score.vpn.session.table.field.countrycode}
entities.vpn_session.field.country_code.type = STRING
entities.vpn_session.field.country_code.enabledByDefault = false
entities.vpn_session.field.country_code.rank = 16
entities.vpn_session.field.country_code.searchable = true
entities.vpn_session.field.country_code.lov = true

entities.vpn_session.field.city.name = City
entities.vpn_session.field.city.column = ${impala.score.vpn.session.table.field.city}
entities.vpn_session.field.city.type = STRING
entities.vpn_session.field.city.rank = 17
entities.vpn_session.field.city.searchable = true

entities.vpn_session.field.isp.name = ISP
entities.vpn_session.field.isp.column = ${impala.score.vpn.session.table.field.isp}
entities.vpn_session.field.isp.type = STRING
entities.vpn_session.field.isp.enabledByDefault = false
entities.vpn_session.field.isp.rank = 18
entities.vpn_session.field.isp.searchable = true

entities.vpn_session.field.region.name = Region
entities.vpn_session.field.region.column = ${impala.score.vpn.session.table.field.region}
entities.vpn_session.field.region.type = STRING
entities.vpn_session.field.region.enabledByDefault = false
entities.vpn_session.field.region.rank = 19
entities.vpn_session.field.region.searchable = true

entities.vpn_session.field.ipusage.name = IP Usage
entities.vpn_session.field.ipusage.column = ${impala.score.vpn.session.table.field.ipusage}
entities.vpn_session.field.ipusage.type = STRING
entities.vpn_session.field.ipusage.enabledByDefault = false
entities.vpn_session.field.ipusage.rank = 25

entities.vpn_session.field.read_bytes.name = Downloaded Bytes
entities.vpn_session.field.read_bytes.column = ${impala.score.vpn.session.table.field.readbytes}
entities.vpn_session.field.read_bytes.type = NUMBER
entities.vpn_session.field.read_bytes.rank = 26
entities.vpn_session.field.read_bytes.format = sizeBytes

entities.vpn_session.field.write_bytes.name = Uploaded Bytes
entities.vpn_session.field.write_bytes.column = ${impala.score.vpn.session.table.field.writebytes}
entities.vpn_session.field.write_bytes.type = NUMBER
entities.vpn_session.field.write_bytes.rank = 27
entities.vpn_session.field.write_bytes.format = sizeBytes

entities.vpn_session.field.totalbytes.name = Total Bytes
entities.vpn_session.field.totalbytes.column = ${impala.score.vpn.session.table.field.totalbytes}
entities.vpn_session.field.totalbytes.type = NUMBER
entities.vpn_session.field.totalbytes.enabledByDefault = false
entities.vpn_session.field.totalbytes.rank = 29
entities.vpn_session.field.totalbytes.format = sizeBytes

entities.vpn_session.field.duration.column = ${impala.score.vpn.session.table.field.duration}
entities.vpn_session.field.duration.rank = 30
entities.vpn_session.field.duration.format = seconds

entities.vpn_session.field.duration_in_hours.column = ${impala.score.vpn.session.table.field.duration}/3600

entities.vpn_session.field.data_bucket.name = Data Usage
entities.vpn_session.field.data_bucket.column = ${impala.score.vpn.session.table.field.databucket}
entities.vpn_session.field.data_bucket.type = NUMBER
entities.vpn_session.field.data_bucket.score = data_bucket_score
entities.vpn_session.field.data_bucket.rank = 32
entities.vpn_session.field.data_bucket.format = sizeBytesForTime

entities.vpn_session.field.data_bucket_score.name = Data Usage Score
entities.vpn_session.field.data_bucket_score.column = ${impala.score.vpn.session.table.field.databucket.score}
entities.vpn_session.field.data_bucket_score.type = NUMBER
entities.vpn_session.field.data_bucket_score.enabledByDefault = false
entities.vpn_session.field.data_bucket_score.rank = 992

entities.vpn_session.field.bytesavg.name = Avg Bytes Per Minute
entities.vpn_session.field.bytesavg.column = ${impala.score.vpn.session.table.field.bytesavg}
entities.vpn_session.field.bytesavg.type = NUMBER
entities.vpn_session.field.bytesavg.rank = 33
entities.vpn_session.field.bytesavg.format = sizeBytesForTime


######################################### ORACLE ###########################################

entities.oracle.id = oracle
entities.oracle.name = Oracle
entities.oracle.nameForMenu = Oracle events
entities.oracle.is_abstract = false
entities.oracle.show_in_explore = true
entities.oracle.short_name = Oracle
entities.oracle.extends = auth_event
entities.oracle.db = MySQL
entities.oracle.table = oraclescore
entities.oracle.performance_table = oraclescore_top
entities.oracle.partitions=daily
entities.oracle.partition.base.field = event_time_utc


############ Additional fields

entities.oracle.fields = db_username,db_username_score,db_id,action_type,action_type_score,return_code,return_code_score,db_object,db_object_score,priv_used

entities.oracle.field.db_username.column=db_username
entities.oracle.field.db_id.column=db_id
entities.oracle.field.action_type.column=action_type
entities.oracle.field.return_code.column=return_code
entities.oracle.field.db_object.column=db_object
entities.oracle.field.priv_used.column=priv_used

entities.oracle.field.db_username.name = DB Username
entities.oracle.field.db_username.type = STRING
entities.oracle.field.db_username.score = db_username_score
entities.oracle.field.db_username.rank = 10
entities.oracle.field.db_username.lov = true
entities.oracle.field.db_username.searchable = true

entities.oracle.field.action_type.name =  Action Type
entities.oracle.field.action_type.type = SELECT
entities.oracle.field.action_type.valueList = Select,Login
entities.oracle.field.action_type.score = action_type_score
entities.oracle.field.action_type.rank = 10
entities.oracle.field.action_type.lov = true

entities.oracle.field.return_code.name =  Return Code
entities.oracle.field.return_code.type = STRING
entities.oracle.field.return_code.score = return_code_score
entities.oracle.field.return_code.rank = 10
entities.oracle.field.return_code.lov = true
entities.oracle.field.return_code.searchable = true

entities.oracle.field.db_object.name = DB Object
entities.oracle.field.db_object.type = STRING
entities.oracle.field.db_object.score = db_object_score
entities.oracle.field.db_object.rank = 10
entities.oracle.field.db_object.lov = true
entities.oracle.field.db_object.searchable = true

entities.oracle.field.db_id.name =  DB ID
entities.oracle.field.db_id.type = STRING
entities.oracle.field.db_id.rank = 10
entities.oracle.field.db_id.lov = true
entities.oracle.field.db_id.enabledByDefault = false

entities.oracle.field.priv_used.name = Privilege Used
entities.oracle.field.priv_used.type = STRING
entities.oracle.field.priv_used.rank = 10
entities.oracle.field.priv_used.lov = true
entities.oracle.field.priv_used.enabledByDefault = false

entities.oracle.field.db_username_score.name = DB Username Score
entities.oracle.field.db_username_score.type = NUMBER
entities.oracle.field.db_username_score.rank = 10
entities.oracle.field.db_username_score.lov = true
entities.oracle.field.db_username_score.enabledByDefault = false

entities.oracle.field.return_code_score.name = Return Code Score
entities.oracle.field.return_code_score.type = NUMBER
entities.oracle.field.return_code_score.rank = 10
entities.oracle.field.return_code_score.lov = true
entities.oracle.field.return_code_score.enabledByDefault = false

entities.oracle.field.db_object_score.name = Database Object Score
entities.oracle.field.db_object_score.type = NUMBER
entities.oracle.field.db_object_score.rank = 10
entities.oracle.field.db_object_score.lov = true
entities.oracle.field.db_object_score.enabledByDefault = false


entities.oracle.field.action_type_score.name = Action Type Score
entities.oracle.field.action_type_score.type = NUMBER
entities.oracle.field.action_type_score.rank = 10
entities.oracle.field.action_type_score.lov = true
entities.oracle.field.action_type_score.enabledByDefault = false


#### Hidden fiedls
entities.oracle.field.event_time_utc.attributes = internal
entities.oracle.field.is_from_vpn.attributes = internal
entities.oracle.field.is_sensitive_machine.attributes = internal
entities.oracle.field.source_machine.enabledByDefault = false
entities.oracle.field.source_machine.attributes = internal
entities.oracle.field.destination_machine.enabledByDefault = false
entities.oracle.field.destination_machine.attributes = internal

####### Actual schema definition (logical to phisical mapping)
entities.oracle.field.type.column = "Oracle"
entities.oracle.field.username.column = username
entities.oracle.field.normalized_username.column = normalized_username
entities.oracle.field.source_ip.column = source_ip
entities.oracle.field.source_machine.column = hostname
entities.oracle.field.normalized_src_machine.column = normalized_src_machine
entities.oracle.field.normalized_dst_machine.column = normalized_dst_machine
entities.oracle.field.destination_machine.column= target_machine
entities.oracle.field.event_time.column = date_time
entities.oracle.field.event_time_utc.column = date_time_unix
entities.oracle.field.event_time_score.column = date_time_score
entities.oracle.field.normalized_src_machine_score.column = normalized_src_machine_score
entities.oracle.field.normalized_dst_machine_score.column = normalized_dst_machine_score
entities.oracle.field.return_code_score.column = return_code_score
entities.oracle.field.action_type_score.column = action_type_score
entities.oracle.field.db_object_score.column = db_object_score
entities.oracle.field.db_username_score.column = db_username_score
entities.oracle.field.is_from_vpn.column = is_from_vpn
entities.oracle.field.status.column= if (${impala.score.oracle.table.field.return_code} = '0', 'Success', 'Failure')
entities.oracle.field.event_score.column = eventscore
entities.oracle.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.oracle.field.is_sensitive_machine.column = ${fortscale.tags.sensitive.machine}
entities.oracle.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end


######################################### CRMSF ###########################################

entities.crmsf.id = crmsf
entities.crmsf.name = Salesforce
entities.crmsf.nameForMenu = Crm Salesforce events
entities.crmsf.is_abstract = false
entities.crmsf.show_in_explore = true
entities.crmsf.short_name = Salesforce
entities.crmsf.extends = customized_auth_event
entities.crmsf.db = MySQL
entities.crmsf.table = crmsfscore
entities.crmsf.performance_table = crmsfscore_top
entities.crmsf.partitions=daily
entities.crmsf.partition.base.field = event_time_utc


############ Additional fields

entities.crmsf.fields = login_type,browser,platform,application,login_url,status_score

entities.crmsf.field.login_type.column=login_type
entities.crmsf.field.browser.column=browser
entities.crmsf.field.platform.column=platform
entities.crmsf.field.application.column=application
entities.crmsf.field.login_url.column=login_url

entities.crmsf.field.login_type.name =  Login Type
entities.crmsf.field.login_type.type = SELECT
entities.crmsf.field.login_type.score =
entities.crmsf.field.login_type.valueList = Application,Remote Access Client,AppStore,Remote Access 2.0,
entities.crmsf.field.login_type.rank = 10
entities.crmsf.field.login_type.lov = true

entities.crmsf.field.browser.name =  Browser
entities.crmsf.field.browser.type = STRING
entities.crmsf.field.browser.score =
entities.crmsf.field.browser.rank = 10
entities.crmsf.field.browser.lov = true
entities.crmsf.field.browser.searchable = true

entities.crmsf.field.platform.name =  Platform
entities.crmsf.field.platform.type = STRING
entities.crmsf.field.platform.score =
entities.crmsf.field.platform.rank = 10
entities.crmsf.field.platform.lov = true
entities.crmsf.field.platform.searchable = true

entities.crmsf.field.application.name =  Application
entities.crmsf.field.application.type = STRING
entities.crmsf.field.application.score =
entities.crmsf.field.application.rank = 10
entities.crmsf.field.application.lov = true
entities.crmsf.field.application.searchable = true

entities.crmsf.field.login_url.name =  Login URL
entities.crmsf.field.login_url.type = STRING
entities.crmsf.field.login_url.score =
entities.crmsf.field.login_url.valueList =
entities.crmsf.field.login_url.rank = 10
entities.crmsf.field.login_url.lov = true
entities.crmsf.field.login_url.enabledByDefault = false

entities.crmsf.field.status_score.name =  Status Score
entities.crmsf.field.status_score.type = NUMBER
entities.crmsf.field.status_score.score =
entities.crmsf.field.status_score.valueList =
entities.crmsf.field.status_score.rank = 10
entities.crmsf.field.status_score.lov = true
entities.crmsf.field.status_score.enabledByDefault = true




####### Actual schema definition (logical to phisical mapping)
entities.crmsf.field.country_code.column=countryisocode
entities.crmsf.field.country.column=country
entities.crmsf.field.country_score.column=country_score
entities.crmsf.field.isp.column=isp
entities.crmsf.field.region.column=region
entities.crmsf.field.city.column=city
entities.crmsf.field.action_type.column=action_type
entities.crmsf.field.action_type_score.column=action_type_score
entities.crmsf.field.action_type.score=action_type_score
entities.crmsf.field.type.column = "${entities.crmsf.short_name}"
entities.crmsf.field.username.column = username
entities.crmsf.field.normalized_username.column = normalized_username
entities.crmsf.field.source_machine.column = hostname
entities.crmsf.field.source_machine.score=normalized_src_machine_score
entities.crmsf.field.normalized_src_machine.column = hostname
entities.crmsf.field.normalized_src_machine.score = normalized_src_machine_score
entities.crmsf.field.normalized_src_machine_score.column = source_machine_score
entities.crmsf.field.source_ip.column = source_ip
entities.crmsf.field.destination_machine.column = normalized_dst_machine
entities.crmsf.field.normalized_dst_machine.column = normalized_dst_machine
entities.crmsf.field.normalized_dst_machine_score.column = destination_machine_score
entities.crmsf.field.event_time.column = date_time
entities.crmsf.field.event_time_utc.column = date_time_unix
entities.crmsf.field.event_time_score.column = date_time_score
entities.crmsf.field.event_score.column = eventscore
entities.crmsf.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.crmsf.field.is_sensitive_machine.column = ${fortscale.tags.sensitive.machine}
entities.crmsf.field.is_from_vpn.column =is_from_vpn
entities.crmsf.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end
entities.crmsf.field.status.column = status
entities.crmsf.field.status.enabledByDefault = true
entities.crmsf.field.status.score=status_score
entities.crmsf.field.status_score.column = status_score


## Select fields value lists
entities.crmsf.field.status.valueList = Failed: Computer activation required,Invalid Password,Organization Suspended,User is Frozen,Success


#### Hidden fiedls
entities.crmsf.field.destination_machine.attributes = internal
entities.crmsf.field.destination_machine.enabledByDefault = false
entities.crmsf.field.normalized_dst_machine_score.attributes = internal
entities.crmsf.field.action_type_score.attributes = internal
entities.crmsf.field.source_machine.attributes = internal
entities.crmsf.field.source_machine.enabledByDefault = false
entities.crmsf.field.normalized_src_machine.attributes = internal
entities.crmsf.field.normalized_src_machine.enabledByDefault = false
entities.crmsf.field.normalized_dst_machine.attributes = internal
entities.crmsf.field.normalized_dst_machine.enabledByDefault = false
entities.crmsf.field.normalized_src_machine_score.attributes = internal
entities.crmsf.field.normalized_src_machine_score.enabledByDefault = false
entities.crmsf.field.event_time_utc.attributes = internal
entities.crmsf.field.is_sensitive_machine.attributes = internal





######################################### WAME ###########################################

entities.wame.id = wame
entities.wame.name = Account Management
entities.wame.nameForMenu = Account Management events
entities.wame.is_abstract = false
entities.wame.show_in_explore = true
entities.wame.short_name = Account Management
entities.wame.extends = scored_access_event
entities.wame.db = MySQL
entities.wame.table = wamescore
entities.wame.performance_table = wamescore_top
entities.wame.partitions=daily
entities.wame.partition.base.field = event_time_utc


############ Additional fields

entities.wame.fields = action_type,target_user_name,target_normalized_username,action_type_score

entities.wame.field.action_type.column=action_type
entities.wame.field.target_user_name.column=target_user_name
entities.wame.field.target_normalized_username.column=target_normalized_username
entities.wame.field.action_type_score.column=action_type_score


entities.wame.field.action_type.name =  Action Type
entities.wame.field.action_type.type = SELECT
entities.wame.field.action_type.score = action_type_score
entities.wame.field.action_type.valueList = Account Enabled,Account Unlocked,Password Reset,Password Changed
entities.wame.field.action_type.rank = 10
entities.wame.field.action_type.lov = true

entities.wame.field.target_user_name.name =  Target User Name
entities.wame.field.target_user_name.type = STRING
entities.wame.field.target_user_name.score =
entities.wame.field.target_user_name.rank = 10
entities.wame.field.target_user_name.lov = true
entities.wame.field.target_user_name.searchable = true
entities.wame.field.target_user_name.enabledByDefault = false

entities.wame.field.target_normalized_username.name =  Target Normalized User Name
entities.wame.field.target_normalized_username.type = STRING
entities.wame.field.target_normalized_username.score =
entities.wame.field.target_normalized_username.rank = 10
entities.wame.field.target_normalized_username.lov = true
entities.wame.field.target_normalized_username.searchable = true

entities.wame.field.action_type_score.name =  Action Type Score
entities.wame.field.action_type_score.type = NUMBER
entities.wame.field.action_type_score.score =
entities.wame.field.action_type_score.valueList =
entities.wame.field.action_type_score.rank = 10
entities.wame.field.action_type_score.lov = true
entities.wame.field.status_score.enabledByDefault = false



####### Actual schema definition (logical to phisical mapping)
entities.wame.field.type.column = "Account Management"
entities.wame.field.username.column = username
entities.wame.field.normalized_username.column = normalized_username
entities.wame.field.source_ip.column = source_ip
entities.wame.field.source_machine.column = hostname
entities.wame.field.status.column = status
entities.wame.field.event_time.column = date_time
entities.wame.field.event_time_utc.column = date_time_unix
entities.wame.field.event_time_score.column = date_time_score
entities.wame.field.event_score.column = eventscore
entities.wame.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.wame.field.is_sensitive_machine.column =  ${fortscale.tags.sensitive.machine}
entities.wame.field.normalized_src_machine.column = normalized_src_machine
entities.wame.field.normalized_src_machine_score.column = source_machine_score
entities.wame.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end



#### Hidden fiedls
entities.wame.field.source_ip.attributes = internal
entities.wame.field.source_machine.enabledByDefault = false
entities.wame.field.source_machine.attributes = internal
entities.wame.field.normalized_src_machine.enabledByDefault = false
entities.wame.field.normalized_src_machine.attributes = internal
entities.wame.field.status.attributes = internal
entities.wame.field.source_machine_score.attributes = internal
entities.wame.field.source_machine_score.enabledByDefault = false
entities.wame.field.normalized_src_machine_score.attributes = internal
entities.wame.field.normalized_src_machine_score.enabledByDefault = false
entities.wame.field.is_sensitive_machine.attributes = internal
entities.wame.field.is_sensitive_machine.enabledByDefault=false


######################################### NTLM ###########################################

entities.ntlm.id = ntlm
entities.ntlm.name = NTLM
entities.ntlm.nameForMenu = NTLM events
entities.ntlm.is_abstract = false
entities.ntlm.show_in_explore = true
entities.ntlm.short_name = NTLM
entities.ntlm.extends = scored_access_event
entities.ntlm.db = MySQL
entities.ntlm.table = ntlmscore
entities.ntlm.performance_table = ntlmscore_top
entities.ntlm.partitions=daily
entities.ntlm.partition.base.field = event_time_utc


############ Additional fields

entities.ntlm.fields = failure_code,failure_code_score

entities.ntlm.field.failure_code.column=failure_code
entities.ntlm.field.failure_code_score.column=failure_code_score


entities.ntlm.field.failure_code.name =  Failure Code
entities.ntlm.field.failure_code.type = STRING
entities.ntlm.field.failure_code.score = failure_code_score
entities.ntlm.field.failure_code.rank = 10
entities.ntlm.field.failure_code.lov = true


entities.ntlm.field.failure_code_score.name =  Failure Code Score
entities.ntlm.field.failure_code_score.type = NUMBER
entities.ntlm.field.failure_code_score.score =
entities.ntlm.field.failure_code_score.valueList =
entities.ntlm.field.failure_code_score.rank = 10
entities.ntlm.field.failure_code_score.lov = true
entities.ntlm.field.failure_code_score.enabledByDefault = true


####### Actual schema definition (logical to phisical mapping)
entities.ntlm.field.type.column = "NTLM"
entities.ntlm.field.username.column = username
entities.ntlm.field.normalized_username.column = normalized_username
entities.ntlm.field.source_ip.column = source_ip
entities.ntlm.field.source_machine.column = hostname
entities.ntlm.field.normalized_src_machine.column = normalized_src_machine
entities.ntlm.field.status.column = if (${impala.score.ntlm.table.field.failure_code} = '0x0', 'Success', 'Failure')
entities.ntlm.field.status.valueList = Success,Failure
entities.ntlm.field.event_time.column = date_time
entities.ntlm.field.event_time_utc.column = date_time_unix
entities.ntlm.field.event_time_score.column = date_time_score
entities.ntlm.field.event_score.column = eventscore
entities.ntlm.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.ntlm.field.is_sensitive_machine.column =  ${fortscale.tags.sensitive.machine}
entities.ntlm.field.normalized_src_machine_score.column = normalized_src_machine_score
entities.ntlm.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end

entities.ntlm.field.normalized_src_machine.enabledByDefault = true


#### Hidden fiedls
entities.ntlm.field.event_time_utc.attributes = internal
entities.ntlm.field.event_time_utc.enabledByDefault=false
entities.ntlm.field.is_sensitive_machine.attributes = internal
entities.ntlm.field.is_sensitive_machine.enabledByDefault=false
entities.ntlm.field.source_machine.attributes = internal
entities.ntlm.field.source_machine.enabledByDefault = false

######################################### GWAME ###########################################

entities.gwame.id = gwame
entities.gwame.name = Group Management
entities.gwame.nameForMenu = Group Management events
entities.gwame.is_abstract = false
entities.gwame.show_in_explore = true
entities.gwame.short_name = Group Management
entities.gwame.extends = scored_access_event
entities.gwame.db = MySQL
entities.gwame.table = gwamescore
entities.gwame.performance_table = gwamescore_top
entities.gwame.partitions=daily
entities.gwame.partition.base.field = event_time_utc


############ Additional fields

entities.gwame.fields =target_username,target_normalized_username,group_name,action_type


entities.gwame.field.target_username.column=target_username
entities.gwame.field.target_normalized_username.column=target_normalized_username
entities.gwame.field.group_name.column=group_name
entities.gwame.field.action_type.column=action_type

entities.gwame.field.action_type.name =  Action Type
entities.gwame.field.action_type.type = SELECT
entities.gwame.field.action_type.score =
entities.gwame.field.action_type.valueList =Addition To A Security Global Group,Addition To A Security Local Group,Addition To A Security Universal Group
entities.gwame.field.action_type.rank = 10
entities.gwame.field.action_type.lov = true
entities.gwame.field.action_type.enabledByDefault = true


entities.gwame.field.target_username.name =  Target User Name
entities.gwame.field.target_username.type = STRING
entities.gwame.field.target_username.score =
entities.gwame.field.target_username.rank = 10
entities.gwame.field.target_username.lov = true
entities.gwame.field.target_username.searchable = true

entities.gwame.field.target_normalized_username.name =  Target Normalized User Name
entities.gwame.field.target_normalized_username.type = STRING
entities.gwame.field.target_normalized_username.score =
entities.gwame.field.target_normalized_username.rank = 10
entities.gwame.field.target_normalized_username.lov = true
entities.gwame.field.target_normalized_username.searchable = true

entities.gwame.field.group_name.name =  Group Name
entities.gwame.field.group_name.type = STRING
entities.gwame.field.group_name.score =
entities.gwame.field.group_name.rank = 10
entities.gwame.field.group_name.lov = true
entities.gwame.field.group_name.enabledByDefault = true



####### Actual schema definition (logical to physical mapping)
entities.gwame.field.type.column = "Group Management"
entities.gwame.field.username.column = username
entities.gwame.field.normalized_username.column = normalized_username
entities.gwame.field.source_ip.column = source_ip
entities.gwame.field.source_machine.column = hostname
entities.gwame.field.status.column = status
entities.gwame.field.event_time.column = date_time
entities.gwame.field.event_time_utc.column = date_time_unix
entities.gwame.field.event_time_score.column = date_time_score
entities.gwame.field.event_score.column = eventscore
entities.gwame.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end
entities.gwame.field.is_sensitive_machine.column =  ${fortscale.tags.sensitive.machine}
entities.gwame.field.normalized_src_machine.column = normalized_src_machine
entities.gwame.field.normalized_src_machine_score.column = source_machine_score
entities.gwame.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end


#### Hidden fiedls
entities.gwame.field.source_ip.attributes = internal
entities.gwame.field.source_machine.enabledByDefault = false
entities.gwame.field.source_machine.attributes = internal
entities.gwame.field.event_time_utc.attributes = internal
entities.gwame.field.normalized_src_machine.attributes = internal
entities.gwame.field.normalized_src_machine.enabledByDefault = false
entities.gwame.field.normalized_src_machine_score.attributes = internal
entities.gwame.field.normalized_src_machine_score.enabledByDefault = false
entities.gwame.field.is_sensitive_machine.attributes = internal
entities.gwame.field.is_sensitive_machine.enabledByDefault=false

######################################### prnlog ###########################################
entities.prnlog.id=prnlog
entities.prnlog.name=Printing logs
entities.prnlog.nameForMenu=Printers Events
entities.prnlog.shortName=Printers
entities.prnlog.is_abstract=false
entities.prnlog.show_in_explore=true
entities.prnlog.db=MySQL
entities.prnlog.table=prnlogscore
entities.prnlog.performance_table=prnlogscore_top
entities.prnlog.partition=daily
entities.prnlog.partitionBaseField=event_time_utc
entities.prnlog.extends=auth_event

entities.prnlog.fields=total_pages_score,file_name,total_pages,file_size,file_size_score

####### Actual schema definition (logical to phisical mapping)
entities.prnlog.field.type.column = "Printers"
entities.prnlog.field.event_score.column=eventscore
entities.prnlog.field.event_time_score.column=date_time_score
entities.prnlog.field.event_time.column=date_time
entities.prnlog.field.dst_usageType.column=dst_usageType
entities.prnlog.field.file_size_score.column=file_size_score
entities.prnlog.field.eventscore.column=eventscore
entities.prnlog.field.dst_class.column=dst_class
entities.prnlog.field.source_ip.column=source_ip
entities.prnlog.field.date_time_score.column=date_time_score
entities.prnlog.field.hostname.column=hostname
entities.prnlog.field.src_class.column=src_class
entities.prnlog.field.date_time.column=date_time
entities.prnlog.field.normalized_username.column=normalized_username
entities.prnlog.field.destination_machine.column=target_machine
entities.prnlog.field.destination_machine.name = Printer Name
entities.prnlog.field.destination_machine.score=normalized_dst_machine_score
entities.prnlog.field.normalized_dst_machine_score.name =Printer Name Score
entities.prnlog.field.normalized_dst_machine_score.column=destination_machine_score
entities.prnlog.field.normalized_src_machine.column=normalized_src_machine
entities.prnlog.field.date_time_unix.column=date_time_unix
entities.prnlog.field.usageType.column=usageType
entities.prnlog.field.source_machine.column=hostname
entities.prnlog.field.normalized_src_machine_score.column=normalized_src_machine_score
entities.prnlog.field.file_name.column=file_name
entities.prnlog.field.normalized_dst_machine.column=normalized_dst_machine
entities.prnlog.field.total_pages.column=total_pages
entities.prnlog.field.file_size.column=file_size
entities.prnlog.field.total_pages_score.column=total_pages_score
entities.prnlog.field.target_ip.column=target_ip
entities.prnlog.field.dst_isp.column=dst_isp
entities.prnlog.field.is_sensitive_machine.column= ${fortscale.tags.sensitive.machine}
entities.prnlog.field.username.column=username
entities.prnlog.field.status.column=status
entities.prnlog.field.is_from_vpn.column=is_from_vpn
entities.prnlog.field.event_time_utc.column = date_time_unix
entities.prnlog.field.suspicious_event_score.column = CASE WHEN eventscore > 50 THEN 1 else 0 end
entities.prnlog.field.severity.column = CASE WHEN eventscore > 49 AND eventscore < 80 THEN 'Medium' WHEN eventscore >= 80 AND eventscore < 95 THEN 'High' WHEN eventscore >= 95 THEN 'Critical' else 'Low' end


######### Hidden Fields ###########
entities.prnlog.field.dst_usageType.attributes=internal
entities.prnlog.field.dst_usageType.enabledByDefault=false
entities.prnlog.field.dst_class.attributes=internal
entities.prnlog.field.dst_class.enabledByDefault=false
entities.prnlog.field.src_class.attributes=internal
entities.prnlog.field.src_class.enabledByDefault=false
entities.prnlog.field.dst_city.attributes=internal
entities.prnlog.field.dst_city.enabledByDefault=false
entities.prnlog.field.usageType.attributes=internal
entities.prnlog.field.usageType.enabledByDefault=false
entities.prnlog.field.normalized_dst_machine.attributes=internal
entities.prnlog.field.normalized_dst_machine.enabledByDefault=false
entities.prnlog.field.target_ip.attributes=internal
entities.prnlog.field.target_ip.enabledByDefault=false
entities.prnlog.field.dst_isp.attributes=internal
entities.prnlog.field.dst_isp.enabledByDefault=false
entities.prnlog.field.is_sensitive_machine.attributes=internal
entities.prnlog.field.is_sensitive_machine.enabledByDefault=false

entities.prnlog.field.source_machine.attributes=internal
entities.prnlog.field.source_machine.enabledByDefault=false

####### Additional Fields ###########
entities.prnlog.field.total_pages_score.name=Total Pages Score
entities.prnlog.field.total_pages_score.type=NUMBER
entities.prnlog.field.total_pages_score.lov=true
entities.prnlog.field.total_pages_score.enabledByDefault=false


entities.prnlog.field.file_name.name=File Name
entities.prnlog.field.file_name.type=STRING
entities.prnlog.field.file_name.searchable=true
entities.prnlog.field.file_name.rank=10
entities.prnlog.field.file_name.lov=true
entities.prnlog.field.file_name.enabledByDefault=true

entities.prnlog.field.total_pages.name=Total Pages
entities.prnlog.field.total_pages.type=NUMBER
entities.prnlog.field.total_pages.score=total_pages_score
entities.prnlog.field.total_pages.rank=12
entities.prnlog.field.total_pages.lov=true
entities.prnlog.field.total_pages.enabledByDefault=true

entities.prnlog.field.file_size.name=File Size
entities.prnlog.field.file_size.type=NUMBER
entities.prnlog.field.file_size.score=file_size_score
entities.prnlog.field.file_size.rank=14
entities.prnlog.field.file_size.lov=true
entities.prnlog.field.file_size.enabledByDefault=true

entities.prnlog.field.file_size_score.name=File Size Score
entities.prnlog.field.file_size_score.type=NUMBER
entities.prnlog.field.file_size_score.rank=800
entities.prnlog.field.file_size_score.lov=true
entities.prnlog.field.file_size_score.enabledByDefault=false


######################################### Users ###########################################

entities.users.id = users
entities.users.name = Users
entities.users.nameForMenu = Users
entities.users.is_abstract = false
entities.users.show_in_explore = true
entities.users.db = MySQL
entities.users.table = ${impala.user.table.name}
entities.users.default_sort = display_name

################### Users fields ###################

entities.users.fields = id, severity, followed, normalized_username, ad_usernames, kerberos_logins_usernames, ssh_usernames, vpn_usernames, display_name, job_title, employee_id, employee_number, dn, ou, account_expiration_date, last_change_date, creation_date, street_address, company, division, room_number, account_is_disabled, password_expired, no_password_required, password_never_expires, direct_reports_dn, groups_dn, department, email, phone, mobile, home_phone, manager_name, manager_username, manager_id, account_disabled_date, last_activity_date, ssh_last_activity_date, vpn_last_activity_date, kerberos_logins_last_activity_date

entities.users.field.severity.column = 'Medium'
entities.users.field.severity.name = Severity
entities.users.field.severity.type = STRING
entities.users.field.severity.is_logical_only = true
entities.users.field.severity.explicit = true
entities.users.field.severity.rank = 998
entities.users.field.severity.lov = true
entities.users.field.severity.attributes = internal

entities.users.field.id.name = ID
entities.users.field.id.column = ${impala.user.fields.id}
entities.users.field.id.type = STRING
entities.users.field.id.enabledByDefault = false
entities.users.field.id.rank = 1
entities.users.field.id.attributes = internal

entities.users.field.followed.name = Followed User
entities.users.field.followed.column = ${impala.user.fields.followed}
entities.users.field.followed.type = BOOLEAN
entities.users.field.followed.enabledByDefault = false
entities.users.field.followed.rank = 50

entities.users.field.normalized_username.name = Normalized Username
entities.users.field.normalized_username.column = ${impala.user.fields.username}
entities.users.field.normalized_username.type = STRING
entities.users.field.normalized_username.rank = 1
entities.users.field.normalized_username.attributes = user
entities.users.field.normalized_username.tags = user
entities.users.field.normalized_username.joinTo = user

entities.users.field.ad_usernames.name = AD Usernames
entities.users.field.ad_usernames.column = ${impala.user.fields.adUsernames}
entities.users.field.ad_usernames.type = STRING
entities.users.field.ad_usernames.enabledByDefault = false
entities.users.field.ad_usernames.rank = 10
entities.users.field.ad_usernames.showForSpecificEntity=users

entities.users.field.kerberos_logins_usernames.name = Kerberos Logins Usernames
entities.users.field.kerberos_logins_usernames.column = ${impala.user.fields.secUsernames}
entities.users.field.kerberos_logins_usernames.type = STRING
entities.users.field.kerberos_logins_usernames.enabledByDefault = false
entities.users.field.kerberos_logins_usernames.rank = 11
entities.users.field.kerberos_logins_usernames.showForSpecificEntity=users

entities.users.field.ssh_usernames.name = SSH Usernames
entities.users.field.ssh_usernames.column = ${impala.user.fields.sshUsernames}
entities.users.field.ssh_usernames.type = STRING
entities.users.field.ssh_usernames.enabledByDefault = false
entities.users.field.ssh_usernames.rank = 12
entities.users.field.ssh_usernames.showForSpecificEntity=users


entities.users.field.vpn_usernames.name = VPN Usernames
entities.users.field.vpn_usernames.column = ${impala.user.fields.vpnUsernames}
entities.users.field.vpn_usernames.type = STRING
entities.users.field.vpn_usernames.enabledByDefault = false
entities.users.field.vpn_usernames.rank = 13
entities.users.field.vpn_usernames.showForSpecificEntity=users

entities.users.field.display_name.name = Display Name
entities.users.field.display_name.column = ${impala.user.fields.displayName}
entities.users.field.display_name.type = STRING
entities.users.field.display_name.rank = 2
entities.users.field.display_name.searchable = true
entities.users.field.display_name.attributes = user
entities.users.field.display_name.tags = user

entities.users.field.job_title.name = Job Title
entities.users.field.job_title.column = ${impala.user.fields.jobTitle}
entities.users.field.job_title.type = STRING
entities.users.field.job_title.enabledByDefault = false
entities.users.field.job_title.rank = 10
entities.users.field.job_title.lov = true
entities.users.field.job_title.searchable = true


entities.users.field.employee_id.name = Employee ID
entities.users.field.employee_id.column = ${impala.user.fields.employeeId}
entities.users.field.employee_id.type = STRING
entities.users.field.employee_id.enabledByDefault = false
entities.users.field.employee_id.rank = 15
entities.users.field.employee_id.showForSpecificEntity=users

entities.users.field.employee_number.name = Employee Number
entities.users.field.employee_number.column = ${impala.user.fields.employeeNumber}
entities.users.field.employee_number.type = STRING
entities.users.field.employee_number.enabledByDefault = false
entities.users.field.employee_number.rank = 15
entities.users.field.employee_number.showForSpecificEntity=users

entities.users.field.dn.name = Distinguished Name
entities.users.field.dn.column = ${impala.user.fields.dn}
entities.users.field.dn.type = STRING
entities.users.field.dn.enabledByDefault = false
entities.users.field.dn.rank = 20
entities.users.field.dn.searchable = true

entities.users.field.ou.name = Organizational Unit
entities.users.field.ou.column = ${impala.user.fields.ou}
entities.users.field.ou.type = STRING
entities.users.field.ou.enabledByDefault = false
entities.users.field.ou.rank = 21
entities.users.field.ou.lov = true

entities.users.field.account_expiration_date.name = Expires On
entities.users.field.account_expiration_date.column = from_unixtime(CAST(${impala.user.fields.accountExpires}/1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss')
entities.users.field.account_expiration_date.type = DATE_TIME
entities.users.field.account_expiration_date.enabledByDefault = false
entities.users.field.account_expiration_date.rank = 60
entities.users.field.account_expiration_date.is_logical_only = true

entities.users.field.last_change_date.name = Changed On
entities.users.field.last_change_date.column = from_unixtime(CAST(${impala.user.fields.whenChanged}/1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss')
entities.users.field.last_change_date.type = DATE_TIME
entities.users.field.last_change_date.enabledByDefault = false
entities.users.field.last_change_date.rank = 60
entities.users.field.last_change_date.is_logical_only = true

entities.users.field.creation_date.name = Created On
entities.users.field.creation_date.column = from_unixtime(CAST(${impala.user.fields.whenCreated}/1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss')
entities.users.field.creation_date.type = DATE_TIME
entities.users.field.creation_date.enabledByDefault = false
entities.users.field.creation_date.rank = 60
entities.users.field.creation_date.is_logical_only = true

entities.users.field.street_address.name = Street Address
entities.users.field.street_address.column = ${impala.user.fields.streetAddress}
entities.users.field.street_address.type = STRING
entities.users.field.street_address.enabledByDefault = false
entities.users.field.street_address.rank = 18

entities.users.field.company.name = Company
entities.users.field.company.column = ${impala.user.fields.company}
entities.users.field.company.type = STRING
entities.users.field.company.enabledByDefault = false
entities.users.field.company.rank = 15
entities.users.field.company.lov = true
entities.users.field.company.searchable = true

entities.users.field.division.name = Division
entities.users.field.division.column = ${impala.user.fields.division}
entities.users.field.division.type = STRING
entities.users.field.division.enabledByDefault = false
entities.users.field.division.rank = 15
entities.users.field.division.lov = true
entities.users.field.division.searchable = true

entities.users.field.room_number.name = Room Number
entities.users.field.room_number.column = ${impala.user.fields.roomNumber}
entities.users.field.room_number.type = STRING
entities.users.field.room_number.enabledByDefault = false
entities.users.field.room_number.rank = 18
entities.users.field.room_number.searchable = true

entities.users.field.account_is_disabled.name = Disabled
entities.users.field.account_is_disabled.column = ${impala.user.fields.accountIsDisabled}
entities.users.field.account_is_disabled.type = BOOLEAN
entities.users.field.account_is_disabled.enabledByDefault = false
entities.users.field.account_is_disabled.rank = 50

entities.users.field.password_expired.name = Password Expired
entities.users.field.password_expired.column = ${impala.user.fields.passwordExpired}
entities.users.field.password_expired.type = BOOLEAN
entities.users.field.password_expired.enabledByDefault = false
entities.users.field.password_expired.rank = 50

entities.users.field.no_password_required.name = No Password Required
entities.users.field.no_password_required.column = ${impala.user.fields.noPasswordRequire}
entities.users.field.no_password_required.type = BOOLEAN
entities.users.field.no_password_required.enabledByDefault = false
entities.users.field.no_password_required.rank = 50

entities.users.field.password_never_expires.name = Password Never Expires
entities.users.field.password_never_expires.column = ${impala.user.fields.passwordNeverExpires}
entities.users.field.password_never_expires.type = BOOLEAN
entities.users.field.password_never_expires.enabledByDefault = false
entities.users.field.password_never_expires.rank = 50

entities.users.field.direct_reports_dn.name = Direct Reports
entities.users.field.direct_reports_dn.column = ${impala.user.fields.directReportsDn}
entities.users.field.direct_reports_dn.type = STRING
entities.users.field.direct_reports_dn.enabledByDefault = false
entities.users.field.direct_reports_dn.rank = 40
entities.users.field.direct_reports_dn.searchable = true

entities.users.field.groups_dn.name = Groups
entities.users.field.groups_dn.column = ${impala.user.fields.groupsDn}
entities.users.field.groups_dn.type = STRING
entities.users.field.groups_dn.enabledByDefault = false
entities.users.field.groups_dn.rank = 45
entities.users.field.groups_dn.searchable = true

entities.users.field.department.name = Department
entities.users.field.department.column = ${impala.user.fields.department}
entities.users.field.department.type = STRING
entities.users.field.department.rank = 10
entities.users.field.department.lov = true
entities.users.field.department.searchable = true

entities.users.field.email.name = Email
entities.users.field.email.column = ${impala.user.fields.email}
entities.users.field.email.type = STRING
entities.users.field.email.enabledByDefault = false
entities.users.field.email.rank = 35
entities.users.field.email.showForSpecificEntity=users

entities.users.field.phone.name = Phone
entities.users.field.phone.column = ${impala.user.fields.phone}
entities.users.field.phone.type = STRING
entities.users.field.phone.enabledByDefault = false
entities.users.field.phone.rank = 35
entities.users.field.phone.showForSpecificEntity=users

entities.users.field.mobile.name = Mobile Phone
entities.users.field.mobile.column = ${impala.user.fields.mobile}
entities.users.field.mobile.type = STRING
entities.users.field.mobile.enabledByDefault = false
entities.users.field.mobile.rank = 35
entities.users.field.mobile.showForSpecificEntity=users

entities.users.field.home_phone.name = Home Phone
entities.users.field.home_phone.column = ${impala.user.fields.homePhone}
entities.users.field.home_phone.type = STRING
entities.users.field.home_phone.enabledByDefault = false
entities.users.field.home_phone.rank = 35
entities.users.field.home_phone.showForSpecificEntity=users

entities.users.field.manager_name.name = Manager Name
entities.users.field.manager_name.column = ${impala.user.fields.managerName}
entities.users.field.manager_name.type = STRING
entities.users.field.manager_name.enabledByDefault = false
entities.users.field.manager_name.rank = 40

entities.users.field.manager_name.attributes = user


entities.users.field.manager_username.name = Manager Username
entities.users.field.manager_username.column = ${impala.user.fields.managerUsername}
entities.users.field.manager_username.type = STRING
entities.users.field.manager_username.enabledByDefault = false
entities.users.field.manager_username.rank = 40
entities.users.field.manager_username.attributes = internal


entities.users.field.manager_id.name = Manager ID
entities.users.field.manager_id.column = ${impala.user.fields.managerId}
entities.users.field.manager_id.type = STRING
entities.users.field.manager_id.enabledByDefault = false
entities.users.field.manager_id.attributes = internal
entities.users.field.manager_id.rank = 40

entities.users.field.account_disabled_date.name = Disabled On
entities.users.field.account_disabled_date.column = ${impala.user.fields.disableAccountTime}
entities.users.field.account_disabled_date.type = DATE_TIME
entities.users.field.account_disabled_date.enabledByDefault = false
entities.users.field.account_disabled_date.rank = 60

entities.users.field.last_activity_date.name = Last Activity Time
entities.users.field.last_activity_date.column = ${impala.user.fields.lastActivityTime}
entities.users.field.last_activity_date.type = DATE_TIME
entities.users.field.last_activity_date.rank = 60

entities.users.field.ssh_last_activity_date.name = SSH Last Activity Time
entities.users.field.ssh_last_activity_date.column = ${impala.user.fields.sshLastActivityTime}
entities.users.field.ssh_last_activity_date.type = DATE_TIME
entities.users.field.ssh_last_activity_date.enabledByDefault = false
entities.users.field.ssh_last_activity_date.rank = 61

entities.users.field.vpn_last_activity_date.name = VPN Last Activity Time
entities.users.field.vpn_last_activity_date.column = ${impala.user.fields.vpnLastActivityTime}
entities.users.field.vpn_last_activity_date.type = DATE_TIME
entities.users.field.vpn_last_activity_date.enabledByDefault = false
entities.users.field.vpn_last_activity_date.rank = 61

entities.users.field.kerberos_logins_last_activity_date.name = Logins Last Activity Time
entities.users.field.kerberos_logins_last_activity_date.column = ${impala.user.fields.loginLastActivityTime}
entities.users.field.kerberos_logins_last_activity_date.type = DATE_TIME
entities.users.field.kerberos_logins_last_activity_date.enabledByDefault = false
entities.users.field.kerberos_logins_last_activity_date.rank = 61



