<header>
    <h2 title="{{if model (concat model.id ": " model.name) ""}}">
        {{#if model}}
            <span class="rsa-id">{{model.id}}:</span>
            <span class="rsa-name">{{model.name}}</span>
        {{else}}
            {{t "respond.incidentDetails.title"}}
        {{/if}}
    </h2>
</header>
<section class="rsa-main">
    {{#if model}}

        <ul class="rsa-tile-list">

            <!-- Summary section: -->
            <li class="rsa-card rsa-summary">
                <header>
                    <h2>{{t "respond.incidentDetails.summary"}}</h2>
                </header>
                <section>
                    <ul class="rsa-stat-list">

                        {{#rsa-field class="rsa-stat rsa-alertCount" label=(t "incident.fields.alertCount")}}
                            {{model.alertCount}}
                        {{/rsa-field}}

                        {{#rsa-field class="rsa-stat rsa-quartile" label=(t "incident.fields.averageAlertRiskScore")
                            data-field="averageAlertRiskScore"
                            data-value=(which-quartile model.averageAlertRiskScore)}}
                            {{model.averageAlertRiskScore}}
                        {{/rsa-field}}

                        {{#rsa-field class="rsa-stat rsa-quartile" label=(t "incident.fields.riskScore")
                            data-field="riskScore"
                            data-value=(which-quartile model.riskScore)}}
                            {{model.riskScore}}
                        {{/rsa-field}}

                        {{#rsa-field class="rsa-stat rsa-quartile" label=(t "incident.fields.priority")
                            data-field="priority"
                            data-value=model.prioritySort}}
                            {{t (concat "incident.priority." model.prioritySort)}}
                        {{/rsa-field}}

                    </ul>
                    <ul class="rsa-stat-list">

                        {{#rsa-field class="rsa-stat rsa-description" label=(t "incident.fields.description")}}
                            {{if model.summary model.summary (t "incident.description.none")}}
                        {{/rsa-field}}

                    </ul>
                </section>
            </li>

            <!-- Details section: -->
            <li class="rsa-card rsa-details">
                <header>
                    <h2>{{t "respond.incidentDetails.details"}}</h2>
                </header>
                <section>
                    <ul class="rsa-stat-list">

                        {{#rsa-field class="rsa-stat rsa-status" label=(t "incident.fields.status")}}
                            {{t (concat "incident.status." model.statusSort)}}
                        {{/rsa-field}}

                    </ul>
                    <ul class="rsa-field-list">

                        {{#rsa-field class="rsa-assignee" label=(t "incident.fields.assignee")}}
                            {{if model.assignee model.assignee.name (t "incident.assignee.none")}}
                        {{/rsa-field}}

                        {{#rsa-field label=(t "incident.fields.lastUpdated")}}
                            {{format-moment model.lastUpdated "YYYY/MM/DD H:mm.ss (Z)"}} {{#if model.lastUpdatedByUser.name}}{{t "respond.incidentDetails.by"}} {{model.lastUpdatedByUser.name}}{{/if}}
                        {{/rsa-field}}

                        {{#rsa-field label=(t "incident.fields.createdDate")}}
                            {{format-moment model.created "YYYY/MM/DD H:mm.ss (Z)"}} {{#if model.createdBy}}{{t "respond.incidentDetails.by"}} {{model.createdBy}}{{/if}}
                        {{/rsa-field}}

                        {{#rsa-field label=(t "incident.fields.sources")}}
                            <ul class="rsa-csv-list">
                                {{#each model.sources as |source|}}
                                    <li>{{source}}</li>
                                {{/each}}
                            </ul>
                        {{/rsa-field}}

                        {{#rsa-field label=(t "incident.fields.categories")}}
                            <ul class="rsa-tag-list">
                                {{#each model.categories as |category|}}
                                    <li class="rsa-tag"
                                        title="{{category.parent}} - {{category.name}}"
                                            >{{category.parent}} - {{category.name}}</li>
                                {{/each}}
                            </ul>
                        {{/rsa-field}}

                    </ul>
                </section>
            </li>

        </ul>

        <ul class="rsa-tile-list">

            <!-- Journal section: -->
            <li class="rsa-card rsa-journal">
                <header>
                    <h2>{{t "respond.incidentDetails.journal"}}</h2>
                </header>
                <section>
                    <ul class="rsa-journal-entry-list">
                        {{#each model.notes as |note|}}
                            {{rsa-journal-entry entry=note}}
                        {{/each}}
                    </ul>
                </section>
            </li>

            <!-- Remediation section: -->
            <li class="rsa-card rsa-remediation">
                <header>
                    <h2>{{t "respond.incidentDetails.remediationTasks"}}</h2>
                </header>
                <section>
                </section>
            </li>
        </ul>

    {{else}}
        <p>{{t "respond.incidentDetails.instructions"}}</p>
    {{/if}}
</section>
