<iframe src="{{downloadLink}}" class="save-files-iframe"></iframe>
{{#rsa-page-layout showLeftZone=false showRightZone=false onClose=(action 'onPropertyPanelClose')  as |layout|}}
  {{#layout.center}}
    <box class="process-list-box scroll-box">
      {{endpoint/file-actionbar
        onSaveFileStatus = (action 'setFileContextFileStatus' tabName selectedFileChecksums fileContextSelections)
        getSavedFileStatus = (action 'getFileContextFileStatus' tabName)
        retrieveRemediationStatus=(action 'retrieveRemediationStatus' tabName)
        resetRiskScore = (action 'resetRiskScoreAction')
        metaName='checksumSha256'
        showResetRiskScore=false
        isRemediationAllowed=isRemediationAllowed
        itemList=fileContextSelections
        fileStatusData=fileStatus
        restrictedFileList=restrictedFileList
        serviceId=serviceId
        timeRange=timeRange
        isFloatingOrMemoryDll=isFloatingOrMemoryDll
        fileDownloadButtonStatus=fileDownloadButtonStatus
        downloadFiles=(action 'onDownloadFilesToServer')
        saveLocalCopy=(action 'onSaveLocalCopy')
        analyzeFile=(action 'onAnalyzeFile')
        isDisplayTabLabel=isDisplayTabLabel
        tabLabel=(t (concat 'investigateHosts.tabs.' tabName))}}
      {{host-detail/utils/file-context-table
        isPaginated=isPaginated
        storeName=storeName
        tabName=tabName
        columnsConfig=columnsConfig
        fileDownloadButtonStatus=fileDownloadButtonStatus
        openPropertyPanel=(action layout.open 'right')
        closePropertyPanel=(action layout.close 'right')
        downloadFiles=(action 'onDownloadFilesToServer')
        saveLocalCopy=(action 'onSaveLocalCopy')
        analyzeFile=(action 'onAnalyzeFile')}}
    </box>
  {{/layout.center}}
  {{#layout.right as |right|}}
    {{#if propertyConfig}}
      {{#right.header}}
        {{endpoint/entity-details
          title=fileProperty.fileName
          tabs= hostDetailPropertyTabs
          setTabAction=(action 'setHostDetailPropertyTab' )
          closeAction=(action layout.close 'right')
        }}
      {{/right.header}}
      {{#if (eq activeHostDetailPropertyTab 'RISK')}}
        {{endpoint/risk-properties
          defaultAction=(action 'getUpdatedRiskScoreContext')
          riskState=risk
          riskType='FILE'
          belongsTo='HOST'
        }}
      {{else if (eq activeHostDetailPropertyTab 'FILE_DETAILS')}}
        <box class="host-properties-box scroll-box">
          {{endpoint/file-property-panel
            config=propertyConfig
            localeNameSpace='investigateHosts.property.file'
            data=fileProperty}}
        </box>
      {{/if}}
    {{/if}}
  {{/layout.right}}
{{/rsa-page-layout}}


