{{#each pillsData key="id" as | pillData index |}}
  {{query-container/new-pill-trigger
    canPerformTextSearch=canPerformTextSearch
    hasTextPill=hasTextPill
    metaOptions=metaOptions
    sendMessage=(action 'handleMessage')
    newPillPosition=index
    startTriggeredPosition=startTriggeredPosition
  }}

  {{#if pillData.complexFilterText}}
    {{query-container/complex-pill
      pillData=(readonly pillData)
      sendMessage=(action 'handleMessage')
      position=index
      isActive=pillData.isEditing
    }}
  {{else if pillData.searchTerm}}
    {{query-container/text-pill
      isActive=pillData.isEditing
      pillData=(readonly pillData)
      position=index
      sendMessage=(action 'handleMessage')
    }}
  {{else}}
    {{query-container/query-pill
      metaOptions=metaOptions
      pillData=(readonly pillData)
      sendMessage=(action 'handleMessage')
      position=index
      isActive=pillData.isEditing
    }}
  {{/if}}

{{/each}}

{{query-container/query-pill
  canPerformTextSearch=canPerformTextSearch
  classNames='new-pill-template'
  hasTextPill=hasTextPill
  isMetaAutoFocused=takeFocus
  metaOptions=metaOptions
  position=newPillPosition
  sendMessage=(action 'handleMessage')
}}

