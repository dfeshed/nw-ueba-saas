{{#if needToDisplay}}
  {{context-panel/ds-header dSDetails=dSDetails}}
  {{#if (gt getDataSourceData.length 0)}}
    <div class="rsa-context-panel__grid__box">
      {{#each getDataSourceData as |data index|}}
        <hbox>
          <vbox class="rsa-context-panel__grid__host-details__header-data">
            <span title= {{get data dSDetails.firstRow.field}}>{{get data dSDetails.firstRow.field}}</span>
          </vbox>
        </hbox>
        <hbox class={{dSDetails.class}}>
          {{#if dSDetails.riskScore}}
            <vbox xs='2'>
              {{rsa-content-badge-score
                label=(t 'context.iiocScore')
                class="rsa-context-risk-score"
                score=(get data dSDetails.riskScore.field)
                size='small'
                style=badgeLevel
                invertColor=true
              }}
            </vbox>
          {{/if}}
          <vbox>
            {{#each dSDetails.rows as |rowsData|}}
              <hbox>
                {{#each rowsData.cell as |cellData|}}
                  {{#if (eq cellData.dataType 'link')}}
                    <vbox xs='3'>
                      <div class="rsa-context-panel__grid__host-details__field-name">{{t cellData.title}}</div>
                      <div class="rsa-context-panel__grid__host-details__field-value rsa-context-panel__grid link">
                        <a href={{concat 'ecatui://' (get data cellData.field)  }} target="_blank">{{get data cellData.field}}</a>
                      </div>
                    </vbox>
                  {{else if (eq cellData.dataType 'datetime')}}
                    <vbox xs='3'>
                      <div class="rsa-context-panel__grid__host-details__field-name">{{t cellData.title}}</div>
                      <div class="rsa-context-panel__grid__host-details__field-value">
                        {{#if (get data cellData.field)}}
                          <span>
                            {{rsa-content-datetime timestamp=(get data cellData.field) displayMilliseconds=false withTimeAgo=true}}
                          </span>
                        {{/if}}
                      </div>
                    </vbox>
                  {{else if (eq cellData.dataType 'group')}}
                    <vbox xs='3'>
                      {{context-panel/dynamic-grid/group data=(get data cellData.field) title=cellData.title index=index}}
                    </vbox>
                  {{else}}
                    <vbox xs='3'>
                      <div class="rsa-context-panel__grid__host-details__field-name">{{t cellData.title}}</div>
                      <div class="rsa-context-panel__grid__host-details__field-value">
                        <span title= {{get data cellData.field}}>{{get data cellData.field}}</span>
                      </div>
                    </vbox>
                  {{/if}}
                {{/each}}
              </hbox>
            {{/each}}
          </vbox>    
        </hbox>
        <div class="rsa-context-panel__grid__border"></div>
      {{/each}}
    </div>
  {{/if}}
{{/if}}
