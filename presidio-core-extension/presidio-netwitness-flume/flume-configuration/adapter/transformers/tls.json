{
  "type": "chain",
  "name": "tls-transformer",
  "transformerList": [
    {
      "type": "filter",
      "name": "direction-filter",
      "predicate": {
        "type": "regex",
        "name": "direction-white-list",
        "sourceKey": "direction",
        "regex": "outbound"
      },
      "filterIn": true
    },
    {
      "type": "epoch",
      "name": "date-time-millis-to-nano-representation",
      "sourceKey": "time",
      "destinationKey": "dateTime"
    },
    {
      "type": "set_value",
      "name": "data-source-transformer",
      "key": "dataSource",
      "value": "network"
    },
    {
      "type": "copy_value",
      "name": "rename-event-source-id-to-event-id",
      "sourceKey": "event_source_id",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "eventId"
      ]
    },
    {
      "type": "string_format",
      "name": "convert-string-format-of-direction",
      "sourceKey": "direction",
      "targetKey": "direction",
      "sourceStringFormat": "LOWER_UNDERSCORE",
      "targetStringFormat": "UPPER_UNDERSCORE"
    },
    {
      "type": "filter",
      "name": "ip-src-not-null-filter",
      "predicate": {
        "type": "key_exist",
        "name": "ip-src-not-null",
        "key": "ip_src",
        "testNull": true
      },
      "filterIn": true
    },
    {
      "type": "copy_value",
      "name": "rename-ip-src",
      "sourceKey": "ip_src",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "srcIp"
      ]
    },
    {
      "type": "filter",
      "name": "ip-dst-not-null-filter",
      "predicate": {
        "type": "key_exist",
        "name": "ip_dst-not-null",
        "key": "ip_dst",
        "testNull": true
      },
      "filterIn": true
    },
    {
      "type": "copy_value",
      "name": "rename-ip-dst",
      "sourceKey": "ip_dst",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "dstIp"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-country-src",
      "sourceKey": "country_src",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "srcCountry"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-country-dst",
      "sourceKey": "country_dst",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "dstCountry.name"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-ssl-subject",
      "sourceKey": "ssl_subject",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "sslSubject.name"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-ja3",
      "sourceKey": "ja3",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "ja3.name"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-ssl-ca",
      "sourceKey": "ssl_ca",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "sslCas"
      ]
    },
    {
      "type": "top_level_domain",
      "name": "alias-host-to-top-level-domain",
      "sourceKey": "alias_host[0]",
      "isRemoveSourceKey": false,
      "targetKey": "domain.name"
    },
    {
      "type": "copy_value",
      "name": "copy-alias-host-to-fqdn",
      "sourceKey": "alias_host",
      "isRemoveSourceKey": false,
      "destinationKeys": [
        "fqdn"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-org-dst",
      "sourceKey": "org_dst",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "dstOrg.name"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-asn-dst",
      "sourceKey": "asn_dst",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "dstAsn.name"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-payload-req",
      "sourceKey": "payload_req",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "numOfBytesSent"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-payload-res",
      "sourceKey": "payload_res",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "numOfBytesReceived"
      ]
    },
    {
      "type": "first_array_value_regex_captor_and_formatter",
      "name": "extract-src-netname",
      "sourceArrayKey": "netname",
      "targetKey": "srcNetname",
      "captureAndFormatConfiguration": {
        "pattern": "(.+) src",
        "format": "%s",
        "capturingGroupConfigurations": [
          {
            "index": 1,
            "caseFormat": "LOWER"
          }
        ]
      }
    },
    {
      "type": "first_array_value_regex_captor_and_formatter",
      "name": "extract-dst-netname",
      "sourceArrayKey": "netname",
      "targetKey": "dstNetname",
      "captureAndFormatConfiguration": {
        "pattern": "(.+) dst",
        "format": "%s",
        "capturingGroupConfigurations": [
          {
            "index": 1,
            "caseFormat": "LOWER"
          }
        ]
      }
    },
    {
      "type": "filter",
      "name": "tcp-dstport-not-null-filter",
      "predicate": {
        "type": "key_exist",
        "name": "tcp-dstport-not-null",
        "key": "tcp_dstport",
        "testNull": true
      },
      "filterIn": true
    },
    {
      "type": "copy_value",
      "name": "rename-tcp-dstport",
      "sourceKey": "tcp_dstport",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "dstPort.name"
      ]
    },
    {
      "type": "filter",
      "name": "tcp-srcPort-not-null-filter",
      "predicate": {
        "type": "key_exist",
        "name": "tcp-srcPort-not-null",
        "key": "tcp_srcPort",
        "testNull": true
      },
      "filterIn": true
    },
    {
      "type": "copy_value",
      "name": "rename-tcp-srcport",
      "sourceKey": "tcp_srcport",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "srcPort"
      ]
    },
    {
      "type": "copy_value",
      "name": "rename-session-split",
      "sourceKey": "session_split",
      "isRemoveSourceKey": true,
      "destinationKeys": [
        "sessionSplit"
      ]
    }
  ]
}
