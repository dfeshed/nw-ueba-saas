# Flume agent for the adapter component
# The source reads data from the NetWitness SDK within a given time range
# Date format: yyyy-MM-ddTHH:mm:ssZ (e.g. 2015-01-01T00:00:01Z)
# Channel stores in file up to 10K records
# The sink writes the records using the input SDK
############################## AGENT ##############################
nwProcessAgent.sources=sdkSource
nwProcessAgent.channels=memoryChannel
nwProcessAgent.sinks=inputSdkSink

############################## SOURCE ##############################
nwProcessAgent.sources.sdkSource.channels=memoryChannel
nwProcessAgent.sources.sdkSource.streamImplClassName=presidio.nw.flume.sdk.NetwitnessEventsStream
nwProcessAgent.sources.sdkSource.type=org.flume.source.sdk.PresidioStreamingSDKSource
nwProcessAgent.sources.sdkSource.schema=PROCESS
nwProcessAgent.sources.sdkSource.startDate=$startDate
nwProcessAgent.sources.sdkSource.endDate=$endDate
nwProcessAgent.sources.sdkSource.query=select sessionid,action,checksum.src,checksum.dst,agent.id,nwe.callback_id,OS,process.vid.src,process.vid.dst,alias.host,user.src,device.type,directory.dst,directory.src,event.source.id,event.time,filename.src,filename.dst,owner,cert.common,dir.path.src,dir.path.dst,file.cat.src,file.cat.dst where category='Process Event' AND device.type='nwendpoint'
nwProcessAgent.sources.sdkSource.multiValued=action,alias.host,dir.path.src,dir.path.dst,file.cat.src,file.cat.dst,OS
nwProcessAgent.sources.sdkSource.timeField=event.time
nwProcessAgent.sources.sdkSource.batchSize=100000
nwProcessAgent.sources.sdkSource.isBatch=true
nwProcessAgent.sources.sdkSource.applicationName=adapter
nwProcessAgent.sources.sdkSource.socketTimeout=600

############################## INTERCEPTORS ##############################
nwProcessAgent.sources.sdkSource.interceptors=transformerInterceptor
nwProcessAgent.sources.sdkSource.interceptors.transformerInterceptor.type=org.apache.flume.interceptor.presidio.transform.TransformerInterceptor$Builder
nwProcessAgent.sources.sdkSource.interceptors.transformerInterceptor.configuration_path=/var/lib/netwitness/presidio/flume/conf/adapter/transformers/process.json

############################## CHANNEL ##############################
nwProcessAgent.channels.memoryChannel.type=memory
nwProcessAgent.channels.memoryChannel.capacity=100000
nwProcessAgent.channels.memoryChannel.transactionCapacity=10000

############################## SINK ##############################
nwProcessAgent.sinks.inputSdkSink.channel=memoryChannel
nwProcessAgent.sinks.inputSdkSink.type=org.flume.sink.input.PresidioInputSdkSink
nwProcessAgent.sinks.inputSdkSink.schema=PROCESS
nwProcessAgent.sinks.inputSdkSink.recordType=presidio.sdk.api.domain.rawevents.ProcessRawEvent
nwProcessAgent.sinks.inputSdkSink.isBatch=true
nwProcessAgent.sinks.inputSdkSink.batchSize=10000
nwProcessAgent.sinks.inputSdkSink.applicationName=adapter
