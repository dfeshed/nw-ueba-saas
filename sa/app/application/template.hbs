<ul class="rsa-flash-messages">
  {{#each flashMessages.queue as |flash|}}
    {{#flash-message tagName="li" flash=flash as |component flash|}}
      <hbox align="stretch">
        <centered xs="2">
          {{rsa-icon name=flash.iconName style=flash.iconStyle size=flash.iconSize}}
        </centered>
        <vbox xs="9" justify="center" class="message">
          {{flash.message}}
        </vbox>
        <vbox xs="1" justify="start" align="center">
          {{rsa-icon name="close"}}
        </vbox>
      </hbox>
    {{/flash-message}}
  {{/each}}
</ul>

{{#if authenticatedAndPageFound}}
  {{#rsa-application-header version=version title=title}}
    {{#if features.showRespondRoute}}
      {{#if accessControl.hasRespondAccess}}
        {{#link-to "protected.respond" class="rsa-header-nav-respond js-test-nav-respond-link"}}
          {{t "respond.title"}}
        {{/link-to}}
      {{/if}}
    {{/if}}

    {{#if features.showInvestigateRoute}}
      {{!-- TODO: uncomment this when we want to link to the new investigate in the nav bar}}
      {{#link-to "protected.investigate" class="rsa-header-nav-investigate js-test-nav-investigate-link"}}
        {{t "investigate.title"}}
      {{/link-to}}
      {{--}}
      <a href="/investigation" class="rsa-header-nav-investigate js-test-nav-investigate-link">{{t "investigate.title"}}</a>
    {{/if}}

    {{#if accessControl.hasMonitorAccess}}
      <a href="/unified/dashboard" class="rsa-header-nav-monitor js-test-nav-monitor-link">{{t "monitor.title"}}</a>
    {{/if}}

    {{#if accessControl.hasConfigAccess}}
      <a href="{{accessControl.configUrl}}" class="rsa-header-nav-configure js-test-nav-configure-link">{{t "config.title"}}</a>
    {{/if}}

    {{#if accessControl.hasAdminAccess}}
      <a href="{{accessControl.adminUrl}}" class="rsa-header-nav-admin js-test-nav-admin-link">{{t "admin.title"}}</a>
    {{/if}}
  {{/rsa-application-header}}

  {{#rsa-application-content}}
    {{outlet}}
  {{/rsa-application-content}}

  {{rsa-application-user-preferences-panel logout=(route-action 'logout')}}

{{else}}
  {{outlet}}
{{/if}}

<div id="modalDestination"></div>
{{#rsa-application-modal
  label="Critical Error"
  style='error'
  eventId='fatalError'
  modalDidClose='clearFatalErrorQueue'}}
  <div class='modal-content'>
    {{#each fatalErrors.queue as |error|}}
      <p>{{error}}</p>
    {{/each}}
  </div>
{{/rsa-application-modal}}

{{ember-load-remover}}
