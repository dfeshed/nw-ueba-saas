{{#rsa-data-table
  lazy=true
  items=files
  columnsConfig=updatedColumns
  onRowClick=(action 'toggleSelectedRow')}}
  {{#file-list/header enableColumnFilter=true translateTitles=true enableColumnSelector=true as |column|}}
     {{#if (eq column.dataType "checkbox")}}
       <label class="rsa-form-checkbox-label {{concat 'column-selection-' column.field}} {{if isAllSelected 'checked'}}">
          {{rsa-form-checkbox
            checked=isALlSelected
            change=(action 'toggleAllSelection')}}
        </label>
     {{else}}
      <span class='js-move-handle'>
        {{t column.title}}
      </span>
     {{/if}}
    {{! COLUMN SORT }}
    {{#unless column.disableSort}}
      {{file-list/sort-button sortField=sortField column=column isSortDescending=isSortDescending sortBy=(action 'sortBy')}}
    {{/unless}}
  {{/file-list/header}}
  {{#if (eq areFilesLoading 'sorting')}}
    <centered>
      {{rsa-loader size='larger'}}
    </centered>
  {{else}}
    {{#rsa-data-table/body
      noResultsMessage=(t 'investigateFiles.message.noResultsMessage')
      as |item index column|}}
      {{#if column.componentClass}}
        {{#rsa-data-table/body-cell item=item column=column}}
          <label class="rsa-form-checkbox-label {{if item.checked 'checked'}}">
            {{rsa-form-checkbox checked=item.checked change=(action 'toggleItemSelection' item)}}
          </label>
        {{/rsa-data-table/body-cell}}
      {{else}}
        {{#rsa-data-table/body-cell column=column}}
          {{#if (eq column.field 'size')}}
            {{rsa-content-memsize size=(get item column.field)}}
          {{else if (eq column.field 'pe.imageSize')}}
            {{rsa-content-memsize size=(get item column.field)}}
          {{else if (eq column.field 'signature.features')}}
            {{#if (get item column.field)}}
              {{get item column.field}}
            {{else}}
              unsigned
            {{/if}}
          {{else if (eq column.dataType 'DATE')}}
            {{#if (get item column.field)}}
              {{rsa-content-datetime timestamp=(get item column.field)}}
            {{else}}
              N/A
            {{/if}}
          {{else if (eq column.field 'signature.timeStamp')}}
            {{rsa-content-datetime timestamp=(get item column.field)}}
          {{else}}
            {{get item column.field}}
          {{/if}}
        {{/rsa-data-table/body-cell}}
      {{/if}}
    {{/rsa-data-table/body}}
      {{rsa-data-table/load-more status=loadMoreStatus click=(action 'getPageOfFiles')}}
  {{/if}}
{{/rsa-data-table}}


